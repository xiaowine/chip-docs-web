var C0=Object.defineProperty;var Em=n=>{throw TypeError(n)};var T0=(n,t,e)=>t in n?C0(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var U=(n,t,e)=>T0(n,typeof t!="symbol"?t+"":t,e),Pf=(n,t,e)=>t.has(n)||Em("Cannot "+e);var l=(n,t,e)=>(Pf(n,t,"read from private field"),e?e.call(n):t.get(n)),y=(n,t,e)=>t.has(n)?Em("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),g=(n,t,e,s)=>(Pf(n,t,"write to private field"),s?s.call(n,e):t.set(n,e),e),w=(n,t,e)=>(Pf(n,t,"access private method"),e);var Ke=(n,t,e,s)=>({set _(i){g(n,t,i,e)},get _(){return l(n,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Pg(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Vt={},Fa=[],Ji=()=>{},k0=()=>!1,lf=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Mg=n=>n.startsWith("onUpdate:"),Ae=Object.assign,Ig=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},R0=Object.prototype.hasOwnProperty,Rt=(n,t)=>R0.call(n,t),ht=Array.isArray,Na=n=>cf(n)==="[object Map]",zb=n=>cf(n)==="[object Set]",pt=n=>typeof n=="function",re=n=>typeof n=="string",Gn=n=>typeof n=="symbol",Yt=n=>n!==null&&typeof n=="object",Ub=n=>(Yt(n)||pt(n))&&pt(n.then)&&pt(n.catch),Vb=Object.prototype.toString,cf=n=>Vb.call(n),P0=n=>cf(n).slice(8,-1),jb=n=>cf(n)==="[object Object]",Lg=n=>re(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,kc=Pg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hf=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},M0=/-(\w)/g,si=hf(n=>n.replace(M0,(t,e)=>e?e.toUpperCase():"")),I0=/\B([A-Z])/g,ya=hf(n=>n.replace(I0,"-$1").toLowerCase()),uf=hf(n=>n.charAt(0).toUpperCase()+n.slice(1)),Mf=hf(n=>n?`on${uf(n)}`:""),Or=(n,t)=>!Object.is(n,t),Hu=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},Gb=(n,t,e,s=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:s,value:e})},Zf=n=>{const t=parseFloat(n);return isNaN(t)?n:t},L0=n=>{const t=re(n)?Number(n):NaN;return isNaN(t)?n:t};let Cm;const df=()=>Cm||(Cm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ai(n){if(ht(n)){const t={};for(let e=0;e<n.length;e++){const s=n[e],i=re(s)?O0(s):Ai(s);if(i)for(const r in i)t[r]=i[r]}return t}else if(re(n)||Yt(n))return n}const D0=/;(?![^(]*\))/g,F0=/:([^]+)/,N0=/\/\*[^]*?\*\//g;function O0(n){const t={};return n.replace(N0,"").split(D0).forEach(e=>{if(e){const s=e.split(F0);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function pe(n){let t="";if(re(n))t=n;else if(ht(n))for(let e=0;e<n.length;e++){const s=pe(n[e]);s&&(t+=s+" ")}else if(Yt(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const $0="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",B0=Pg($0);function Wb(n){return!!n||n===""}const qb=n=>!!(n&&n.__v_isRef===!0),yt=n=>re(n)?n:n==null?"":ht(n)||Yt(n)&&(n.toString===Vb||!pt(n.toString))?qb(n)?yt(n.value):JSON.stringify(n,Xb,2):String(n),Xb=(n,t)=>qb(t)?Xb(n,t.value):Na(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,i],r)=>(e[If(s,r)+" =>"]=i,e),{})}:zb(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>If(e))}:Gn(t)?If(t):Yt(t)&&!ht(t)&&!jb(t)?String(t):t,If=(n,t="")=>{var e;return Gn(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Is;class H0{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Is,!t&&Is&&(this.index=(Is.scopes||(Is.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Is;try{return Is=this,t()}finally{Is=e}}}on(){Is=this}off(){Is=this.parent}stop(t){if(this._active){this._active=!1;let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(this.effects.length=0,e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function z0(){return Is}let Wt;const Lf=new WeakSet;class Yb{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Is&&Is.active&&Is.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Lf.has(this)&&(Lf.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Zb(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Tm(this),Qb(this);const t=Wt,e=wi;Wt=this,wi=!0;try{return this.fn()}finally{Jb(this),Wt=t,wi=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Ng(t);this.deps=this.depsTail=void 0,Tm(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Lf.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Qf(this)&&this.run()}get dirty(){return Qf(this)}}let Kb=0,Rc,Pc;function Zb(n,t=!1){if(n.flags|=8,t){n.next=Pc,Pc=n;return}n.next=Rc,Rc=n}function Dg(){Kb++}function Fg(){if(--Kb>0)return;if(Pc){let t=Pc;for(Pc=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Rc;){let t=Rc;for(Rc=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){n||(n=s)}t=e}}if(n)throw n}function Qb(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Jb(n){let t,e=n.depsTail,s=e;for(;s;){const i=s.prevDep;s.version===-1?(s===e&&(e=i),Ng(s),U0(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}n.deps=t,n.depsTail=e}function Qf(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ty(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function ty(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===$c))return;n.globalVersion=$c;const t=n.dep;if(n.flags|=2,t.version>0&&!n.isSSR&&n.deps&&!Qf(n)){n.flags&=-3;return}const e=Wt,s=wi;Wt=n,wi=!0;try{Qb(n);const i=n.fn(n._value);(t.version===0||Or(i,n._value))&&(n._value=i,t.version++)}catch(i){throw t.version++,i}finally{Wt=e,wi=s,Jb(n),n.flags&=-3}}function Ng(n,t=!1){const{dep:e,prevSub:s,nextSub:i}=n;if(s&&(s.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=s,n.nextSub=void 0),e.subs===n&&(e.subs=s,!s&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Ng(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function U0(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let wi=!0;const ey=[];function jr(){ey.push(wi),wi=!1}function Gr(){const n=ey.pop();wi=n===void 0?!0:n}function Tm(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=Wt;Wt=void 0;try{t()}finally{Wt=e}}}let $c=0;class V0{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Og{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Wt||!wi||Wt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==Wt)e=this.activeLink=new V0(Wt,this),Wt.deps?(e.prevDep=Wt.depsTail,Wt.depsTail.nextDep=e,Wt.depsTail=e):Wt.deps=Wt.depsTail=e,sy(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const s=e.nextDep;s.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=s),e.prevDep=Wt.depsTail,e.nextDep=void 0,Wt.depsTail.nextDep=e,Wt.depsTail=e,Wt.deps===e&&(Wt.deps=s)}return e}trigger(t){this.version++,$c++,this.notify(t)}notify(t){Dg();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Fg()}}}function sy(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)sy(s)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const Jf=new WeakMap,ha=Symbol(""),tp=Symbol(""),Bc=Symbol("");function qe(n,t,e){if(wi&&Wt){let s=Jf.get(n);s||Jf.set(n,s=new Map);let i=s.get(e);i||(s.set(e,i=new Og),i.map=s,i.key=e),i.track()}}function Nn(n,t,e,s,i,r){const o=Jf.get(n);if(!o){$c++;return}const a=c=>{c&&c.trigger()};if(Dg(),t==="clear")o.forEach(a);else{const c=ht(n),h=c&&Lg(e);if(c&&e==="length"){const u=Number(s);o.forEach((d,f)=>{(f==="length"||f===Bc||!Gn(f)&&f>=u)&&a(d)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),h&&a(o.get(Bc)),t){case"add":c?h&&a(o.get("length")):(a(o.get(ha)),Na(n)&&a(o.get(tp)));break;case"delete":c||(a(o.get(ha)),Na(n)&&a(o.get(tp)));break;case"set":Na(n)&&a(o.get(ha));break}}Fg()}function _a(n){const t=Tt(n);return t===n?t:(qe(t,"iterate",Bc),Js(n)?t:t.map(Xe))}function ff(n){return qe(n=Tt(n),"iterate",Bc),n}const j0={__proto__:null,[Symbol.iterator](){return Df(this,Symbol.iterator,Xe)},concat(...n){return _a(this).concat(...n.map(t=>ht(t)?_a(t):t))},entries(){return Df(this,"entries",n=>(n[1]=Xe(n[1]),n))},every(n,t){return en(this,"every",n,t,void 0,arguments)},filter(n,t){return en(this,"filter",n,t,e=>e.map(Xe),arguments)},find(n,t){return en(this,"find",n,t,Xe,arguments)},findIndex(n,t){return en(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return en(this,"findLast",n,t,Xe,arguments)},findLastIndex(n,t){return en(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return en(this,"forEach",n,t,void 0,arguments)},includes(...n){return Ff(this,"includes",n)},indexOf(...n){return Ff(this,"indexOf",n)},join(n){return _a(this).join(n)},lastIndexOf(...n){return Ff(this,"lastIndexOf",n)},map(n,t){return en(this,"map",n,t,void 0,arguments)},pop(){return Jl(this,"pop")},push(...n){return Jl(this,"push",n)},reduce(n,...t){return km(this,"reduce",n,t)},reduceRight(n,...t){return km(this,"reduceRight",n,t)},shift(){return Jl(this,"shift")},some(n,t){return en(this,"some",n,t,void 0,arguments)},splice(...n){return Jl(this,"splice",n)},toReversed(){return _a(this).toReversed()},toSorted(n){return _a(this).toSorted(n)},toSpliced(...n){return _a(this).toSpliced(...n)},unshift(...n){return Jl(this,"unshift",n)},values(){return Df(this,"values",Xe)}};function Df(n,t,e){const s=ff(n),i=s[t]();return s!==n&&!Js(n)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.value&&(r.value=e(r.value)),r}),i}const G0=Array.prototype;function en(n,t,e,s,i,r){const o=ff(n),a=o!==n&&!Js(n),c=o[t];if(c!==G0[t]){const d=c.apply(n,r);return a?Xe(d):d}let h=e;o!==n&&(a?h=function(d,f){return e.call(this,Xe(d),f,n)}:e.length>2&&(h=function(d,f){return e.call(this,d,f,n)}));const u=c.call(o,h,s);return a&&i?i(u):u}function km(n,t,e,s){const i=ff(n);let r=e;return i!==n&&(Js(n)?e.length>3&&(r=function(o,a,c){return e.call(this,o,a,c,n)}):r=function(o,a,c){return e.call(this,o,Xe(a),c,n)}),i[t](r,...s)}function Ff(n,t,e){const s=Tt(n);qe(s,"iterate",Bc);const i=s[t](...e);return(i===-1||i===!1)&&zg(e[0])?(e[0]=Tt(e[0]),s[t](...e)):i}function Jl(n,t,e=[]){jr(),Dg();const s=Tt(n)[t].apply(n,e);return Fg(),Gr(),s}const W0=Pg("__proto__,__v_isRef,__isVue"),iy=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Gn));function q0(n){Gn(n)||(n=String(n));const t=Tt(this);return qe(t,"has",n),t.hasOwnProperty(n)}class ny{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){if(e==="__v_skip")return t.__v_skip;const i=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!i;if(e==="__v_isReadonly")return i;if(e==="__v_isShallow")return r;if(e==="__v_raw")return s===(i?r?iA:ly:r?ay:oy).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=ht(t);if(!i){let c;if(o&&(c=j0[e]))return c;if(e==="hasOwnProperty")return q0}const a=Reflect.get(t,e,Ye(t)?t:s);return(Gn(e)?iy.has(e):W0(e))||(i||qe(t,"get",e),r)?a:Ye(a)?o&&Lg(e)?a:a.value:Yt(a)?i?cy(a):Bg(a):a}}class ry extends ny{constructor(t=!1){super(!1,t)}set(t,e,s,i){let r=t[e];if(!this._isShallow){const c=da(r);if(!Js(s)&&!da(s)&&(r=Tt(r),s=Tt(s)),!ht(t)&&Ye(r)&&!Ye(s))return c?!1:(r.value=s,!0)}const o=ht(t)&&Lg(e)?Number(e)<t.length:Rt(t,e),a=Reflect.set(t,e,s,Ye(t)?t:i);return t===Tt(i)&&(o?Or(s,r)&&Nn(t,"set",e,s):Nn(t,"add",e,s)),a}deleteProperty(t,e){const s=Rt(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&s&&Nn(t,"delete",e,void 0),i}has(t,e){const s=Reflect.has(t,e);return(!Gn(e)||!iy.has(e))&&qe(t,"has",e),s}ownKeys(t){return qe(t,"iterate",ht(t)?"length":ha),Reflect.ownKeys(t)}}class X0 extends ny{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Y0=new ry,K0=new X0,Z0=new ry(!0);const ep=n=>n,ku=n=>Reflect.getPrototypeOf(n);function Q0(n,t,e){return function(...s){const i=this.__v_raw,r=Tt(i),o=Na(r),a=n==="entries"||n===Symbol.iterator&&o,c=n==="keys"&&o,h=i[n](...s),u=e?ep:t?sp:Xe;return!t&&qe(r,"iterate",c?tp:ha),{next(){const{value:d,done:f}=h.next();return f?{value:d,done:f}:{value:a?[u(d[0]),u(d[1])]:u(d),done:f}},[Symbol.iterator](){return this}}}}function Ru(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function J0(n,t){const e={get(i){const r=this.__v_raw,o=Tt(r),a=Tt(i);n||(Or(i,a)&&qe(o,"get",i),qe(o,"get",a));const{has:c}=ku(o),h=t?ep:n?sp:Xe;if(c.call(o,i))return h(r.get(i));if(c.call(o,a))return h(r.get(a));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!n&&qe(Tt(i),"iterate",ha),Reflect.get(i,"size",i)},has(i){const r=this.__v_raw,o=Tt(r),a=Tt(i);return n||(Or(i,a)&&qe(o,"has",i),qe(o,"has",a)),i===a?r.has(i):r.has(i)||r.has(a)},forEach(i,r){const o=this,a=o.__v_raw,c=Tt(a),h=t?ep:n?sp:Xe;return!n&&qe(c,"iterate",ha),a.forEach((u,d)=>i.call(r,h(u),h(d),o))}};return Ae(e,n?{add:Ru("add"),set:Ru("set"),delete:Ru("delete"),clear:Ru("clear")}:{add(i){!t&&!Js(i)&&!da(i)&&(i=Tt(i));const r=Tt(this);return ku(r).has.call(r,i)||(r.add(i),Nn(r,"add",i,i)),this},set(i,r){!t&&!Js(r)&&!da(r)&&(r=Tt(r));const o=Tt(this),{has:a,get:c}=ku(o);let h=a.call(o,i);h||(i=Tt(i),h=a.call(o,i));const u=c.call(o,i);return o.set(i,r),h?Or(r,u)&&Nn(o,"set",i,r):Nn(o,"add",i,r),this},delete(i){const r=Tt(this),{has:o,get:a}=ku(r);let c=o.call(r,i);c||(i=Tt(i),c=o.call(r,i)),a&&a.call(r,i);const h=r.delete(i);return c&&Nn(r,"delete",i,void 0),h},clear(){const i=Tt(this),r=i.size!==0,o=i.clear();return r&&Nn(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=Q0(i,n,t)}),e}function $g(n,t){const e=J0(n,t);return(s,i,r)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?s:Reflect.get(Rt(e,i)&&i in s?e:s,i,r)}const tA={get:$g(!1,!1)},eA={get:$g(!1,!0)},sA={get:$g(!0,!1)};const oy=new WeakMap,ay=new WeakMap,ly=new WeakMap,iA=new WeakMap;function nA(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function rA(n){return n.__v_skip||!Object.isExtensible(n)?0:nA(P0(n))}function Bg(n){return da(n)?n:Hg(n,!1,Y0,tA,oy)}function oA(n){return Hg(n,!1,Z0,eA,ay)}function cy(n){return Hg(n,!0,K0,sA,ly)}function Hg(n,t,e,s,i){if(!Yt(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const r=i.get(n);if(r)return r;const o=rA(n);if(o===0)return n;const a=new Proxy(n,o===2?s:e);return i.set(n,a),a}function Oa(n){return da(n)?Oa(n.__v_raw):!!(n&&n.__v_isReactive)}function da(n){return!!(n&&n.__v_isReadonly)}function Js(n){return!!(n&&n.__v_isShallow)}function zg(n){return n?!!n.__v_raw:!1}function Tt(n){const t=n&&n.__v_raw;return t?Tt(t):n}function aA(n){return!Rt(n,"__v_skip")&&Object.isExtensible(n)&&Gb(n,"__v_skip",!0),n}const Xe=n=>Yt(n)?Bg(n):n,sp=n=>Yt(n)?cy(n):n;function Ye(n){return n?n.__v_isRef===!0:!1}function ft(n){return lA(n,!1)}function lA(n,t){return Ye(n)?n:new cA(n,t)}class cA{constructor(t,e){this.dep=new Og,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Tt(t),this._value=e?t:Xe(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,s=this.__v_isShallow||Js(t)||da(t);t=s?t:Tt(t),Or(t,e)&&(this._rawValue=t,this._value=s?t:Xe(t),this.dep.trigger())}}function ie(n){return Ye(n)?n.value:n}const hA={get:(n,t,e)=>t==="__v_raw"?n:ie(Reflect.get(n,t,e)),set:(n,t,e,s)=>{const i=n[t];return Ye(i)&&!Ye(e)?(i.value=e,!0):Reflect.set(n,t,e,s)}};function hy(n){return Oa(n)?n:new Proxy(n,hA)}class uA{constructor(t,e,s){this.fn=t,this.setter=e,this._value=void 0,this.dep=new Og(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=$c-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Wt!==this)return Zb(this,!0),!0}get value(){const t=this.dep.track();return ty(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function dA(n,t,e=!1){let s,i;return pt(n)?s=n:(s=n.get,i=n.set),new uA(s,i,e)}const Pu={},_d=new WeakMap;let Kr;function fA(n,t=!1,e=Kr){if(e){let s=_d.get(e);s||_d.set(e,s=[]),s.push(n)}}function pA(n,t,e=Vt){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:a,call:c}=e,h=S=>i?S:Js(S)||i===!1||i===0?On(S,1):On(S);let u,d,f,p,m=!1,b=!1;if(Ye(n)?(d=()=>n.value,m=Js(n)):Oa(n)?(d=()=>h(n),m=!0):ht(n)?(b=!0,m=n.some(S=>Oa(S)||Js(S)),d=()=>n.map(S=>{if(Ye(S))return S.value;if(Oa(S))return h(S);if(pt(S))return c?c(S,2):S()})):pt(n)?t?d=c?()=>c(n,2):n:d=()=>{if(f){jr();try{f()}finally{Gr()}}const S=Kr;Kr=u;try{return c?c(n,3,[p]):n(p)}finally{Kr=S}}:d=Ji,t&&i){const S=d,C=i===!0?1/0:i;d=()=>On(S(),C)}const A=z0(),v=()=>{u.stop(),A&&A.active&&Ig(A.effects,u)};if(r&&t){const S=t;t=(...C)=>{S(...C),v()}}let _=b?new Array(n.length).fill(Pu):Pu;const x=S=>{if(!(!(u.flags&1)||!u.dirty&&!S))if(t){const C=u.run();if(i||m||(b?C.some((T,R)=>Or(T,_[R])):Or(C,_))){f&&f();const T=Kr;Kr=u;try{const R=[C,_===Pu?void 0:b&&_[0]===Pu?[]:_,p];c?c(t,3,R):t(...R),_=C}finally{Kr=T}}}else u.run()};return a&&a(x),u=new Yb(d),u.scheduler=o?()=>o(x,!1):x,p=S=>fA(S,!1,u),f=u.onStop=()=>{const S=_d.get(u);if(S){if(c)c(S,4);else for(const C of S)C();_d.delete(u)}},t?s?x(!0):_=u.run():o?o(x.bind(null,!0),!0):u.run(),v.pause=u.pause.bind(u),v.resume=u.resume.bind(u),v.stop=v,v}function On(n,t=1/0,e){if(t<=0||!Yt(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,Ye(n))On(n.value,t,e);else if(ht(n))for(let s=0;s<n.length;s++)On(n[s],t,e);else if(zb(n)||Na(n))n.forEach(s=>{On(s,t,e)});else if(jb(n)){for(const s in n)On(n[s],t,e);for(const s of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,s)&&On(n[s],t,e)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function mu(n,t,e,s){try{return s?n(...s):n()}catch(i){pf(i,t,e)}}function _i(n,t,e,s){if(pt(n)){const i=mu(n,t,e,s);return i&&Ub(i)&&i.catch(r=>{pf(r,t,e)}),i}if(ht(n)){const i=[];for(let r=0;r<n.length;r++)i.push(_i(n[r],t,e,s));return i}}function pf(n,t,e,s=!0){const i=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Vt;if(t){let a=t.parent;const c=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const u=a.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](n,c,h)===!1)return}a=a.parent}if(r){jr(),mu(r,null,10,[n,c,h]),Gr();return}}gA(n,e,i,s,o)}function gA(n,t,e,s=!0,i=!1){if(i)throw n;console.error(n)}const ns=[];let Fi=-1;const $a=[];let Zn=null,Sa=0;const uy=Promise.resolve();let Sd=null;function mA(n){const t=Sd||uy;return n?t.then(this?n.bind(this):n):t}function bA(n){let t=Fi+1,e=ns.length;for(;t<e;){const s=t+e>>>1,i=ns[s],r=Hc(i);r<n||r===n&&i.flags&2?t=s+1:e=s}return t}function Ug(n){if(!(n.flags&1)){const t=Hc(n),e=ns[ns.length-1];!e||!(n.flags&2)&&t>=Hc(e)?ns.push(n):ns.splice(bA(t),0,n),n.flags|=1,dy()}}function dy(){Sd||(Sd=uy.then(py))}function yA(n){ht(n)?$a.push(...n):Zn&&n.id===-1?Zn.splice(Sa+1,0,n):n.flags&1||($a.push(n),n.flags|=1),dy()}function Rm(n,t,e=Fi+1){for(;e<ns.length;e++){const s=ns[e];if(s&&s.flags&2){if(n&&s.id!==n.uid)continue;ns.splice(e,1),e--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function fy(n){if($a.length){const t=[...new Set($a)].sort((e,s)=>Hc(e)-Hc(s));if($a.length=0,Zn){Zn.push(...t);return}for(Zn=t,Sa=0;Sa<Zn.length;Sa++){const e=Zn[Sa];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Zn=null,Sa=0}}const Hc=n=>n.id==null?n.flags&2?-1:1/0:n.id;function py(n){try{for(Fi=0;Fi<ns.length;Fi++){const t=ns[Fi];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),mu(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Fi<ns.length;Fi++){const t=ns[Fi];t&&(t.flags&=-2)}Fi=-1,ns.length=0,fy(),Sd=null,(ns.length||$a.length)&&py()}}let Re=null,gy=null;function xd(n){const t=Re;return Re=n,gy=n&&n.type.__scopeId||null,t}function Ys(n,t=Re,e){if(!t||n._n)return n;const s=(...i)=>{s._d&&Vm(-1);const r=xd(t);let o;try{o=n(...i)}finally{xd(r),s._d&&Vm(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function Ed(n,t){if(Re===null)return n;const e=vf(Re),s=n.dirs||(n.dirs=[]);for(let i=0;i<t.length;i++){let[r,o,a,c=Vt]=t[i];r&&(pt(r)&&(r={mounted:r,updated:r}),r.deep&&On(o),s.push({dir:r,instance:e,value:o,oldValue:void 0,arg:a,modifiers:c}))}return n}function qr(n,t,e,s){const i=n.dirs,r=t&&t.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let c=a.dir[s];c&&(jr(),_i(c,e,8,[n.el,a,n,t]),Gr())}}const my=Symbol("_vte"),by=n=>n.__isTeleport,Mc=n=>n&&(n.disabled||n.disabled===""),Pm=n=>n&&(n.defer||n.defer===""),Mm=n=>typeof SVGElement<"u"&&n instanceof SVGElement,Im=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,ip=(n,t)=>{const e=n&&n.to;return re(e)?t?t(e):null:e},yy={name:"Teleport",__isTeleport:!0,process(n,t,e,s,i,r,o,a,c,h){const{mc:u,pc:d,pbc:f,o:{insert:p,querySelector:m,createText:b,createComment:A}}=h,v=Mc(t.props);let{shapeFlag:_,children:x,dynamicChildren:S}=t;if(n==null){const C=t.el=b(""),T=t.anchor=b("");p(C,e,s),p(T,e,s);const R=(P,F)=>{_&16&&(i&&i.isCE&&(i.ce._teleportTarget=P),u(x,P,F,i,r,o,a,c))},L=()=>{const P=t.target=ip(t.props,m),F=wy(P,t,b,p);P&&(o!=="svg"&&Mm(P)?o="svg":o!=="mathml"&&Im(P)&&(o="mathml"),v||(R(P,F),zu(t,!1)))};v&&(R(e,T),zu(t,!0)),Pm(t.props)?is(()=>{L(),t.el.__isMounted=!0},r):L()}else{if(Pm(t.props)&&!n.el.__isMounted){is(()=>{yy.process(n,t,e,s,i,r,o,a,c,h),delete n.el.__isMounted},r);return}t.el=n.el,t.targetStart=n.targetStart;const C=t.anchor=n.anchor,T=t.target=n.target,R=t.targetAnchor=n.targetAnchor,L=Mc(n.props),P=L?e:T,F=L?C:R;if(o==="svg"||Mm(T)?o="svg":(o==="mathml"||Im(T))&&(o="mathml"),S?(f(n.dynamicChildren,S,P,i,r,o,a),qg(n,t,!0)):c||d(n,t,P,F,i,r,o,a,!1),v)L?t.props&&n.props&&t.props.to!==n.props.to&&(t.props.to=n.props.to):Mu(t,e,C,h,1);else if((t.props&&t.props.to)!==(n.props&&n.props.to)){const N=t.target=ip(t.props,m);N&&Mu(t,N,null,h,0)}else L&&Mu(t,T,R,h,1);zu(t,v)}},remove(n,t,e,{um:s,o:{remove:i}},r){const{shapeFlag:o,children:a,anchor:c,targetStart:h,targetAnchor:u,target:d,props:f}=n;if(d&&(i(h),i(u)),r&&i(c),o&16){const p=r||!Mc(f);for(let m=0;m<a.length;m++){const b=a[m];s(b,t,e,p,!!b.dynamicChildren)}}},move:Mu,hydrate:wA};function Mu(n,t,e,{o:{insert:s},m:i},r=2){r===0&&s(n.targetAnchor,t,e);const{el:o,anchor:a,shapeFlag:c,children:h,props:u}=n,d=r===2;if(d&&s(o,t,e),(!d||Mc(u))&&c&16)for(let f=0;f<h.length;f++)i(h[f],t,e,2);d&&s(a,t,e)}function wA(n,t,e,s,i,r,{o:{nextSibling:o,parentNode:a,querySelector:c,insert:h,createText:u}},d){const f=t.target=ip(t.props,c);if(f){const p=Mc(t.props),m=f._lpa||f.firstChild;if(t.shapeFlag&16)if(p)t.anchor=d(o(n),t,a(n),e,s,i,r),t.targetStart=m,t.targetAnchor=m&&o(m);else{t.anchor=o(n);let b=m;for(;b;){if(b&&b.nodeType===8){if(b.data==="teleport start anchor")t.targetStart=b;else if(b.data==="teleport anchor"){t.targetAnchor=b,f._lpa=t.targetAnchor&&o(t.targetAnchor);break}}b=o(b)}t.targetAnchor||wy(f,t,u,h),d(m&&o(m),t,f,e,s,i,r)}zu(t,p)}return t.anchor&&o(t.anchor)}const Vg=yy;function zu(n,t){const e=n.ctx;if(e&&e.ut){let s,i;for(t?(s=n.el,i=n.anchor):(s=n.targetStart,i=n.targetAnchor);s&&s!==i;)s.nodeType===1&&s.setAttribute("data-v-owner",e.uid),s=s.nextSibling;e.ut()}}function wy(n,t,e,s){const i=t.targetStart=e(""),r=t.targetAnchor=e("");return i[my]=r,n&&(s(i,n),s(r,n)),r}const Qn=Symbol("_leaveCb"),Iu=Symbol("_enterCb");function vy(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Wr(()=>{n.isMounted=!0}),Gg(()=>{n.isUnmounting=!0}),n}const Bs=[Function,Array],Ay={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bs,onEnter:Bs,onAfterEnter:Bs,onEnterCancelled:Bs,onBeforeLeave:Bs,onLeave:Bs,onAfterLeave:Bs,onLeaveCancelled:Bs,onBeforeAppear:Bs,onAppear:Bs,onAfterAppear:Bs,onAppearCancelled:Bs},_y=n=>{const t=n.subTree;return t.component?_y(t.component):t},vA={name:"BaseTransition",props:Ay,setup(n,{slots:t}){const e=Xy(),s=vy();return()=>{const i=t.default&&jg(t.default(),!0);if(!i||!i.length)return;const r=Sy(i),o=Tt(n),{mode:a}=o;if(s.isLeaving)return Nf(r);const c=Lm(r);if(!c)return Nf(r);let h=zc(c,o,s,e,d=>h=d);c.type!==rs&&fa(c,h);let u=e.subTree&&Lm(e.subTree);if(u&&u.type!==rs&&!to(c,u)&&_y(e).type!==rs){let d=zc(u,o,s,e);if(fa(u,d),a==="out-in"&&c.type!==rs)return s.isLeaving=!0,d.afterLeave=()=>{s.isLeaving=!1,e.job.flags&8||e.update(),delete d.afterLeave,u=void 0},Nf(r);a==="in-out"&&c.type!==rs?d.delayLeave=(f,p,m)=>{const b=xy(s,u);b[String(u.key)]=u,f[Qn]=()=>{p(),f[Qn]=void 0,delete h.delayedLeave,u=void 0},h.delayedLeave=()=>{m(),delete h.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return r}}};function Sy(n){let t=n[0];if(n.length>1){for(const e of n)if(e.type!==rs){t=e;break}}return t}const AA=vA;function xy(n,t){const{leavingVNodes:e}=n;let s=e.get(t.type);return s||(s=Object.create(null),e.set(t.type,s)),s}function zc(n,t,e,s,i){const{appear:r,mode:o,persisted:a=!1,onBeforeEnter:c,onEnter:h,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:f,onLeave:p,onAfterLeave:m,onLeaveCancelled:b,onBeforeAppear:A,onAppear:v,onAfterAppear:_,onAppearCancelled:x}=t,S=String(n.key),C=xy(e,n),T=(P,F)=>{P&&_i(P,s,9,F)},R=(P,F)=>{const N=F[1];T(P,F),ht(P)?P.every(D=>D.length<=1)&&N():P.length<=1&&N()},L={mode:o,persisted:a,beforeEnter(P){let F=c;if(!e.isMounted)if(r)F=A||c;else return;P[Qn]&&P[Qn](!0);const N=C[S];N&&to(n,N)&&N.el[Qn]&&N.el[Qn](),T(F,[P])},enter(P){let F=h,N=u,D=d;if(!e.isMounted)if(r)F=v||h,N=_||u,D=x||d;else return;let tt=!1;const nt=P[Iu]=Nt=>{tt||(tt=!0,Nt?T(D,[P]):T(N,[P]),L.delayedLeave&&L.delayedLeave(),P[Iu]=void 0)};F?R(F,[P,nt]):nt()},leave(P,F){const N=String(n.key);if(P[Iu]&&P[Iu](!0),e.isUnmounting)return F();T(f,[P]);let D=!1;const tt=P[Qn]=nt=>{D||(D=!0,F(),nt?T(b,[P]):T(m,[P]),P[Qn]=void 0,C[N]===n&&delete C[N])};C[N]=n,p?R(p,[P,tt]):tt()},clone(P){const F=zc(P,t,e,s,i);return i&&i(F),F}};return L}function Nf(n){if(gf(n))return n=$r(n),n.children=null,n}function Lm(n){if(!gf(n))return by(n.type)&&n.children?Sy(n.children):n;const{shapeFlag:t,children:e}=n;if(e){if(t&16)return e[0];if(t&32&&pt(e.default))return e.default()}}function fa(n,t){n.shapeFlag&6&&n.component?(n.transition=t,fa(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function jg(n,t=!1,e){let s=[],i=0;for(let r=0;r<n.length;r++){let o=n[r];const a=e==null?o.key:String(e)+String(o.key!=null?o.key:r);o.type===Xt?(o.patchFlag&128&&i++,s=s.concat(jg(o.children,t,a))):(t||o.type!==rs)&&s.push(a!=null?$r(o,{key:a}):o)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function gs(n,t){return pt(n)?Ae({name:n.name},t,{setup:n}):n}function Ey(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Cd(n,t,e,s,i=!1){if(ht(n)){n.forEach((m,b)=>Cd(m,t&&(ht(t)?t[b]:t),e,s,i));return}if(Ba(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Cd(n,t,e,s.component.subTree);return}const r=s.shapeFlag&4?vf(s.component):s.el,o=i?null:r,{i:a,r:c}=n,h=t&&t.r,u=a.refs===Vt?a.refs={}:a.refs,d=a.setupState,f=Tt(d),p=d===Vt?()=>!1:m=>Rt(f,m);if(h!=null&&h!==c&&(re(h)?(u[h]=null,p(h)&&(d[h]=null)):Ye(h)&&(h.value=null)),pt(c))mu(c,a,12,[o,u]);else{const m=re(c),b=Ye(c);if(m||b){const A=()=>{if(n.f){const v=m?p(c)?d[c]:u[c]:c.value;i?ht(v)&&Ig(v,r):ht(v)?v.includes(r)||v.push(r):m?(u[c]=[r],p(c)&&(d[c]=u[c])):(c.value=[r],n.k&&(u[n.k]=c.value))}else m?(u[c]=o,p(c)&&(d[c]=o)):b&&(c.value=o,n.k&&(u[n.k]=o))};o?(A.id=-1,is(A,e)):A()}}}df().requestIdleCallback;df().cancelIdleCallback;const Ba=n=>!!n.type.__asyncLoader,gf=n=>n.type.__isKeepAlive;function _A(n,t){Cy(n,"a",t)}function SA(n,t){Cy(n,"da",t)}function Cy(n,t,e=Ne){const s=n.__wdc||(n.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(mf(t,s,e),e){let i=e.parent;for(;i&&i.parent;)gf(i.parent.vnode)&&xA(s,t,e,i),i=i.parent}}function xA(n,t,e,s){const i=mf(t,n,s,!0);bf(()=>{Ig(s[t],i)},e)}function mf(n,t,e=Ne,s=!1){if(e){const i=e[n]||(e[n]=[]),r=t.__weh||(t.__weh=(...o)=>{jr();const a=bu(e),c=_i(t,e,n,o);return a(),Gr(),c});return s?i.unshift(r):i.push(r),r}}const Wn=n=>(t,e=Ne)=>{(!jc||n==="sp")&&mf(n,(...s)=>t(...s),e)},EA=Wn("bm"),Wr=Wn("m"),CA=Wn("bu"),Ty=Wn("u"),Gg=Wn("bum"),bf=Wn("um"),TA=Wn("sp"),kA=Wn("rtg"),RA=Wn("rtc");function PA(n,t=Ne){mf("ec",n,t)}const MA="components";function IA(n,t){return DA(MA,n,!0,t)||n}const LA=Symbol.for("v-ndc");function DA(n,t,e=!0,s=!1){const i=Re||Ne;if(i){const r=i.type;{const a=__(r,!1);if(a&&(a===t||a===si(t)||a===uf(si(t))))return r}const o=Dm(i[n]||r[n],t)||Dm(i.appContext[n],t);return!o&&s?r:o}}function Dm(n,t){return n&&(n[t]||n[si(t)]||n[uf(si(t))])}function Hn(n,t,e,s){let i;const r=e,o=ht(n);if(o||re(n)){const a=o&&Oa(n);let c=!1;a&&(c=!Js(n),n=ff(n)),i=new Array(n.length);for(let h=0,u=n.length;h<u;h++)i[h]=t(c?Xe(n[h]):n[h],h,void 0,r)}else if(typeof n=="number"){i=new Array(n);for(let a=0;a<n;a++)i[a]=t(a+1,a,void 0,r)}else if(Yt(n))if(n[Symbol.iterator])i=Array.from(n,(a,c)=>t(a,c,void 0,r));else{const a=Object.keys(n);i=new Array(a.length);for(let c=0,h=a.length;c<h;c++){const u=a[c];i[c]=t(n[u],u,c,r)}}else i=[];return i}function ua(n,t,e={},s,i){if(Re.ce||Re.parent&&Ba(Re.parent)&&Re.parent.ce)return t!=="default"&&(e.name=t),q(),vi(Xt,null,[At("slot",e,s&&s())],64);let r=n[t];r&&r._c&&(r._d=!1),q();const o=r&&ky(r(e)),a=e.key||o&&o.key,c=vi(Xt,{key:(a&&!Gn(a)?a:`_${t}`)+(!o&&s?"_fb":"")},o||(s?s():[]),o&&n._===1?64:-2);return r&&r._c&&(r._d=!0),c}function ky(n){return n.some(t=>Vc(t)?!(t.type===rs||t.type===Xt&&!ky(t.children)):!0)?n:null}const np=n=>n?Yy(n)?vf(n):np(n.parent):null,Ic=Ae(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>np(n.parent),$root:n=>np(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>Py(n),$forceUpdate:n=>n.f||(n.f=()=>{Ug(n.update)}),$nextTick:n=>n.n||(n.n=mA.bind(n.proxy)),$watch:n=>s_.bind(n)}),Of=(n,t)=>n!==Vt&&!n.__isScriptSetup&&Rt(n,t),FA={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:i,props:r,accessCache:o,type:a,appContext:c}=n;let h;if(t[0]!=="$"){const p=o[t];if(p!==void 0)switch(p){case 1:return s[t];case 2:return i[t];case 4:return e[t];case 3:return r[t]}else{if(Of(s,t))return o[t]=1,s[t];if(i!==Vt&&Rt(i,t))return o[t]=2,i[t];if((h=n.propsOptions[0])&&Rt(h,t))return o[t]=3,r[t];if(e!==Vt&&Rt(e,t))return o[t]=4,e[t];rp&&(o[t]=0)}}const u=Ic[t];let d,f;if(u)return t==="$attrs"&&qe(n.attrs,"get",""),u(n);if((d=a.__cssModules)&&(d=d[t]))return d;if(e!==Vt&&Rt(e,t))return o[t]=4,e[t];if(f=c.config.globalProperties,Rt(f,t))return f[t]},set({_:n},t,e){const{data:s,setupState:i,ctx:r}=n;return Of(i,t)?(i[t]=e,!0):s!==Vt&&Rt(s,t)?(s[t]=e,!0):Rt(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(r[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:s,appContext:i,propsOptions:r}},o){let a;return!!e[o]||n!==Vt&&Rt(n,o)||Of(t,o)||(a=r[0])&&Rt(a,o)||Rt(s,o)||Rt(Ic,o)||Rt(i.config.globalProperties,o)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:Rt(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function Fm(n){return ht(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}let rp=!0;function NA(n){const t=Py(n),e=n.proxy,s=n.ctx;rp=!1,t.beforeCreate&&Nm(t.beforeCreate,n,"bc");const{data:i,computed:r,methods:o,watch:a,provide:c,inject:h,created:u,beforeMount:d,mounted:f,beforeUpdate:p,updated:m,activated:b,deactivated:A,beforeDestroy:v,beforeUnmount:_,destroyed:x,unmounted:S,render:C,renderTracked:T,renderTriggered:R,errorCaptured:L,serverPrefetch:P,expose:F,inheritAttrs:N,components:D,directives:tt,filters:nt}=t;if(h&&OA(h,s,null),o)for(const G in o){const Y=o[G];pt(Y)&&(s[G]=Y.bind(e))}if(i){const G=i.call(e,e);Yt(G)&&(n.data=Bg(G))}if(rp=!0,r)for(const G in r){const Y=r[G],lt=pt(Y)?Y.bind(e,e):pt(Y.get)?Y.get.bind(e,e):Ji,mt=!pt(Y)&&pt(Y.set)?Y.set.bind(e):Ji,Ht=ti({get:lt,set:mt});Object.defineProperty(s,G,{enumerable:!0,configurable:!0,get:()=>Ht.value,set:zt=>Ht.value=zt})}if(a)for(const G in a)Ry(a[G],s,e,G);if(c){const G=pt(c)?c.call(e):c;Reflect.ownKeys(G).forEach(Y=>{VA(Y,G[Y])})}u&&Nm(u,n,"c");function z(G,Y){ht(Y)?Y.forEach(lt=>G(lt.bind(e))):Y&&G(Y.bind(e))}if(z(EA,d),z(Wr,f),z(CA,p),z(Ty,m),z(_A,b),z(SA,A),z(PA,L),z(RA,T),z(kA,R),z(Gg,_),z(bf,S),z(TA,P),ht(F))if(F.length){const G=n.exposed||(n.exposed={});F.forEach(Y=>{Object.defineProperty(G,Y,{get:()=>e[Y],set:lt=>e[Y]=lt})})}else n.exposed||(n.exposed={});C&&n.render===Ji&&(n.render=C),N!=null&&(n.inheritAttrs=N),D&&(n.components=D),tt&&(n.directives=tt),P&&Ey(n)}function OA(n,t,e=Ji){ht(n)&&(n=op(n));for(const s in n){const i=n[s];let r;Yt(i)?"default"in i?r=Lc(i.from||s,i.default,!0):r=Lc(i.from||s):r=Lc(i),Ye(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[s]=r}}function Nm(n,t,e){_i(ht(n)?n.map(s=>s.bind(t.proxy)):n.bind(t.proxy),t,e)}function Ry(n,t,e,s){let i=s.includes(".")?Vy(e,s):()=>e[s];if(re(n)){const r=t[n];pt(r)&&za(i,r)}else if(pt(n))za(i,n.bind(e));else if(Yt(n))if(ht(n))n.forEach(r=>Ry(r,t,e,s));else{const r=pt(n.handler)?n.handler.bind(e):t[n.handler];pt(r)&&za(i,r,n)}}function Py(n){const t=n.type,{mixins:e,extends:s}=t,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=n.appContext,a=r.get(t);let c;return a?c=a:!i.length&&!e&&!s?c=t:(c={},i.length&&i.forEach(h=>Td(c,h,o,!0)),Td(c,t,o)),Yt(t)&&r.set(t,c),c}function Td(n,t,e,s=!1){const{mixins:i,extends:r}=t;r&&Td(n,r,e,!0),i&&i.forEach(o=>Td(n,o,e,!0));for(const o in t)if(!(s&&o==="expose")){const a=$A[o]||e&&e[o];n[o]=a?a(n[o],t[o]):t[o]}return n}const $A={data:Om,props:$m,emits:$m,methods:cc,computed:cc,beforeCreate:Ze,created:Ze,beforeMount:Ze,mounted:Ze,beforeUpdate:Ze,updated:Ze,beforeDestroy:Ze,beforeUnmount:Ze,destroyed:Ze,unmounted:Ze,activated:Ze,deactivated:Ze,errorCaptured:Ze,serverPrefetch:Ze,components:cc,directives:cc,watch:HA,provide:Om,inject:BA};function Om(n,t){return t?n?function(){return Ae(pt(n)?n.call(this,this):n,pt(t)?t.call(this,this):t)}:t:n}function BA(n,t){return cc(op(n),op(t))}function op(n){if(ht(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function Ze(n,t){return n?[...new Set([].concat(n,t))]:t}function cc(n,t){return n?Ae(Object.create(null),n,t):t}function $m(n,t){return n?ht(n)&&ht(t)?[...new Set([...n,...t])]:Ae(Object.create(null),Fm(n),Fm(t??{})):t}function HA(n,t){if(!n)return t;if(!t)return n;const e=Ae(Object.create(null),n);for(const s in t)e[s]=Ze(n[s],t[s]);return e}function My(){return{app:null,config:{isNativeTag:k0,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let zA=0;function UA(n,t){return function(s,i=null){pt(s)||(s=Ae({},s)),i!=null&&!Yt(i)&&(i=null);const r=My(),o=new WeakSet,a=[];let c=!1;const h=r.app={_uid:zA++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:E_,get config(){return r.config},set config(u){},use(u,...d){return o.has(u)||(u&&pt(u.install)?(o.add(u),u.install(h,...d)):pt(u)&&(o.add(u),u(h,...d))),h},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),h},component(u,d){return d?(r.components[u]=d,h):r.components[u]},directive(u,d){return d?(r.directives[u]=d,h):r.directives[u]},mount(u,d,f){if(!c){const p=h._ceVNode||At(s,i);return p.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),n(p,u,f),c=!0,h._container=u,u.__vue_app__=h,vf(p.component)}},onUnmount(u){a.push(u)},unmount(){c&&(_i(a,h._instance,16),n(null,h._container),delete h._container.__vue_app__)},provide(u,d){return r.provides[u]=d,h},runWithContext(u){const d=Ha;Ha=h;try{return u()}finally{Ha=d}}};return h}}let Ha=null;function VA(n,t){if(Ne){let e=Ne.provides;const s=Ne.parent&&Ne.parent.provides;s===e&&(e=Ne.provides=Object.create(s)),e[n]=t}}function Lc(n,t,e=!1){const s=Ne||Re;if(s||Ha){const i=Ha?Ha._context.provides:s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return e&&pt(t)?t.call(s&&s.proxy):t}}const Iy={},Ly=()=>Object.create(Iy),Dy=n=>Object.getPrototypeOf(n)===Iy;function jA(n,t,e,s=!1){const i={},r=Ly();n.propsDefaults=Object.create(null),Fy(n,t,i,r);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);e?n.props=s?i:oA(i):n.type.props?n.props=i:n.props=r,n.attrs=r}function GA(n,t,e,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=n,a=Tt(i),[c]=n.propsOptions;let h=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let d=0;d<u.length;d++){let f=u[d];if(yf(n.emitsOptions,f))continue;const p=t[f];if(c)if(Rt(r,f))p!==r[f]&&(r[f]=p,h=!0);else{const m=si(f);i[m]=ap(c,a,m,p,n,!1)}else p!==r[f]&&(r[f]=p,h=!0)}}}else{Fy(n,t,i,r)&&(h=!0);let u;for(const d in a)(!t||!Rt(t,d)&&((u=ya(d))===d||!Rt(t,u)))&&(c?e&&(e[d]!==void 0||e[u]!==void 0)&&(i[d]=ap(c,a,d,void 0,n,!0)):delete i[d]);if(r!==a)for(const d in r)(!t||!Rt(t,d))&&(delete r[d],h=!0)}h&&Nn(n.attrs,"set","")}function Fy(n,t,e,s){const[i,r]=n.propsOptions;let o=!1,a;if(t)for(let c in t){if(kc(c))continue;const h=t[c];let u;i&&Rt(i,u=si(c))?!r||!r.includes(u)?e[u]=h:(a||(a={}))[u]=h:yf(n.emitsOptions,c)||(!(c in s)||h!==s[c])&&(s[c]=h,o=!0)}if(r){const c=Tt(e),h=a||Vt;for(let u=0;u<r.length;u++){const d=r[u];e[d]=ap(i,c,d,h[d],n,!Rt(h,d))}}return o}function ap(n,t,e,s,i,r){const o=n[e];if(o!=null){const a=Rt(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&pt(c)){const{propsDefaults:h}=i;if(e in h)s=h[e];else{const u=bu(i);s=h[e]=c.call(null,t),u()}}else s=c;i.ce&&i.ce._setProp(e,s)}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===ya(e))&&(s=!0))}return s}const WA=new WeakMap;function Ny(n,t,e=!1){const s=e?WA:t.propsCache,i=s.get(n);if(i)return i;const r=n.props,o={},a=[];let c=!1;if(!pt(n)){const u=d=>{c=!0;const[f,p]=Ny(d,t,!0);Ae(o,f),p&&a.push(...p)};!e&&t.mixins.length&&t.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!r&&!c)return Yt(n)&&s.set(n,Fa),Fa;if(ht(r))for(let u=0;u<r.length;u++){const d=si(r[u]);Bm(d)&&(o[d]=Vt)}else if(r)for(const u in r){const d=si(u);if(Bm(d)){const f=r[u],p=o[d]=ht(f)||pt(f)?{type:f}:Ae({},f),m=p.type;let b=!1,A=!0;if(ht(m))for(let v=0;v<m.length;++v){const _=m[v],x=pt(_)&&_.name;if(x==="Boolean"){b=!0;break}else x==="String"&&(A=!1)}else b=pt(m)&&m.name==="Boolean";p[0]=b,p[1]=A,(b||Rt(p,"default"))&&a.push(d)}}const h=[o,a];return Yt(n)&&s.set(n,h),h}function Bm(n){return n[0]!=="$"&&!kc(n)}const Oy=n=>n[0]==="_"||n==="$stable",Wg=n=>ht(n)?n.map(Qi):[Qi(n)],qA=(n,t,e)=>{if(t._n)return t;const s=Ys((...i)=>Wg(t(...i)),e);return s._c=!1,s},$y=(n,t,e)=>{const s=n._ctx;for(const i in n){if(Oy(i))continue;const r=n[i];if(pt(r))t[i]=qA(i,r,s);else if(r!=null){const o=Wg(r);t[i]=()=>o}}},By=(n,t)=>{const e=Wg(t);n.slots.default=()=>e},Hy=(n,t,e)=>{for(const s in t)(e||s!=="_")&&(n[s]=t[s])},XA=(n,t,e)=>{const s=n.slots=Ly();if(n.vnode.shapeFlag&32){const i=t._;i?(Hy(s,t,e),e&&Gb(s,"_",i,!0)):$y(t,s)}else t&&By(n,t)},YA=(n,t,e)=>{const{vnode:s,slots:i}=n;let r=!0,o=Vt;if(s.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:Hy(i,t,e):(r=!t.$stable,$y(t,i)),o=t}else t&&(By(n,t),o={default:1});if(r)for(const a in i)!Oy(a)&&o[a]==null&&delete i[a]},is=c_;function KA(n){return ZA(n)}function ZA(n,t){const e=df();e.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:a,createComment:c,setText:h,setElementText:u,parentNode:d,nextSibling:f,setScopeId:p=Ji,insertStaticContent:m}=n,b=(E,k,I,B=null,O=null,$=null,X=void 0,j=null,V=!!k.dynamicChildren)=>{if(E===k)return;E&&!to(E,k)&&(B=Ut(E),zt(E,O,$,!0),E=null),k.patchFlag===-2&&(V=!1,k.dynamicChildren=null);const{type:H,ref:ct,shapeFlag:K}=k;switch(H){case wf:A(E,k,I,B);break;case rs:v(E,k,I,B);break;case Uu:E==null&&_(k,I,B,X);break;case Xt:D(E,k,I,B,O,$,X,j,V);break;default:K&1?C(E,k,I,B,O,$,X,j,V):K&6?tt(E,k,I,B,O,$,X,j,V):(K&64||K&128)&&H.process(E,k,I,B,O,$,X,j,V,ii)}ct!=null&&O&&Cd(ct,E&&E.ref,$,k||E,!k)},A=(E,k,I,B)=>{if(E==null)s(k.el=a(k.children),I,B);else{const O=k.el=E.el;k.children!==E.children&&h(O,k.children)}},v=(E,k,I,B)=>{E==null?s(k.el=c(k.children||""),I,B):k.el=E.el},_=(E,k,I,B)=>{[E.el,E.anchor]=m(E.children,k,I,B,E.el,E.anchor)},x=({el:E,anchor:k},I,B)=>{let O;for(;E&&E!==k;)O=f(E),s(E,I,B),E=O;s(k,I,B)},S=({el:E,anchor:k})=>{let I;for(;E&&E!==k;)I=f(E),i(E),E=I;i(k)},C=(E,k,I,B,O,$,X,j,V)=>{k.type==="svg"?X="svg":k.type==="math"&&(X="mathml"),E==null?T(k,I,B,O,$,X,j,V):P(E,k,O,$,X,j,V)},T=(E,k,I,B,O,$,X,j)=>{let V,H;const{props:ct,shapeFlag:K,transition:rt,dirs:ut}=E;if(V=E.el=o(E.type,$,ct&&ct.is,ct),K&8?u(V,E.children):K&16&&L(E.children,V,null,B,O,$f(E,$),X,j),ut&&qr(E,null,B,"created"),R(V,E,E.scopeId,X,B),ct){for(const jt in ct)jt!=="value"&&!kc(jt)&&r(V,jt,null,ct[jt],$,B);"value"in ct&&r(V,"value",null,ct.value,$),(H=ct.onVnodeBeforeMount)&&Ri(H,B,E)}ut&&qr(E,null,B,"beforeMount");const xt=QA(O,rt);xt&&rt.beforeEnter(V),s(V,k,I),((H=ct&&ct.onVnodeMounted)||xt||ut)&&is(()=>{H&&Ri(H,B,E),xt&&rt.enter(V),ut&&qr(E,null,B,"mounted")},O)},R=(E,k,I,B,O)=>{if(I&&p(E,I),B)for(let $=0;$<B.length;$++)p(E,B[$]);if(O){let $=O.subTree;if(k===$||Gy($.type)&&($.ssContent===k||$.ssFallback===k)){const X=O.vnode;R(E,X,X.scopeId,X.slotScopeIds,O.parent)}}},L=(E,k,I,B,O,$,X,j,V=0)=>{for(let H=V;H<E.length;H++){const ct=E[H]=j?Jn(E[H]):Qi(E[H]);b(null,ct,k,I,B,O,$,X,j)}},P=(E,k,I,B,O,$,X)=>{const j=k.el=E.el;let{patchFlag:V,dynamicChildren:H,dirs:ct}=k;V|=E.patchFlag&16;const K=E.props||Vt,rt=k.props||Vt;let ut;if(I&&Xr(I,!1),(ut=rt.onVnodeBeforeUpdate)&&Ri(ut,I,k,E),ct&&qr(k,E,I,"beforeUpdate"),I&&Xr(I,!0),(K.innerHTML&&rt.innerHTML==null||K.textContent&&rt.textContent==null)&&u(j,""),H?F(E.dynamicChildren,H,j,I,B,$f(k,O),$):X||Y(E,k,j,null,I,B,$f(k,O),$,!1),V>0){if(V&16)N(j,K,rt,I,O);else if(V&2&&K.class!==rt.class&&r(j,"class",null,rt.class,O),V&4&&r(j,"style",K.style,rt.style,O),V&8){const xt=k.dynamicProps;for(let jt=0;jt<xt.length;jt++){const Lt=xt[jt],ms=K[Lt],ls=rt[Lt];(ls!==ms||Lt==="value")&&r(j,Lt,ms,ls,O,I)}}V&1&&E.children!==k.children&&u(j,k.children)}else!X&&H==null&&N(j,K,rt,I,O);((ut=rt.onVnodeUpdated)||ct)&&is(()=>{ut&&Ri(ut,I,k,E),ct&&qr(k,E,I,"updated")},B)},F=(E,k,I,B,O,$,X)=>{for(let j=0;j<k.length;j++){const V=E[j],H=k[j],ct=V.el&&(V.type===Xt||!to(V,H)||V.shapeFlag&70)?d(V.el):I;b(V,H,ct,null,B,O,$,X,!0)}},N=(E,k,I,B,O)=>{if(k!==I){if(k!==Vt)for(const $ in k)!kc($)&&!($ in I)&&r(E,$,k[$],null,O,B);for(const $ in I){if(kc($))continue;const X=I[$],j=k[$];X!==j&&$!=="value"&&r(E,$,j,X,O,B)}"value"in I&&r(E,"value",k.value,I.value,O)}},D=(E,k,I,B,O,$,X,j,V)=>{const H=k.el=E?E.el:a(""),ct=k.anchor=E?E.anchor:a("");let{patchFlag:K,dynamicChildren:rt,slotScopeIds:ut}=k;ut&&(j=j?j.concat(ut):ut),E==null?(s(H,I,B),s(ct,I,B),L(k.children||[],I,ct,O,$,X,j,V)):K>0&&K&64&&rt&&E.dynamicChildren?(F(E.dynamicChildren,rt,I,O,$,X,j),(k.key!=null||O&&k===O.subTree)&&qg(E,k,!0)):Y(E,k,I,ct,O,$,X,j,V)},tt=(E,k,I,B,O,$,X,j,V)=>{k.slotScopeIds=j,E==null?k.shapeFlag&512?O.ctx.activate(k,I,B,X,V):nt(k,I,B,O,$,X,V):Nt(E,k,V)},nt=(E,k,I,B,O,$,X)=>{const j=E.component=b_(E,B,O);if(gf(E)&&(j.ctx.renderer=ii),y_(j,!1,X),j.asyncDep){if(O&&O.registerDep(j,z,X),!E.el){const V=j.subTree=At(rs);v(null,V,k,I)}}else z(j,E,k,I,O,$,X)},Nt=(E,k,I)=>{const B=k.component=E.component;if(a_(E,k,I))if(B.asyncDep&&!B.asyncResolved){G(B,k,I);return}else B.next=k,B.update();else k.el=E.el,B.vnode=k},z=(E,k,I,B,O,$,X)=>{const j=()=>{if(E.isMounted){let{next:K,bu:rt,u:ut,parent:xt,vnode:jt}=E;{const Ti=zy(E);if(Ti){K&&(K.el=jt.el,G(E,K,X)),Ti.asyncDep.then(()=>{E.isUnmounted||j()});return}}let Lt=K,ms;Xr(E,!1),K?(K.el=jt.el,G(E,K,X)):K=jt,rt&&Hu(rt),(ms=K.props&&K.props.onVnodeBeforeUpdate)&&Ri(ms,xt,K,jt),Xr(E,!0);const ls=zm(E),Ci=E.subTree;E.subTree=ls,b(Ci,ls,d(Ci.el),Ut(Ci),E,O,$),K.el=ls.el,Lt===null&&l_(E,ls.el),ut&&is(ut,O),(ms=K.props&&K.props.onVnodeUpdated)&&is(()=>Ri(ms,xt,K,jt),O)}else{let K;const{el:rt,props:ut}=k,{bm:xt,m:jt,parent:Lt,root:ms,type:ls}=E,Ci=Ba(k);Xr(E,!1),xt&&Hu(xt),!Ci&&(K=ut&&ut.onVnodeBeforeMount)&&Ri(K,Lt,k),Xr(E,!0);{ms.ce&&ms.ce._injectChildStyle(ls);const Ti=E.subTree=zm(E);b(null,Ti,I,B,E,O,$),k.el=Ti.el}if(jt&&is(jt,O),!Ci&&(K=ut&&ut.onVnodeMounted)){const Ti=k;is(()=>Ri(K,Lt,Ti),O)}(k.shapeFlag&256||Lt&&Ba(Lt.vnode)&&Lt.vnode.shapeFlag&256)&&E.a&&is(E.a,O),E.isMounted=!0,k=I=B=null}};E.scope.on();const V=E.effect=new Yb(j);E.scope.off();const H=E.update=V.run.bind(V),ct=E.job=V.runIfDirty.bind(V);ct.i=E,ct.id=E.uid,V.scheduler=()=>Ug(ct),Xr(E,!0),H()},G=(E,k,I)=>{k.component=E;const B=E.vnode.props;E.vnode=k,E.next=null,GA(E,k.props,B,I),YA(E,k.children,I),jr(),Rm(E),Gr()},Y=(E,k,I,B,O,$,X,j,V=!1)=>{const H=E&&E.children,ct=E?E.shapeFlag:0,K=k.children,{patchFlag:rt,shapeFlag:ut}=k;if(rt>0){if(rt&128){mt(H,K,I,B,O,$,X,j,V);return}else if(rt&256){lt(H,K,I,B,O,$,X,j,V);return}}ut&8?(ct&16&&Be(H,O,$),K!==H&&u(I,K)):ct&16?ut&16?mt(H,K,I,B,O,$,X,j,V):Be(H,O,$,!0):(ct&8&&u(I,""),ut&16&&L(K,I,B,O,$,X,j,V))},lt=(E,k,I,B,O,$,X,j,V)=>{E=E||Fa,k=k||Fa;const H=E.length,ct=k.length,K=Math.min(H,ct);let rt;for(rt=0;rt<K;rt++){const ut=k[rt]=V?Jn(k[rt]):Qi(k[rt]);b(E[rt],ut,I,null,O,$,X,j,V)}H>ct?Be(E,O,$,!0,!1,K):L(k,I,B,O,$,X,j,V,K)},mt=(E,k,I,B,O,$,X,j,V)=>{let H=0;const ct=k.length;let K=E.length-1,rt=ct-1;for(;H<=K&&H<=rt;){const ut=E[H],xt=k[H]=V?Jn(k[H]):Qi(k[H]);if(to(ut,xt))b(ut,xt,I,null,O,$,X,j,V);else break;H++}for(;H<=K&&H<=rt;){const ut=E[K],xt=k[rt]=V?Jn(k[rt]):Qi(k[rt]);if(to(ut,xt))b(ut,xt,I,null,O,$,X,j,V);else break;K--,rt--}if(H>K){if(H<=rt){const ut=rt+1,xt=ut<ct?k[ut].el:B;for(;H<=rt;)b(null,k[H]=V?Jn(k[H]):Qi(k[H]),I,xt,O,$,X,j,V),H++}}else if(H>rt)for(;H<=K;)zt(E[H],O,$,!0),H++;else{const ut=H,xt=H,jt=new Map;for(H=xt;H<=rt;H++){const bs=k[H]=V?Jn(k[H]):Qi(k[H]);bs.key!=null&&jt.set(bs.key,H)}let Lt,ms=0;const ls=rt-xt+1;let Ci=!1,Ti=0;const Ql=new Array(ls);for(H=0;H<ls;H++)Ql[H]=0;for(H=ut;H<=K;H++){const bs=E[H];if(ms>=ls){zt(bs,O,$,!0);continue}let ki;if(bs.key!=null)ki=jt.get(bs.key);else for(Lt=xt;Lt<=rt;Lt++)if(Ql[Lt-xt]===0&&to(bs,k[Lt])){ki=Lt;break}ki===void 0?zt(bs,O,$,!0):(Ql[ki-xt]=H+1,ki>=Ti?Ti=ki:Ci=!0,b(bs,k[ki],I,null,O,$,X,j,V),ms++)}const Sm=Ci?JA(Ql):Fa;for(Lt=Sm.length-1,H=ls-1;H>=0;H--){const bs=xt+H,ki=k[bs],xm=bs+1<ct?k[bs+1].el:B;Ql[H]===0?b(null,ki,I,xm,O,$,X,j,V):Ci&&(Lt<0||H!==Sm[Lt]?Ht(ki,I,xm,2):Lt--)}}},Ht=(E,k,I,B,O=null)=>{const{el:$,type:X,transition:j,children:V,shapeFlag:H}=E;if(H&6){Ht(E.component.subTree,k,I,B);return}if(H&128){E.suspense.move(k,I,B);return}if(H&64){X.move(E,k,I,ii);return}if(X===Xt){s($,k,I);for(let K=0;K<V.length;K++)Ht(V[K],k,I,B);s(E.anchor,k,I);return}if(X===Uu){x(E,k,I);return}if(B!==2&&H&1&&j)if(B===0)j.beforeEnter($),s($,k,I),is(()=>j.enter($),O);else{const{leave:K,delayLeave:rt,afterLeave:ut}=j,xt=()=>s($,k,I),jt=()=>{K($,()=>{xt(),ut&&ut()})};rt?rt($,xt,jt):jt()}else s($,k,I)},zt=(E,k,I,B=!1,O=!1)=>{const{type:$,props:X,ref:j,children:V,dynamicChildren:H,shapeFlag:ct,patchFlag:K,dirs:rt,cacheIndex:ut}=E;if(K===-2&&(O=!1),j!=null&&Cd(j,null,I,E,!0),ut!=null&&(k.renderCache[ut]=void 0),ct&256){k.ctx.deactivate(E);return}const xt=ct&1&&rt,jt=!Ba(E);let Lt;if(jt&&(Lt=X&&X.onVnodeBeforeUnmount)&&Ri(Lt,k,E),ct&6)Ei(E.component,I,B);else{if(ct&128){E.suspense.unmount(I,B);return}xt&&qr(E,null,k,"beforeUnmount"),ct&64?E.type.remove(E,k,I,ii,B):H&&!H.hasOnce&&($!==Xt||K>0&&K&64)?Be(H,k,I,!1,!0):($===Xt&&K&384||!O&&ct&16)&&Be(V,k,I),B&&ee(E)}(jt&&(Lt=X&&X.onVnodeUnmounted)||xt)&&is(()=>{Lt&&Ri(Lt,k,E),xt&&qr(E,null,k,"unmounted")},I)},ee=E=>{const{type:k,el:I,anchor:B,transition:O}=E;if(k===Xt){qn(I,B);return}if(k===Uu){S(E);return}const $=()=>{i(I),O&&!O.persisted&&O.afterLeave&&O.afterLeave()};if(E.shapeFlag&1&&O&&!O.persisted){const{leave:X,delayLeave:j}=O,V=()=>X(I,$);j?j(E.el,$,V):V()}else $()},qn=(E,k)=>{let I;for(;E!==k;)I=f(E),i(E),E=I;i(k)},Ei=(E,k,I)=>{const{bum:B,scope:O,job:$,subTree:X,um:j,m:V,a:H}=E;Hm(V),Hm(H),B&&Hu(B),O.stop(),$&&($.flags|=8,zt(X,E,k,I)),j&&is(j,k),is(()=>{E.isUnmounted=!0},k),k&&k.pendingBranch&&!k.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===k.pendingId&&(k.deps--,k.deps===0&&k.resolve())},Be=(E,k,I,B=!1,O=!1,$=0)=>{for(let X=$;X<E.length;X++)zt(E[X],k,I,B,O)},Ut=E=>{if(E.shapeFlag&6)return Ut(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const k=f(E.anchor||E.el),I=k&&k[my];return I?f(I):k};let Zl=!1;const Cu=(E,k,I)=>{E==null?k._vnode&&zt(k._vnode,null,null,!0):b(k._vnode||null,E,k,null,null,null,I),k._vnode=E,Zl||(Zl=!0,Rm(),fy(),Zl=!1)},ii={p:b,um:zt,m:Ht,r:ee,mt:nt,mc:L,pc:Y,pbc:F,n:Ut,o:n};return{render:Cu,hydrate:void 0,createApp:UA(Cu)}}function $f({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function Xr({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function QA(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function qg(n,t,e=!1){const s=n.children,i=t.children;if(ht(s)&&ht(i))for(let r=0;r<s.length;r++){const o=s[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=Jn(i[r]),a.el=o.el),!e&&a.patchFlag!==-2&&qg(o,a)),a.type===wf&&(a.el=o.el)}}function JA(n){const t=n.slice(),e=[0];let s,i,r,o,a;const c=n.length;for(s=0;s<c;s++){const h=n[s];if(h!==0){if(i=e[e.length-1],n[i]<h){t[s]=i,e.push(s);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,n[e[a]]<h?r=a+1:o=a;h<n[e[r]]&&(r>0&&(t[s]=e[r-1]),e[r]=s)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function zy(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:zy(t)}function Hm(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const t_=Symbol.for("v-scx"),e_=()=>Lc(t_);function za(n,t,e){return Uy(n,t,e)}function Uy(n,t,e=Vt){const{immediate:s,deep:i,flush:r,once:o}=e,a=Ae({},e),c=t&&s||!t&&r!=="post";let h;if(jc){if(r==="sync"){const p=e_();h=p.__watcherHandles||(p.__watcherHandles=[])}else if(!c){const p=()=>{};return p.stop=Ji,p.resume=Ji,p.pause=Ji,p}}const u=Ne;a.call=(p,m,b)=>_i(p,u,m,b);let d=!1;r==="post"?a.scheduler=p=>{is(p,u&&u.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(p,m)=>{m?p():Ug(p)}),a.augmentJob=p=>{t&&(p.flags|=4),d&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const f=pA(n,t,a);return jc&&(h?h.push(f):c&&f()),f}function s_(n,t,e){const s=this.proxy,i=re(n)?n.includes(".")?Vy(s,n):()=>s[n]:n.bind(s,s);let r;pt(t)?r=t:(r=t.handler,e=t);const o=bu(this),a=Uy(i,r.bind(s),e);return o(),a}function Vy(n,t){const e=t.split(".");return()=>{let s=n;for(let i=0;i<e.length&&s;i++)s=s[e[i]];return s}}const i_=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${si(t)}Modifiers`]||n[`${ya(t)}Modifiers`];function n_(n,t,...e){if(n.isUnmounted)return;const s=n.vnode.props||Vt;let i=e;const r=t.startsWith("update:"),o=r&&i_(s,t.slice(7));o&&(o.trim&&(i=e.map(u=>re(u)?u.trim():u)),o.number&&(i=e.map(Zf)));let a,c=s[a=Mf(t)]||s[a=Mf(si(t))];!c&&r&&(c=s[a=Mf(ya(t))]),c&&_i(c,n,6,i);const h=s[a+"Once"];if(h){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,_i(h,n,6,i)}}function jy(n,t,e=!1){const s=t.emitsCache,i=s.get(n);if(i!==void 0)return i;const r=n.emits;let o={},a=!1;if(!pt(n)){const c=h=>{const u=jy(h,t,!0);u&&(a=!0,Ae(o,u))};!e&&t.mixins.length&&t.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}return!r&&!a?(Yt(n)&&s.set(n,null),null):(ht(r)?r.forEach(c=>o[c]=null):Ae(o,r),Yt(n)&&s.set(n,o),o)}function yf(n,t){return!n||!lf(t)?!1:(t=t.slice(2).replace(/Once$/,""),Rt(n,t[0].toLowerCase()+t.slice(1))||Rt(n,ya(t))||Rt(n,t))}function zm(n){const{type:t,vnode:e,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:a,emit:c,render:h,renderCache:u,props:d,data:f,setupState:p,ctx:m,inheritAttrs:b}=n,A=xd(n);let v,_;try{if(e.shapeFlag&4){const S=i||s,C=S;v=Qi(h.call(C,S,u,d,p,f,m)),_=a}else{const S=t;v=Qi(S.length>1?S(d,{attrs:a,slots:o,emit:c}):S(d,null)),_=t.props?a:r_(a)}}catch(S){Dc.length=0,pf(S,n,1),v=At(rs)}let x=v;if(_&&b!==!1){const S=Object.keys(_),{shapeFlag:C}=x;S.length&&C&7&&(r&&S.some(Mg)&&(_=o_(_,r)),x=$r(x,_,!1,!0))}return e.dirs&&(x=$r(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(e.dirs):e.dirs),e.transition&&fa(x,e.transition),v=x,xd(A),v}const r_=n=>{let t;for(const e in n)(e==="class"||e==="style"||lf(e))&&((t||(t={}))[e]=n[e]);return t},o_=(n,t)=>{const e={};for(const s in n)(!Mg(s)||!(s.slice(9)in t))&&(e[s]=n[s]);return e};function a_(n,t,e){const{props:s,children:i,component:r}=n,{props:o,children:a,patchFlag:c}=t,h=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&c>=0){if(c&1024)return!0;if(c&16)return s?Um(s,o,h):!!o;if(c&8){const u=t.dynamicProps;for(let d=0;d<u.length;d++){const f=u[d];if(o[f]!==s[f]&&!yf(h,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Um(s,o,h):!0:!!o;return!1}function Um(n,t,e){const s=Object.keys(t);if(s.length!==Object.keys(n).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(t[r]!==n[r]&&!yf(e,r))return!0}return!1}function l_({vnode:n,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===n&&(s.el=n.el),s===n)(n=t.vnode).el=e,t=t.parent;else break}}const Gy=n=>n.__isSuspense;function c_(n,t){t&&t.pendingBranch?ht(n)?t.effects.push(...n):t.effects.push(n):yA(n)}const Xt=Symbol.for("v-fgt"),wf=Symbol.for("v-txt"),rs=Symbol.for("v-cmt"),Uu=Symbol.for("v-stc"),Dc=[];let Ns=null;function q(n=!1){Dc.push(Ns=n?null:[])}function h_(){Dc.pop(),Ns=Dc[Dc.length-1]||null}let Uc=1;function Vm(n,t=!1){Uc+=n,n<0&&Ns&&t&&(Ns.hasOnce=!0)}function Wy(n){return n.dynamicChildren=Uc>0?Ns||Fa:null,h_(),Uc>0&&Ns&&Ns.push(n),n}function et(n,t,e,s,i,r){return Wy(M(n,t,e,s,i,r,!0))}function vi(n,t,e,s,i){return Wy(At(n,t,e,s,i,!0))}function Vc(n){return n?n.__v_isVNode===!0:!1}function to(n,t){return n.type===t.type&&n.key===t.key}const qy=({key:n})=>n??null,Vu=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?re(n)||Ye(n)||pt(n)?{i:Re,r:n,k:t,f:!!e}:n:null);function M(n,t=null,e=null,s=0,i=null,r=n===Xt?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&qy(t),ref:t&&Vu(t),scopeId:gy,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Re};return a?(Xg(c,e),r&128&&n.normalize(c)):e&&(c.shapeFlag|=re(e)?8:16),Uc>0&&!o&&Ns&&(c.patchFlag>0||r&6)&&c.patchFlag!==32&&Ns.push(c),c}const At=u_;function u_(n,t=null,e=null,s=0,i=null,r=!1){if((!n||n===LA)&&(n=rs),Vc(n)){const a=$r(n,t,!0);return e&&Xg(a,e),Uc>0&&!r&&Ns&&(a.shapeFlag&6?Ns[Ns.indexOf(n)]=a:Ns.push(a)),a.patchFlag=-2,a}if(S_(n)&&(n=n.__vccOpts),t){t=d_(t);let{class:a,style:c}=t;a&&!re(a)&&(t.class=pe(a)),Yt(c)&&(zg(c)&&!ht(c)&&(c=Ae({},c)),t.style=Ai(c))}const o=re(n)?1:Gy(n)?128:by(n)?64:Yt(n)?4:pt(n)?2:0;return M(n,t,e,s,i,o,r,!0)}function d_(n){return n?zg(n)||Dy(n)?Ae({},n):n:null}function $r(n,t,e=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:a,transition:c}=n,h=t?p_(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:h,key:h&&qy(h),ref:t&&t.ref?e&&r?ht(r)?r.concat(Vu(t)):[r,Vu(t)]:Vu(t):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==Xt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:c,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&$r(n.ssContent),ssFallback:n.ssFallback&&$r(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return c&&s&&fa(u,c.clone(u)),u}function hc(n=" ",t=0){return At(wf,null,n,t)}function f_(n,t){const e=At(Uu,null,n);return e.staticCount=t,e}function de(n="",t=!1){return t?(q(),vi(rs,null,n)):At(rs,null,n)}function Qi(n){return n==null||typeof n=="boolean"?At(rs):ht(n)?At(Xt,null,n.slice()):Vc(n)?Jn(n):At(wf,null,String(n))}function Jn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:$r(n)}function Xg(n,t){let e=0;const{shapeFlag:s}=n;if(t==null)t=null;else if(ht(t))e=16;else if(typeof t=="object")if(s&65){const i=t.default;i&&(i._c&&(i._d=!1),Xg(n,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!Dy(t)?t._ctx=Re:i===3&&Re&&(Re.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else pt(t)?(t={default:t,_ctx:Re},e=32):(t=String(t),s&64?(e=16,t=[hc(t)]):e=8);n.children=t,n.shapeFlag|=e}function p_(...n){const t={};for(let e=0;e<n.length;e++){const s=n[e];for(const i in s)if(i==="class")t.class!==s.class&&(t.class=pe([t.class,s.class]));else if(i==="style")t.style=Ai([t.style,s.style]);else if(lf(i)){const r=t[i],o=s[i];o&&r!==o&&!(ht(r)&&r.includes(o))&&(t[i]=r?[].concat(r,o):o)}else i!==""&&(t[i]=s[i])}return t}function Ri(n,t,e,s=null){_i(n,t,7,[e,s])}const g_=My();let m_=0;function b_(n,t,e){const s=n.type,i=(t?t.appContext:n.appContext)||g_,r={uid:m_++,vnode:n,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new H0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ny(s,i),emitsOptions:jy(s,i),emit:null,emitted:null,propsDefaults:Vt,inheritAttrs:s.inheritAttrs,ctx:Vt,data:Vt,props:Vt,attrs:Vt,slots:Vt,refs:Vt,setupState:Vt,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=n_.bind(null,r),n.ce&&n.ce(r),r}let Ne=null;const Xy=()=>Ne||Re;let kd,lp;{const n=df(),t=(e,s)=>{let i;return(i=n[e])||(i=n[e]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};kd=t("__VUE_INSTANCE_SETTERS__",e=>Ne=e),lp=t("__VUE_SSR_SETTERS__",e=>jc=e)}const bu=n=>{const t=Ne;return kd(n),n.scope.on(),()=>{n.scope.off(),kd(t)}},jm=()=>{Ne&&Ne.scope.off(),kd(null)};function Yy(n){return n.vnode.shapeFlag&4}let jc=!1;function y_(n,t=!1,e=!1){t&&lp(t);const{props:s,children:i}=n.vnode,r=Yy(n);jA(n,s,r,t),XA(n,i,e);const o=r?w_(n,t):void 0;return t&&lp(!1),o}function w_(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,FA);const{setup:s}=e;if(s){jr();const i=n.setupContext=s.length>1?A_(n):null,r=bu(n),o=mu(s,n,0,[n.props,i]),a=Ub(o);if(Gr(),r(),(a||n.sp)&&!Ba(n)&&Ey(n),a){if(o.then(jm,jm),t)return o.then(c=>{Gm(n,c)}).catch(c=>{pf(c,n,0)});n.asyncDep=o}else Gm(n,o)}else Ky(n)}function Gm(n,t,e){pt(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Yt(t)&&(n.setupState=hy(t)),Ky(n)}function Ky(n,t,e){const s=n.type;n.render||(n.render=s.render||Ji);{const i=bu(n);jr();try{NA(n)}finally{Gr(),i()}}}const v_={get(n,t){return qe(n,"get",""),n[t]}};function A_(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,v_),slots:n.slots,emit:n.emit,expose:t}}function vf(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(hy(aA(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in Ic)return Ic[e](n)},has(t,e){return e in t||e in Ic}})):n.proxy}function __(n,t=!0){return pt(n)?n.displayName||n.name:n.name||t&&n.__name}function S_(n){return pt(n)&&"__vccOpts"in n}const ti=(n,t)=>dA(n,t,jc);function x_(n,t,e){const s=arguments.length;return s===2?Yt(t)&&!ht(t)?Vc(t)?At(n,null,[t]):At(n,t):At(n,null,t):(s>3?e=Array.prototype.slice.call(arguments,2):s===3&&Vc(e)&&(e=[e]),At(n,t,e))}const E_="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let cp;const Wm=typeof window<"u"&&window.trustedTypes;if(Wm)try{cp=Wm.createPolicy("vue",{createHTML:n=>n})}catch{}const Zy=cp?n=>cp.createHTML(n):n=>n,C_="http://www.w3.org/2000/svg",T_="http://www.w3.org/1998/Math/MathML",on=typeof document<"u"?document:null,qm=on&&on.createElement("template"),k_={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,s)=>{const i=t==="svg"?on.createElementNS(C_,n):t==="mathml"?on.createElementNS(T_,n):e?on.createElement(n,{is:e}):on.createElement(n);return n==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:n=>on.createTextNode(n),createComment:n=>on.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>on.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,s,i,r){const o=e?e.previousSibling:t.lastChild;if(i&&(i===r||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),e),!(i===r||!(i=i.nextSibling)););else{qm.innerHTML=Zy(s==="svg"?`<svg>${n}</svg>`:s==="mathml"?`<math>${n}</math>`:n);const a=qm.content;if(s==="svg"||s==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},Xn="transition",tc="animation",Kl=Symbol("_vtc"),Qy={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Jy=Ae({},Ay,Qy),R_=n=>(n.displayName="Transition",n.props=Jy,n),tw=R_((n,{slots:t})=>x_(AA,ew(n),t)),Yr=(n,t=[])=>{ht(n)?n.forEach(e=>e(...t)):n&&n(...t)},Xm=n=>n?ht(n)?n.some(t=>t.length>1):n.length>1:!1;function ew(n){const t={};for(const D in n)D in Qy||(t[D]=n[D]);if(n.css===!1)return t;const{name:e="v",type:s,duration:i,enterFromClass:r=`${e}-enter-from`,enterActiveClass:o=`${e}-enter-active`,enterToClass:a=`${e}-enter-to`,appearFromClass:c=r,appearActiveClass:h=o,appearToClass:u=a,leaveFromClass:d=`${e}-leave-from`,leaveActiveClass:f=`${e}-leave-active`,leaveToClass:p=`${e}-leave-to`}=n,m=P_(i),b=m&&m[0],A=m&&m[1],{onBeforeEnter:v,onEnter:_,onEnterCancelled:x,onLeave:S,onLeaveCancelled:C,onBeforeAppear:T=v,onAppear:R=_,onAppearCancelled:L=x}=t,P=(D,tt,nt,Nt)=>{D._enterCancelled=Nt,Yn(D,tt?u:a),Yn(D,tt?h:o),nt&&nt()},F=(D,tt)=>{D._isLeaving=!1,Yn(D,d),Yn(D,p),Yn(D,f),tt&&tt()},N=D=>(tt,nt)=>{const Nt=D?R:_,z=()=>P(tt,D,nt);Yr(Nt,[tt,z]),Ym(()=>{Yn(tt,D?c:r),Ii(tt,D?u:a),Xm(Nt)||Km(tt,s,b,z)})};return Ae(t,{onBeforeEnter(D){Yr(v,[D]),Ii(D,r),Ii(D,o)},onBeforeAppear(D){Yr(T,[D]),Ii(D,c),Ii(D,h)},onEnter:N(!1),onAppear:N(!0),onLeave(D,tt){D._isLeaving=!0;const nt=()=>F(D,tt);Ii(D,d),D._enterCancelled?(Ii(D,f),hp()):(hp(),Ii(D,f)),Ym(()=>{D._isLeaving&&(Yn(D,d),Ii(D,p),Xm(S)||Km(D,s,A,nt))}),Yr(S,[D,nt])},onEnterCancelled(D){P(D,!1,void 0,!0),Yr(x,[D])},onAppearCancelled(D){P(D,!0,void 0,!0),Yr(L,[D])},onLeaveCancelled(D){F(D),Yr(C,[D])}})}function P_(n){if(n==null)return null;if(Yt(n))return[Bf(n.enter),Bf(n.leave)];{const t=Bf(n);return[t,t]}}function Bf(n){return L0(n)}function Ii(n,t){t.split(/\s+/).forEach(e=>e&&n.classList.add(e)),(n[Kl]||(n[Kl]=new Set)).add(t)}function Yn(n,t){t.split(/\s+/).forEach(s=>s&&n.classList.remove(s));const e=n[Kl];e&&(e.delete(t),e.size||(n[Kl]=void 0))}function Ym(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let M_=0;function Km(n,t,e,s){const i=n._endId=++M_,r=()=>{i===n._endId&&s()};if(e!=null)return setTimeout(r,e);const{type:o,timeout:a,propCount:c}=sw(n,t);if(!o)return s();const h=o+"end";let u=0;const d=()=>{n.removeEventListener(h,f),r()},f=p=>{p.target===n&&++u>=c&&d()};setTimeout(()=>{u<c&&d()},a+1),n.addEventListener(h,f)}function sw(n,t){const e=window.getComputedStyle(n),s=m=>(e[m]||"").split(", "),i=s(`${Xn}Delay`),r=s(`${Xn}Duration`),o=Zm(i,r),a=s(`${tc}Delay`),c=s(`${tc}Duration`),h=Zm(a,c);let u=null,d=0,f=0;t===Xn?o>0&&(u=Xn,d=o,f=r.length):t===tc?h>0&&(u=tc,d=h,f=c.length):(d=Math.max(o,h),u=d>0?o>h?Xn:tc:null,f=u?u===Xn?r.length:c.length:0);const p=u===Xn&&/\b(transform|all)(,|$)/.test(s(`${Xn}Property`).toString());return{type:u,timeout:d,propCount:f,hasTransform:p}}function Zm(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((e,s)=>Qm(e)+Qm(n[s])))}function Qm(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function hp(){return document.body.offsetHeight}function I_(n,t,e){const s=n[Kl];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const Rd=Symbol("_vod"),iw=Symbol("_vsh"),Yg={beforeMount(n,{value:t},{transition:e}){n[Rd]=n.style.display==="none"?"":n.style.display,e&&t?e.beforeEnter(n):ec(n,t)},mounted(n,{value:t},{transition:e}){e&&t&&e.enter(n)},updated(n,{value:t,oldValue:e},{transition:s}){!t!=!e&&(s?t?(s.beforeEnter(n),ec(n,!0),s.enter(n)):s.leave(n,()=>{ec(n,!1)}):ec(n,t))},beforeUnmount(n,{value:t}){ec(n,t)}};function ec(n,t){n.style.display=t?n[Rd]:"none",n[iw]=!t}const L_=Symbol(""),D_=/(^|;)\s*display\s*:/;function F_(n,t,e){const s=n.style,i=re(e);let r=!1;if(e&&!i){if(t)if(re(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&ju(s,a,"")}else for(const o in t)e[o]==null&&ju(s,o,"");for(const o in e)o==="display"&&(r=!0),ju(s,o,e[o])}else if(i){if(t!==e){const o=s[L_];o&&(e+=";"+o),s.cssText=e,r=D_.test(e)}}else t&&n.removeAttribute("style");Rd in n&&(n[Rd]=r?s.display:"",n[iw]&&(s.display="none"))}const Jm=/\s*!important$/;function ju(n,t,e){if(ht(e))e.forEach(s=>ju(n,t,s));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const s=N_(n,t);Jm.test(e)?n.setProperty(ya(s),e.replace(Jm,""),"important"):n[s]=e}}const tb=["Webkit","Moz","ms"],Hf={};function N_(n,t){const e=Hf[t];if(e)return e;let s=si(t);if(s!=="filter"&&s in n)return Hf[t]=s;s=uf(s);for(let i=0;i<tb.length;i++){const r=tb[i]+s;if(r in n)return Hf[t]=r}return t}const eb="http://www.w3.org/1999/xlink";function sb(n,t,e,s,i,r=B0(t)){s&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(eb,t.slice(6,t.length)):n.setAttributeNS(eb,t,e):e==null||r&&!Wb(e)?n.removeAttribute(t):n.setAttribute(t,r?"":Gn(e)?String(e):e)}function ib(n,t,e,s,i){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?Zy(e):e);return}const r=n.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?n.getAttribute("value")||"":n.value,c=e==null?n.type==="checkbox"?"on":"":String(e);(a!==c||!("_value"in n))&&(n.value=c),e==null&&n.removeAttribute(t),n._value=e;return}let o=!1;if(e===""||e==null){const a=typeof n[t];a==="boolean"?e=Wb(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{n[t]=e}catch{}o&&n.removeAttribute(i||t)}function xa(n,t,e,s){n.addEventListener(t,e,s)}function O_(n,t,e,s){n.removeEventListener(t,e,s)}const nb=Symbol("_vei");function $_(n,t,e,s,i=null){const r=n[nb]||(n[nb]={}),o=r[t];if(s&&o)o.value=s;else{const[a,c]=B_(t);if(s){const h=r[t]=U_(s,i);xa(n,a,h,c)}else o&&(O_(n,a,o,c),r[t]=void 0)}}const rb=/(?:Once|Passive|Capture)$/;function B_(n){let t;if(rb.test(n)){t={};let s;for(;s=n.match(rb);)n=n.slice(0,n.length-s[0].length),t[s[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ya(n.slice(2)),t]}let zf=0;const H_=Promise.resolve(),z_=()=>zf||(H_.then(()=>zf=0),zf=Date.now());function U_(n,t){const e=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=e.attached)return;_i(V_(s,e.value),t,5,[s])};return e.value=n,e.attached=z_(),e}function V_(n,t){if(ht(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(s=>i=>!i._stopped&&s&&s(i))}else return t}const ob=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,j_=(n,t,e,s,i,r)=>{const o=i==="svg";t==="class"?I_(n,s,o):t==="style"?F_(n,e,s):lf(t)?Mg(t)||$_(n,t,e,s,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):G_(n,t,s,o))?(ib(n,t,s),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&sb(n,t,s,o,r,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!re(s))?ib(n,si(t),s,r,t):(t==="true-value"?n._trueValue=s:t==="false-value"&&(n._falseValue=s),sb(n,t,s,o))};function G_(n,t,e,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in n&&ob(t)&&pt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return ob(t)&&re(e)?!1:t in n}const nw=new WeakMap,rw=new WeakMap,Pd=Symbol("_moveCb"),ab=Symbol("_enterCb"),W_=n=>(delete n.props.mode,n),q_=W_({name:"TransitionGroup",props:Ae({},Jy,{tag:String,moveClass:String}),setup(n,{slots:t}){const e=Xy(),s=vy();let i,r;return Ty(()=>{if(!i.length)return;const o=n.moveClass||`${n.name||"v"}-move`;if(!Q_(i[0].el,e.vnode.el,o))return;i.forEach(Y_),i.forEach(K_);const a=i.filter(Z_);hp(),a.forEach(c=>{const h=c.el,u=h.style;Ii(h,o),u.transform=u.webkitTransform=u.transitionDuration="";const d=h[Pd]=f=>{f&&f.target!==h||(!f||/transform$/.test(f.propertyName))&&(h.removeEventListener("transitionend",d),h[Pd]=null,Yn(h,o))};h.addEventListener("transitionend",d)})}),()=>{const o=Tt(n),a=ew(o);let c=o.tag||Xt;if(i=[],r)for(let h=0;h<r.length;h++){const u=r[h];u.el&&u.el instanceof Element&&(i.push(u),fa(u,zc(u,a,s,e)),nw.set(u,u.el.getBoundingClientRect()))}r=t.default?jg(t.default()):[];for(let h=0;h<r.length;h++){const u=r[h];u.key!=null&&fa(u,zc(u,a,s,e))}return At(c,null,r)}}}),X_=q_;function Y_(n){const t=n.el;t[Pd]&&t[Pd](),t[ab]&&t[ab]()}function K_(n){rw.set(n,n.el.getBoundingClientRect())}function Z_(n){const t=nw.get(n),e=rw.get(n),s=t.left-e.left,i=t.top-e.top;if(s||i){const r=n.el.style;return r.transform=r.webkitTransform=`translate(${s}px,${i}px)`,r.transitionDuration="0s",n}}function Q_(n,t,e){const s=n.cloneNode(),i=n[Kl];i&&i.forEach(a=>{a.split(/\s+/).forEach(c=>c&&s.classList.remove(c))}),e.split(/\s+/).forEach(a=>a&&s.classList.add(a)),s.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(s);const{hasTransform:o}=sw(s);return r.removeChild(s),o}const lb=n=>{const t=n.props["onUpdate:modelValue"]||!1;return ht(t)?e=>Hu(t,e):t};function J_(n){n.target.composing=!0}function cb(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Uf=Symbol("_assign"),tS={created(n,{modifiers:{lazy:t,trim:e,number:s}},i){n[Uf]=lb(i);const r=s||i.props&&i.props.type==="number";xa(n,t?"change":"input",o=>{if(o.target.composing)return;let a=n.value;e&&(a=a.trim()),r&&(a=Zf(a)),n[Uf](a)}),e&&xa(n,"change",()=>{n.value=n.value.trim()}),t||(xa(n,"compositionstart",J_),xa(n,"compositionend",cb),xa(n,"change",cb))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:s,trim:i,number:r}},o){if(n[Uf]=lb(o),n.composing)return;const a=(r||n.type==="number")&&!/^0\d/.test(n.value)?Zf(n.value):n.value,c=t??"";a!==c&&(document.activeElement===n&&n.type!=="range"&&(s&&t===e||i&&n.value.trim()===c)||(n.value=c))}},eS=["ctrl","shift","alt","meta"],sS={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>eS.some(e=>n[`${e}Key`]&&!t.includes(e))},iS=(n,t)=>{const e=n._withMods||(n._withMods={}),s=t.join(".");return e[s]||(e[s]=(i,...r)=>{for(let o=0;o<t.length;o++){const a=sS[t[o]];if(a&&a(i,t))return}return n(i,...r)})},nS=Ae({patchProp:j_},k_);let hb;function rS(){return hb||(hb=KA(nS))}const oS=(...n)=>{const t=rS().createApp(...n),{mount:e}=t;return t.mount=s=>{const i=lS(s);if(!i)return;const r=t._component;!pt(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=e(i,!1,aS(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},t};function aS(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function lS(n){return re(n)?document.querySelector(n):n}const cS=""+new URL("../vue.svg",import.meta.url).href;function hS(n){const t=async()=>{await Promise.resolve(n("before-open")!==!1)&&(n("update:modelValue",!0),n("opened"))},e=async r=>{await Promise.resolve(n("before-close",r)!==!1)&&(n("update:modelValue",!1),n("closed",r))};return{handleOpen:t,handleClose:e,toggleMenu:async r=>{r?await e("menu"):await t()},handleItemClick:async r=>{var a;await Promise.resolve(n("before-select",r)!==!1)&&(n("select",r),n("selected",r),(a=r.onClick)==null||a.call(r),window.innerWidth<=768&&await e("menu"))}}}const uS=["href","onClick"],dS=gs({__name:"NavMenu",props:{items:{},position:{},active:{type:Boolean},modelValue:{}},emits:["select"],setup(n,{emit:t}){const e=t,s=i=>{i.onClick&&i.onClick(),e("select",i)};return(i,r)=>(q(),et("nav",{class:pe(["w-nav-menu",{"w-nav-menu-left":i.position==="left","w-nav-menu-right":i.position==="right","w-nav-menu-center":i.position==="center","w-nav-menu-active":i.active}])},[(q(!0),et(Xt,null,Hn(i.items,o=>(q(),et("div",{class:"w-nav-menu-content",key:o.key},[M("a",{class:pe(["w-nav-item",{"w-nav-link-active":o.key===i.modelValue}]),href:o.link,onClick:a=>s(o)},yt(o.label),11,uS)]))),128))],2))}}),$s=(n,t)=>{const e=n.__vccOpts||n;for(const[s,i]of t)e[s]=i;return e},Vf=$s(dS,[["__scopeId","data-v-53a54077"]]),fS={class:"w-topbar-content"},pS={class:"w-topbar-left"},gS={class:"w-logo"},mS=["src","alt"],bS={key:1,class:"w-title"},yS={class:"w-topbar-center"},wS={class:"w-topbar-right"},vS=gs({__name:"Topbar",props:{modelValue:{type:Boolean},logo:{},title:{},fixed:{type:Boolean},shadow:{type:Boolean},navPosition:{},items:{}},emits:["update:modelValue","close","select","before-open","before-close","opened","closed","before-select","selected"],setup(n,{emit:t}){const e=n,s=t,{handleClose:i,toggleMenu:r,handleItemClick:o}=hS(s),a=ti(()=>e.navPosition??"center");return Wr(()=>{const c=h=>{h.key==="Escape"&&e.modelValue&&i("escape")};document.addEventListener("keydown",c),bf(()=>{document.removeEventListener("keydown",c)})}),(c,h)=>(q(),et(Xt,null,[M("div",{class:pe(["w-topbar",{"w-topbar-fixed":c.fixed}]),style:Ai({"--w-topbar-shadow":c.shadow?"var(--w-shadow)":"none"})},[M("div",fS,[M("div",pS,[M("div",gS,[c.logo?(q(),et("img",{key:0,src:c.logo,alt:c.title},null,8,mS)):de("",!0),c.title?(q(),et("span",bS,yt(c.title),1)):de("",!0)]),a.value==="left"&&c.items?(q(),vi(Vf,{key:0,items:c.items,position:"left",active:c.modelValue,onSelect:ie(o)},null,8,["items","active","onSelect"])):de("",!0),ua(c.$slots,"left",{},void 0)]),M("div",yS,[ua(c.$slots,"center",{},void 0),a.value==="center"&&c.items?(q(),vi(Vf,{key:0,items:c.items,position:"center",active:c.modelValue,onSelect:ie(o)},null,8,["items","active","onSelect"])):de("",!0)]),M("div",wS,[ua(c.$slots,"right",{},void 0),a.value==="right"&&c.items?(q(),vi(Vf,{key:0,items:c.items,position:"right",active:c.modelValue,onSelect:ie(o)},null,8,["items","active","onSelect"])):de("",!0),M("div",{class:pe(["w-menu-toggle",{"is-active":c.modelValue}]),onClick:h[0]||(h[0]=()=>ie(r)(c.modelValue))},h[2]||(h[2]=[M("span",null,null,-1),M("span",null,null,-1),M("span",null,null,-1)]),2)])])],6),M("div",{class:pe(["w-nav-overlay",{"w-nav-overlay-active":c.modelValue}]),onClick:h[1]||(h[1]=()=>ie(i)("overlay"))},null,2)],64))}}),AS=$s(vS,[["__scopeId","data-v-93816676"]]),_S=gs({__name:"ThemeTransition",emits:["transitionComplete"],setup(n,{expose:t,emit:e}){const s=ft(!1),i=ft(""),r=ft(!1),o=e,a=h=>{h.propertyName==="transform"&&(s.value=!1,i.value="",r.value=!1,o("transitionComplete"))};return t({trigger:h=>r.value?!1:(r.value=!0,i.value=h,new Promise(u=>{requestAnimationFrame(()=>{s.value=!0,u(!0)})})),isAnimating:r}),(h,u)=>(q(),vi(Vg,{defer:"",to:"body"},[M("div",{class:pe(["theme-transition",{"theme-transition--active":s.value}]),style:Ai({"--next-theme-color":i.value}),onTransitionend:a},null,38)]))}}),SS=$s(_S,[["__scopeId","data-v-e8e21b37"]]),xS={class:"theme-switch-container"},ES=gs({__name:"ThemeSwitch",props:{theme:{default:"light"}},emits:["toggleThemeEvent"],setup(n,{emit:t}){const e=t,s=()=>{e("toggleThemeEvent")};return(i,r)=>(q(),et("button",{class:"theme-switch",onClick:s},[M("div",xS,[At(X_,{name:"theme-transition"},{default:Ys(()=>[(q(),et("span",{class:"theme-switch-icon",key:"icon-"+i.theme},yt(i.theme==="light"?"":""),1)),(q(),et("span",{class:"theme-switch-text",key:"text-"+i.theme},yt(i.theme==="light"?"":""),1))]),_:1})])]))}}),CS=$s(ES,[["__scopeId","data-v-94eda777"]]),TS=gs({__name:"FpsMonitor",props:{position:{default:"bottomRight"},show:{type:Boolean,default:!0},marginTop:{default:0},marginBottom:{default:10},marginLeft:{default:0},marginRight:{default:20},interval:{default:1e3}},setup(n){const t=n,e=ti(()=>{const d={};switch(t.position){case"topLeft":d.top=typeof t.marginTop=="number"?`${t.marginTop}px`:t.marginTop,d.left=typeof t.marginLeft=="number"?`${t.marginLeft}px`:t.marginLeft;break;case"topRight":d.top=typeof t.marginTop=="number"?`${t.marginTop}px`:t.marginTop,d.right=typeof t.marginRight=="number"?`${t.marginRight}px`:t.marginRight;break;case"bottomLeft":d.bottom=typeof t.marginBottom=="number"?`${t.marginBottom}px`:t.marginBottom,d.left=typeof t.marginLeft=="number"?`${t.marginLeft}px`:t.marginLeft;break;case"bottomRight":d.bottom=typeof t.marginBottom=="number"?`${t.marginBottom}px`:t.marginBottom,d.right=typeof t.marginRight=="number"?`${t.marginRight}px`:t.marginRight;break}return d}),s=ft(0);let i=0,r=Date.now(),o=null;const a=window.requestAnimationFrame||(d=>window.setTimeout(d,1e3/60)),c=()=>{if(!t.show)return;const d=Date.now();i++,d>t.interval+r&&(s.value=Math.round(i*1e3/(d-r)),i=0,r=d),o=a(c)},h=()=>{o||(i=0,r=Date.now(),c())},u=()=>{o&&(cancelAnimationFrame(o),o=null,s.value=0)};return za(()=>t.show,d=>{d?h():u()},{immediate:!0}),Wr(()=>{t.show&&h()}),bf(()=>{u()}),(d,f)=>(q(),vi(Vg,{defer:"",to:"body"},[Ed(M("div",{class:"fps-monitor",style:Ai(e.value)}," FPS: "+yt(t.show?s.value:0),5),[[Yg,t.show]])]))}}),kS=$s(TS,[["__scopeId","data-v-88a4fec8"]]),RS=gs({__name:"RoundCard",props:{radius:{}},setup(n){return(t,e)=>(q(),et("div",{class:"w-round-card",style:Ai({...t.radius!==void 0&&{"border-radius":typeof t.radius=="number"?`${t.radius}px`:t.radius}})},[ua(t.$slots,"default",{},void 0)],4))}}),ub=$s(RS,[["__scopeId","data-v-e6fd1345"]]),PS={key:0,class:"w-dialog-header"},MS={key:1,class:"w-dialog-footer"},IS=gs({__name:"Dialog",props:{modelValue:{type:Boolean,default:!1},title:{default:""},width:{default:500},closable:{type:Boolean,default:!0},closeOnClickMask:{type:Boolean,default:!0},center:{type:Boolean,default:!1},showFooter:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},confirmText:{default:""},cancelText:{default:""},customClass:{default:""}},emits:["update:modelValue","confirm","cancel","close"],setup(n,{emit:t}){const e=n,s=t,i=ti(()=>{const h={};return typeof e.width=="number"?h.width=`${e.width}px`:h.width=e.width,h}),r=()=>{s("update:modelValue",!1),s("close")},o=()=>{e.closeOnClickMask&&r()},a=()=>{s("confirm"),r()},c=()=>{s("cancel"),r()};return(h,u)=>(q(),vi(Vg,{to:"body"},[At(tw,{name:"w-dialog-fade"},{default:Ys(()=>[h.modelValue?(q(),et("div",{key:0,class:"w-dialog-mask",onClick:o},[M("div",{class:pe(["w-dialog",e.customClass]),style:Ai(i.value),onClick:u[0]||(u[0]=iS(()=>{},["stop"]))},[h.title||h.$slots.header?(q(),et("div",PS,[ua(h.$slots,"header",{},()=>[M("h3",{class:pe(["w-dialog-title",{"w-dialog-title--center":h.center}])},yt(h.title),3)],!0),h.closable?(q(),et("button",{key:0,class:"w-dialog-close",onClick:r},u[1]||(u[1]=[M("span",{class:"w-dialog-close-icon"},"",-1)]))):de("",!0)])):de("",!0),M("div",{class:pe(["w-dialog-body",{"w-dialog-body--center":h.center}])},[ua(h.$slots,"default",{},void 0,!0)],2),h.$slots.footer||h.showFooter?(q(),et("div",MS,[ua(h.$slots,"footer",{},()=>[h.showCancel?(q(),et("button",{key:0,class:"w-dialog-button w-dialog-cancel",onClick:c},yt(h.cancelText),1)):de("",!0),M("button",{class:"w-dialog-button w-dialog-confirm",onClick:a},yt(h.confirmText),1)],!0)])):de("",!0)],6)])):de("",!0)]),_:3})]))}}),sc=$s(IS,[["__scopeId","data-v-c736e737"]]),LS=(n,t)=>{let e=null;return(...s)=>{e&&clearTimeout(e),e=window.setTimeout(()=>{n(...s),e=null},t)}},DS={class:"tree-node_icon"},FS={key:0,class:"tree-node_folder-icon"},NS={key:1,class:"tree-node_file-icon"},OS={class:"tree-node_label"},$S={key:0,class:"tree-node_children"},BS=gs({__name:"TreeNode",props:{node:{}},emits:["select","toggle"],setup(n,{emit:t}){const e=n,s=t,i=ti(()=>e.node.type==="directory"),r=()=>{i.value?s("toggle",{...e.node,expanded:!e.node.expanded}):s("select",e.node)},o=c=>s("select",c),a=c=>s("toggle",c);return(c,h)=>{const u=IA("TreeNode",!0);return q(),et("div",{class:pe(["tree-node",{"tree-node--expanded":c.node.expanded}])},[M("div",{class:"tree-node_content",onClick:r},[M("span",DS,[i.value?(q(),et("i",FS)):(q(),et("i",NS))]),M("span",OS,yt(c.node.name),1)]),i.value&&c.node.expanded?(q(),et("div",$S,[(q(!0),et(Xt,null,Hn(c.node.children,d=>(q(),vi(u,{key:d.key,node:d,onSelect:o,onToggle:a},null,8,["node"]))),128))])):de("",!0)],2)}}}),HS=$s(BS,[["__scopeId","data-v-a128c922"]]),zS={class:"file-tree"},US={key:0,class:"file-tree_search"},VS={class:"file-tree_search-wrapper"},jS={class:"file-tree_actions"},GS=["disabled"],WS={class:"file-tree_content custom-scrollbar"},qS={key:0,class:"file-tree_skeleton"},XS={key:1,class:"file-tree_error"},YS={class:"file-tree_error-message"},KS={key:2,class:"file-tree_empty"},ZS=gs({__name:"FileTree",props:{data:{},searchable:{type:Boolean,default:!0},defaultExpanded:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},errorMessage:{default:""}},emits:["select","toggle","refresh"],setup(n,{emit:t}){const e=n,s=t,i=ft(""),r=ti(()=>i.value?o(e.data,i.value.toLowerCase()):e.data);function o(d,f){return d.filter(p=>{const m=p.name.toLowerCase().includes(f);return p.children&&o(p.children,f).length?!0:m}).map(p=>({...p,children:p.children?o(p.children,f):void 0,expanded:f?!0:p.expanded}))}const a=d=>{s("select",d)},c=d=>{s("toggle",d)},h=()=>{i.value=""},u=()=>{s("refresh")};return(d,f)=>(q(),et("div",zS,[e.searchable?(q(),et("div",US,[M("div",VS,[f[1]||(f[1]=M("i",{class:"file-tree_search-icon"},null,-1)),Ed(M("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=p=>i.value=p),placeholder:"...",class:"file-tree_search-input"},null,512),[[tS,i.value]]),Ed(M("i",{class:"file-tree_search-clear",onClick:h},null,512),[[Yg,i.value]])]),M("div",jS,[M("button",{class:pe(["file-tree_refresh-btn",{"file-tree_refresh-btn--loading":e.loading}]),onClick:u,disabled:e.loading},f[2]||(f[2]=[M("i",{class:"file-tree_refresh-icon"},null,-1)]),10,GS)])])):de("",!0),M("div",WS,[e.loading?(q(),et("div",qS,[(q(),et(Xt,null,Hn(5,p=>M("div",{key:p,class:"file-tree_skeleton-item",style:Ai({animationDelay:`${(p-1)*.1}s`})},f[3]||(f[3]=[M("div",{class:"file-tree_skeleton-icon"},null,-1),M("div",{class:"file-tree_skeleton-line"},null,-1)]),4)),64)),(q(),et(Xt,null,Hn(3,p=>M("div",{key:p+5,class:"file-tree_skeleton-item file-tree_skeleton-item--indented",style:Ai({animationDelay:`${(p+4)*.1}s`})},f[4]||(f[4]=[M("div",{class:"file-tree_skeleton-icon"},null,-1),M("div",{class:"file-tree_skeleton-line"},null,-1)]),4)),64))])):e.errorMessage?(q(),et("div",XS,[f[5]||(f[5]=M("div",{class:"file-tree_error-icon"},"!",-1)),M("div",YS,yt(e.errorMessage),1),M("button",{class:"file-tree_error-retry",onClick:u},"  ")])):r.value.length?(q(!0),et(Xt,{key:3},Hn(r.value,p=>(q(),vi(HS,{key:p.key,node:p,onSelect:a,onToggle:c},null,8,["node"]))),128)):(q(),et("div",KS,f[6]||(f[6]=[M("div",{class:"file-tree_empty-icon"},"",-1),M("div",{class:"file-tree_empty-message"},"",-1)])))])]))}}),QS=$s(ZS,[["__scopeId","data-v-9908eb21"]]);function Af(n){const t=n.includes("?")?"&":"?";return`${n}${t}t=${Date.now()}`}const ow="https://xiaowine.github.io/chip-docs";async function JS(){try{const n=Af(`${ow}/.data/file-manifest.json`),t=await fetch(n);if(!t.ok)throw new Error("Failed to fetch file manifest");const e=await t.json();return Object.entries(e.files).map(([s,i])=>({md5:s,path:i}))}catch(n){return console.error("Error fetching file manifest:",n),[]}}function tx(n){const t={};n.forEach(s=>{let i=t;const r=s.path.split("/"),o=r.pop(),a=s.path;r.forEach((c,h)=>{const u=r.slice(0,h+1).join("/");i[c]||(i[c]={key:u,name:c,type:"directory",children:{}}),i=i[c].children}),i[o]={key:a,name:o,type:"file",path:`${ow}/${s.path}`,md5:s.md5}});function e(s){return Object.values(s).map(i=>({...i,children:i.children?e(i.children):void 0})).sort((i,r)=>i.type!==r.type?i.type==="directory"?-1:1:i.name.toLowerCase().localeCompare(r.name.toLowerCase()))}return e(t)}const aw="https://xiaowine.github.io/chip-docs";async function ex(n){try{const t=Af(`${aw}/.data/md5s/${n}.json`),e=await fetch(t);if(!e.ok)throw new Error(`: ${e.status}`);return await e.json()}catch(t){throw console.error(":",t),t}}async function sx(n,t,e,s){var r,o,a,c,h,u,d,f;const i=Af(`${aw}/${n}`);try{if(e!=null&&e.aborted){t==null||t(0),(r=s==null?void 0:s.onCancel)==null||r.call(s);return}t==null||t(0);const p=await fetch(i,{signal:e});if(!p.ok){const C=new Error(`: ${p.status}`);(o=s==null?void 0:s.onError)==null||o.call(s,C);return}const m=Number(p.headers.get("content-length"))||0,b=(a=p.body)==null?void 0:a.getReader(),A=[];let v=0;if(b)for(;;){if(e!=null&&e.aborted){b.cancel(),t==null||t(0),(c=s==null?void 0:s.onCancel)==null||c.call(s);return}const{done:C,value:T}=await b.read();if(C)break;if(A.push(T),v+=T.length,t&&m){const R=v/m*100;t(Math.min(Math.round(R),99))}}if(e!=null&&e.aborted){t==null||t(0),(h=s==null?void 0:s.onCancel)==null||h.call(s);return}t==null||t(100);const _=new Blob(A),x=window.URL.createObjectURL(_),S=document.createElement("a");S.href=x,S.download=n.split("/").pop()||"",document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(x),(u=s==null?void 0:s.onSuccess)==null||u.call(s)}catch(p){p instanceof DOMException&&p.name==="AbortError"?(console.log(""),t==null||t(0),(d=s==null?void 0:s.onCancel)==null||d.call(s)):(console.error(":",p),(f=s==null?void 0:s.onError)==null||f.call(s,p instanceof Error?p:new Error(String(p))))}}function ix(n){return n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(2)} KB`:n<1024*1024*1024?`${(n/(1024*1024)).toFixed(2)} MB`:`${(n/(1024*1024*1024)).toFixed(2)} GB`}function nx(n){return new Date(n).toLocaleString("zh-CN")}function Kg(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let wa=Kg();function lw(n){wa=n}const Fc={exec:()=>null};function It(n,t=""){let e=typeof n=="string"?n:n.source;const s={replace:(i,r)=>{let o=typeof r=="string"?r:r.source;return o=o.replace(os.caret,"$1"),e=e.replace(i,o),s},getRegex:()=>new RegExp(e,t)};return s}const os={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},rx=/^(?:[ \t]*(?:\n|$))+/,ox=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,ax=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,yu=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,lx=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Zg=/(?:[*+-]|\d{1,9}[.)])/,cw=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,hw=It(cw).replace(/bull/g,Zg).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),cx=It(cw).replace(/bull/g,Zg).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Qg=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,hx=/^[^\n]+/,Jg=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ux=It(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Jg).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),dx=It(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Zg).getRegex(),_f="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",tm=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,fx=It("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",tm).replace("tag",_f).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),uw=It(Qg).replace("hr",yu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_f).getRegex(),px=It(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",uw).getRegex(),em={blockquote:px,code:ox,def:ux,fences:ax,heading:lx,hr:yu,html:fx,lheading:hw,list:dx,newline:rx,paragraph:uw,table:Fc,text:hx},db=It("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",yu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_f).getRegex(),gx={...em,lheading:cx,table:db,paragraph:It(Qg).replace("hr",yu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",db).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_f).getRegex()},mx={...em,html:It(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",tm).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Fc,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:It(Qg).replace("hr",yu).replace("heading",` *#{1,6} *[^
]`).replace("lheading",hw).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},bx=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yx=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,dw=/^( {2,}|\\)\n(?!\s*$)/,wx=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Sf=/[\p{P}\p{S}]/u,sm=/[\s\p{P}\p{S}]/u,fw=/[^\s\p{P}\p{S}]/u,vx=It(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,sm).getRegex(),pw=/(?!~)[\p{P}\p{S}]/u,Ax=/(?!~)[\s\p{P}\p{S}]/u,_x=/(?:[^\s\p{P}\p{S}]|~)/u,Sx=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,gw=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,xx=It(gw,"u").replace(/punct/g,Sf).getRegex(),Ex=It(gw,"u").replace(/punct/g,pw).getRegex(),mw="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Cx=It(mw,"gu").replace(/notPunctSpace/g,fw).replace(/punctSpace/g,sm).replace(/punct/g,Sf).getRegex(),Tx=It(mw,"gu").replace(/notPunctSpace/g,_x).replace(/punctSpace/g,Ax).replace(/punct/g,pw).getRegex(),kx=It("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,fw).replace(/punctSpace/g,sm).replace(/punct/g,Sf).getRegex(),Rx=It(/\\(punct)/,"gu").replace(/punct/g,Sf).getRegex(),Px=It(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Mx=It(tm).replace("(?:-->|$)","-->").getRegex(),Ix=It("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Mx).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Md=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Lx=It(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Md).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),bw=It(/^!?\[(label)\]\[(ref)\]/).replace("label",Md).replace("ref",Jg).getRegex(),yw=It(/^!?\[(ref)\](?:\[\])?/).replace("ref",Jg).getRegex(),Dx=It("reflink|nolink(?!\\()","g").replace("reflink",bw).replace("nolink",yw).getRegex(),im={_backpedal:Fc,anyPunctuation:Rx,autolink:Px,blockSkip:Sx,br:dw,code:yx,del:Fc,emStrongLDelim:xx,emStrongRDelimAst:Cx,emStrongRDelimUnd:kx,escape:bx,link:Lx,nolink:yw,punctuation:vx,reflink:bw,reflinkSearch:Dx,tag:Ix,text:wx,url:Fc},Fx={...im,link:It(/^!?\[(label)\]\((.*?)\)/).replace("label",Md).getRegex(),reflink:It(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Md).getRegex()},up={...im,emStrongRDelimAst:Tx,emStrongLDelim:Ex,url:It(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Nx={...up,br:It(dw).replace("{2,}","*").getRegex(),text:It(up.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Lu={normal:em,gfm:gx,pedantic:mx},ic={normal:im,gfm:up,breaks:Nx,pedantic:Fx},Ox={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},fb=n=>Ox[n];function Li(n,t){if(t){if(os.escapeTest.test(n))return n.replace(os.escapeReplace,fb)}else if(os.escapeTestNoEncode.test(n))return n.replace(os.escapeReplaceNoEncode,fb);return n}function pb(n){try{n=encodeURI(n).replace(os.percentDecode,"%")}catch{return null}return n}function gb(n,t){var r;const e=n.replace(os.findPipe,(o,a,c)=>{let h=!1,u=a;for(;--u>=0&&c[u]==="\\";)h=!h;return h?"|":" |"}),s=e.split(os.splitPipe);let i=0;if(s[0].trim()||s.shift(),s.length>0&&!((r=s.at(-1))!=null&&r.trim())&&s.pop(),t)if(s.length>t)s.splice(t);else for(;s.length<t;)s.push("");for(;i<s.length;i++)s[i]=s[i].trim().replace(os.slashPipe,"|");return s}function nc(n,t,e){const s=n.length;if(s===0)return"";let i=0;for(;i<s&&n.charAt(s-i-1)===t;)i++;return n.slice(0,s-i)}function $x(n,t){if(n.indexOf(t[1])===-1)return-1;let e=0;for(let s=0;s<n.length;s++)if(n[s]==="\\")s++;else if(n[s]===t[0])e++;else if(n[s]===t[1]&&(e--,e<0))return s;return-1}function mb(n,t,e,s,i){const r=t.href,o=t.title||null,a=n[1].replace(i.other.outputLinkReplace,"$1");if(n[0].charAt(0)!=="!"){s.state.inLink=!0;const c={type:"link",raw:e,href:r,title:o,text:a,tokens:s.inlineTokens(a)};return s.state.inLink=!1,c}return{type:"image",raw:e,href:r,title:o,text:a}}function Bx(n,t,e){const s=n.match(e.other.indentCodeCompensation);if(s===null)return t;const i=s[1];return t.split(`
`).map(r=>{const o=r.match(e.other.beginningSpace);if(o===null)return r;const[a]=o;return a.length>=i.length?r.slice(i.length):r}).join(`
`)}class Id{constructor(t){U(this,"options");U(this,"rules");U(this,"lexer");this.options=t||wa}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const s=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?s:nc(s,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const s=e[0],i=Bx(s,e[3]||"",this.rules);return{type:"code",raw:s,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let s=e[2].trim();if(this.rules.other.endingHash.test(s)){const i=nc(s,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(s=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:nc(e[0],`
`)}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){let s=nc(e[0],`
`).split(`
`),i="",r="";const o=[];for(;s.length>0;){let a=!1;const c=[];let h;for(h=0;h<s.length;h++)if(this.rules.other.blockquoteStart.test(s[h]))c.push(s[h]),a=!0;else if(!a)c.push(s[h]);else break;s=s.slice(h);const u=c.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,r=r?`${r}
${d}`:d;const f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=f,s.length===0)break;const p=o.at(-1);if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const m=p,b=m.raw+`
`+s.join(`
`),A=this.blockquote(b);o[o.length-1]=A,i=i.substring(0,i.length-m.raw.length)+A.raw,r=r.substring(0,r.length-m.text.length)+A.text;break}else if((p==null?void 0:p.type)==="list"){const m=p,b=m.raw+`
`+s.join(`
`),A=this.list(b);o[o.length-1]=A,i=i.substring(0,i.length-p.raw.length)+A.raw,r=r.substring(0,r.length-m.raw.length)+A.raw,s=b.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:o,text:r}}}list(t){let e=this.rules.block.list.exec(t);if(e){let s=e[1].trim();const i=s.length>1,r={type:"list",raw:"",ordered:i,start:i?+s.slice(0,-1):"",loose:!1,items:[]};s=i?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=i?s:"[*+-]");const o=this.rules.other.listItemRegex(s);let a=!1;for(;t;){let h=!1,u="",d="";if(!(e=o.exec(t))||this.rules.block.hr.test(t))break;u=e[0],t=t.substring(u.length);let f=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,_=>" ".repeat(3*_.length)),p=t.split(`
`,1)[0],m=!f.trim(),b=0;if(this.options.pedantic?(b=2,d=f.trimStart()):m?b=e[1].length+1:(b=e[2].search(this.rules.other.nonSpaceChar),b=b>4?1:b,d=f.slice(b),b+=e[1].length),m&&this.rules.other.blankLine.test(p)&&(u+=p+`
`,t=t.substring(p.length+1),h=!0),!h){const _=this.rules.other.nextBulletRegex(b),x=this.rules.other.hrRegex(b),S=this.rules.other.fencesBeginRegex(b),C=this.rules.other.headingBeginRegex(b),T=this.rules.other.htmlBeginRegex(b);for(;t;){const R=t.split(`
`,1)[0];let L;if(p=R,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),L=p):L=p.replace(this.rules.other.tabCharGlobal,"    "),S.test(p)||C.test(p)||T.test(p)||_.test(p)||x.test(p))break;if(L.search(this.rules.other.nonSpaceChar)>=b||!p.trim())d+=`
`+L.slice(b);else{if(m||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(f)||C.test(f)||x.test(f))break;d+=`
`+p}!m&&!p.trim()&&(m=!0),u+=R+`
`,t=t.substring(R.length+1),f=L.slice(b)}}r.loose||(a?r.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(a=!0));let A=null,v;this.options.gfm&&(A=this.rules.other.listIsTask.exec(d),A&&(v=A[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:u,task:!!A,checked:v,loose:!1,text:d,tokens:[]}),r.raw+=u}const c=r.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let h=0;h<r.items.length;h++)if(this.lexer.state.top=!1,r.items[h].tokens=this.lexer.blockTokens(r.items[h].text,[]),!r.loose){const u=r.items[h].tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));r.loose=d}if(r.loose)for(let h=0;h<r.items.length;h++)r.items[h].loose=!0;return r}}html(t){const e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){const e=this.rules.block.def.exec(t);if(e){const s=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:s,raw:e[0],href:i,title:r}}}table(t){var a;const e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const s=gb(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(s.length===i.length){for(const c of i)this.rules.other.tableAlignRight.test(c)?o.align.push("right"):this.rules.other.tableAlignCenter.test(c)?o.align.push("center"):this.rules.other.tableAlignLeft.test(c)?o.align.push("left"):o.align.push(null);for(let c=0;c<s.length;c++)o.header.push({text:s[c],tokens:this.lexer.inline(s[c]),header:!0,align:o.align[c]});for(const c of r)o.rows.push(gb(c,o.header.length).map((h,u)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:o.align[u]})));return o}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const s=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:s,tokens:this.lexer.inline(s)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const s=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(s)){if(!this.rules.other.endAngleBracket.test(s))return;const o=nc(s.slice(0,-1),"\\");if((s.length-o.length)%2===0)return}else{const o=$x(e[2],"()");if(o>-1){const c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let i=e[2],r="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(i);o&&(i=o[1],r=o[3])}else r=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(s)?i=i.slice(1):i=i.slice(1,-1)),mb(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let s;if((s=this.rules.inline.reflink.exec(t))||(s=this.rules.inline.nolink.exec(t))){const i=(s[2]||s[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[i.toLowerCase()];if(!r){const o=s[0].charAt(0);return{type:"text",raw:o,text:o}}return mb(s,r,s[0],this.lexer,this.rules)}}emStrong(t,e,s=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!i||i[3]&&s.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const o=[...i[0]].length-1;let a,c,h=o,u=0;const d=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+o);(i=d.exec(e))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(c=[...a].length,i[3]||i[4]){h+=c;continue}else if((i[5]||i[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(h-=c,h>0)continue;c=Math.min(c,c+h+u);const f=[...i[0]][0].length,p=t.slice(0,o+i.index+f+c);if(Math.min(o,c)%2){const b=p.slice(1,-1);return{type:"em",raw:p,text:b,tokens:this.lexer.inlineTokens(b)}}const m=p.slice(2,-2);return{type:"strong",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let s=e[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(s),r=this.rules.other.startingSpaceChar.test(s)&&this.rules.other.endingSpaceChar.test(s);return i&&r&&(s=s.substring(1,s.length-1)),{type:"codespan",raw:e[0],text:s}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){const e=this.rules.inline.autolink.exec(t);if(e){let s,i;return e[2]==="@"?(s=e[1],i="mailto:"+s):(s=e[1],i=s),{type:"link",raw:e[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}url(t){var s;let e;if(e=this.rules.inline.url.exec(t)){let i,r;if(e[2]==="@")i=e[0],r="mailto:"+i;else{let o;do o=e[0],e[0]=((s=this.rules.inline._backpedal.exec(e[0]))==null?void 0:s[0])??"";while(o!==e[0]);i=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t){const e=this.rules.inline.text.exec(t);if(e){const s=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:s}}}}class Zs{constructor(t){U(this,"tokens");U(this,"options");U(this,"state");U(this,"tokenizer");U(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||wa,this.options.tokenizer=this.options.tokenizer||new Id,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={other:os,block:Lu.normal,inline:ic.normal};this.options.pedantic?(e.block=Lu.pedantic,e.inline=ic.pedantic):this.options.gfm&&(e.block=Lu.gfm,this.options.breaks?e.inline=ic.breaks:e.inline=ic.gfm),this.tokenizer.rules=e}static get rules(){return{block:Lu,inline:ic}}static lex(t,e){return new Zs(e).lex(t)}static lexInline(t,e){return new Zs(e).inlineTokens(t)}lex(t){t=t.replace(os.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const s=this.inlineQueue[e];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,e=[],s=!1){var i,r,o;for(this.options.pedantic&&(t=t.replace(os.tabCharGlobal,"    ").replace(os.spaceLine,""));t;){let a;if((r=(i=this.options.extensions)==null?void 0:i.block)!=null&&r.some(h=>(a=h.call({lexer:this},t,e))?(t=t.substring(a.raw.length),e.push(a),!0):!1))continue;if(a=this.tokenizer.space(t)){t=t.substring(a.raw.length);const h=e.at(-1);a.raw.length===1&&h!==void 0?h.raw+=`
`:e.push(a);continue}if(a=this.tokenizer.code(t)){t=t.substring(a.raw.length);const h=e.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=`
`+a.raw,h.text+=`
`+a.text,this.inlineQueue.at(-1).src=h.text):e.push(a);continue}if(a=this.tokenizer.fences(t)){t=t.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.heading(t)){t=t.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.hr(t)){t=t.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.blockquote(t)){t=t.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.list(t)){t=t.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.html(t)){t=t.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.def(t)){t=t.substring(a.raw.length);const h=e.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=`
`+a.raw,h.text+=`
`+a.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(t)){t=t.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.lheading(t)){t=t.substring(a.raw.length),e.push(a);continue}let c=t;if((o=this.options.extensions)!=null&&o.startBlock){let h=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(h=Math.min(h,d))}),h<1/0&&h>=0&&(c=t.substring(0,h+1))}if(this.state.top&&(a=this.tokenizer.paragraph(c))){const h=e.at(-1);s&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=`
`+a.raw,h.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):e.push(a),s=c.length!==t.length,t=t.substring(a.raw.length);continue}if(a=this.tokenizer.text(t)){t=t.substring(a.raw.length);const h=e.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=`
`+a.raw,h.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):e.push(a);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){var a,c,h;let s=t,i=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,i.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let r=!1,o="";for(;t;){r||(o=""),r=!1;let u;if((c=(a=this.options.extensions)==null?void 0:a.inline)!=null&&c.some(f=>(u=f.call({lexer:this},t,e))?(t=t.substring(u.raw.length),e.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const f=e.at(-1);u.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):e.push(u);continue}if(u=this.tokenizer.emStrong(t,s,o)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),e.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),e.push(u);continue}let d=t;if((h=this.options.extensions)!=null&&h.startInline){let f=1/0;const p=t.slice(1);let m;this.options.extensions.startInline.forEach(b=>{m=b.call({lexer:this},p),typeof m=="number"&&m>=0&&(f=Math.min(f,m))}),f<1/0&&f>=0&&(d=t.substring(0,f+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(o=u.raw.slice(-1)),r=!0;const f=e.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):e.push(u);continue}if(t){const f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return e}}class Ld{constructor(t){U(this,"options");U(this,"parser");this.options=t||wa}space(t){return""}code({text:t,lang:e,escaped:s}){var o;const i=(o=(e||"").match(os.notSpaceStart))==null?void 0:o[0],r=t.replace(os.endingNewline,"")+`
`;return i?'<pre><code class="language-'+Li(i)+'">'+(s?r:Li(r,!0))+`</code></pre>
`:"<pre><code>"+(s?r:Li(r,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){const e=t.ordered,s=t.start;let i="";for(let a=0;a<t.items.length;a++){const c=t.items[a];i+=this.listitem(c)}const r=e?"ol":"ul",o=e&&s!==1?' start="'+s+'"':"";return"<"+r+o+`>
`+i+"</"+r+`>
`}listitem(t){var s;let e="";if(t.task){const i=this.checkbox({checked:!!t.checked});t.loose?((s=t.tokens[0])==null?void 0:s.type)==="paragraph"?(t.tokens[0].text=i+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=i+" "+Li(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):e+=i+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",s="";for(let r=0;r<t.header.length;r++)s+=this.tablecell(t.header[r]);e+=this.tablerow({text:s});let i="";for(let r=0;r<t.rows.length;r++){const o=t.rows[r];s="";for(let a=0;a<o.length;a++)s+=this.tablecell(o[a]);i+=this.tablerow({text:s})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const e=this.parser.parseInline(t.tokens),s=t.header?"th":"td";return(t.align?`<${s} align="${t.align}">`:`<${s}>`)+e+`</${s}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Li(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:s}){const i=this.parser.parseInline(s),r=pb(t);if(r===null)return i;t=r;let o='<a href="'+t+'"';return e&&(o+=' title="'+Li(e)+'"'),o+=">"+i+"</a>",o}image({href:t,title:e,text:s}){const i=pb(t);if(i===null)return Li(s);t=i;let r=`<img src="${t}" alt="${s}"`;return e&&(r+=` title="${Li(e)}"`),r+=">",r}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Li(t.text)}}class nm{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}}class Qs{constructor(t){U(this,"options");U(this,"renderer");U(this,"textRenderer");this.options=t||wa,this.options.renderer=this.options.renderer||new Ld,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new nm}static parse(t,e){return new Qs(e).parse(t)}static parseInline(t,e){return new Qs(e).parseInline(t)}parse(t,e=!0){var i,r;let s="";for(let o=0;o<t.length;o++){const a=t[o];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[a.type]){const h=a,u=this.options.extensions.renderers[h.type].call({parser:this},h);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type)){s+=u||"";continue}}const c=a;switch(c.type){case"space":{s+=this.renderer.space(c);continue}case"hr":{s+=this.renderer.hr(c);continue}case"heading":{s+=this.renderer.heading(c);continue}case"code":{s+=this.renderer.code(c);continue}case"table":{s+=this.renderer.table(c);continue}case"blockquote":{s+=this.renderer.blockquote(c);continue}case"list":{s+=this.renderer.list(c);continue}case"html":{s+=this.renderer.html(c);continue}case"paragraph":{s+=this.renderer.paragraph(c);continue}case"text":{let h=c,u=this.renderer.text(h);for(;o+1<t.length&&t[o+1].type==="text";)h=t[++o],u+=`
`+this.renderer.text(h);e?s+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):s+=u;continue}default:{const h='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return s}parseInline(t,e=this.renderer){var i,r;let s="";for(let o=0;o<t.length;o++){const a=t[o];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[a.type]){const h=this.options.extensions.renderers[a.type].call({parser:this},a);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){s+=h||"";continue}}const c=a;switch(c.type){case"escape":{s+=e.text(c);break}case"html":{s+=e.html(c);break}case"link":{s+=e.link(c);break}case"image":{s+=e.image(c);break}case"strong":{s+=e.strong(c);break}case"em":{s+=e.em(c);break}case"codespan":{s+=e.codespan(c);break}case"br":{s+=e.br(c);break}case"del":{s+=e.del(c);break}case"text":{s+=e.text(c);break}default:{const h='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return s}}class Nc{constructor(t){U(this,"options");U(this,"block");this.options=t||wa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?Zs.lex:Zs.lexInline}provideParser(){return this.block?Qs.parse:Qs.parseInline}}U(Nc,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class Hx{constructor(...t){U(this,"defaults",Kg());U(this,"options",this.setOptions);U(this,"parse",this.parseMarkdown(!0));U(this,"parseInline",this.parseMarkdown(!1));U(this,"Parser",Qs);U(this,"Renderer",Ld);U(this,"TextRenderer",nm);U(this,"Lexer",Zs);U(this,"Tokenizer",Id);U(this,"Hooks",Nc);this.use(...t)}walkTokens(t,e){var i,r;let s=[];for(const o of t)switch(s=s.concat(e.call(this,o)),o.type){case"table":{const a=o;for(const c of a.header)s=s.concat(this.walkTokens(c.tokens,e));for(const c of a.rows)for(const h of c)s=s.concat(this.walkTokens(h.tokens,e));break}case"list":{const a=o;s=s.concat(this.walkTokens(a.items,e));break}default:{const a=o;(r=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&r[a.type]?this.defaults.extensions.childTokens[a.type].forEach(c=>{const h=a[c].flat(1/0);s=s.concat(this.walkTokens(h,e))}):a.tokens&&(s=s.concat(this.walkTokens(a.tokens,e)))}}return s}use(...t){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(s=>{const i={...s};if(i.async=this.defaults.async||i.async||!1,s.extensions&&(s.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const o=e.renderers[r.name];o?e.renderers[r.name]=function(...a){let c=r.renderer.apply(this,a);return c===!1&&(c=o.apply(this,a)),c}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=e[r.level];o?o.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),i.extensions=e),s.renderer){const r=this.defaults.renderer||new Ld(this.defaults);for(const o in s.renderer){if(!(o in r))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const a=o,c=s.renderer[a],h=r[a];r[a]=(...u)=>{let d=c.apply(r,u);return d===!1&&(d=h.apply(r,u)),d||""}}i.renderer=r}if(s.tokenizer){const r=this.defaults.tokenizer||new Id(this.defaults);for(const o in s.tokenizer){if(!(o in r))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,c=s.tokenizer[a],h=r[a];r[a]=(...u)=>{let d=c.apply(r,u);return d===!1&&(d=h.apply(r,u)),d}}i.tokenizer=r}if(s.hooks){const r=this.defaults.hooks||new Nc;for(const o in s.hooks){if(!(o in r))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const a=o,c=s.hooks[a],h=r[a];Nc.passThroughHooks.has(o)?r[a]=u=>{if(this.defaults.async)return Promise.resolve(c.call(r,u)).then(f=>h.call(r,f));const d=c.call(r,u);return h.call(r,d)}:r[a]=(...u)=>{let d=c.apply(r,u);return d===!1&&(d=h.apply(r,u)),d}}i.hooks=r}if(s.walkTokens){const r=this.defaults.walkTokens,o=s.walkTokens;i.walkTokens=function(a){let c=[];return c.push(o.call(this,a)),r&&(c=c.concat(r.call(this,a))),c}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Zs.lex(t,e??this.defaults)}parser(t,e){return Qs.parse(t,e??this.defaults)}parseMarkdown(t){return(s,i)=>{const r={...i},o={...this.defaults,...r},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&r.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof s>"u"||s===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=t);const c=o.hooks?o.hooks.provideLexer():t?Zs.lex:Zs.lexInline,h=o.hooks?o.hooks.provideParser():t?Qs.parse:Qs.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(s):s).then(u=>c(u,o)).then(u=>o.hooks?o.hooks.processAllTokens(u):u).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>h(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(a);try{o.hooks&&(s=o.hooks.preprocess(s));let u=c(s,o);o.hooks&&(u=o.hooks.processAllTokens(u)),o.walkTokens&&this.walkTokens(u,o.walkTokens);let d=h(u,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(u){return a(u)}}}onError(t,e){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const i="<p>An error occurred:</p><pre>"+Li(s.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(s);throw s}}}const pa=new Hx;function Pt(n,t){return pa.parse(n,t)}Pt.options=Pt.setOptions=function(n){return pa.setOptions(n),Pt.defaults=pa.defaults,lw(Pt.defaults),Pt};Pt.getDefaults=Kg;Pt.defaults=wa;Pt.use=function(...n){return pa.use(...n),Pt.defaults=pa.defaults,lw(Pt.defaults),Pt};Pt.walkTokens=function(n,t){return pa.walkTokens(n,t)};Pt.parseInline=pa.parseInline;Pt.Parser=Qs;Pt.parser=Qs.parse;Pt.Renderer=Ld;Pt.TextRenderer=nm;Pt.Lexer=Zs;Pt.lexer=Zs.lex;Pt.Tokenizer=Id;Pt.Hooks=Nc;Pt.parse=Pt;Pt.options;Pt.setOptions;Pt.use;Pt.walkTokens;Pt.parseInline;Qs.parse;Zs.lex;const zx={key:0,class:"loading-container"},Ux={key:1,class:"error-container"},Vx={key:2},jx={class:"markdown-header"},Gx={class:"document-title"},Wx={key:0,class:"document-meta"},qx=["innerHTML"],ww=gs({__name:"MarkdownViewer",props:{url:{type:String,required:!0},refresh:{type:Boolean,default:!1}},setup(n){const t=n,e=ft(!0),s=ft(""),i=ft(""),r=ft(null),o=ft(null),a=ti(()=>{const h=s.value.match(/^#\s+(.*?)$/m);if(h&&h[1])return h[1];const u=t.url.split("/"),d=u[u.length-1].replace(".md","");return d==="README"?"":d});Pt.setOptions({breaks:!0,gfm:!0});const c=async()=>{e.value=!0,r.value=null;try{const h=await fetch(t.url);if(!h.ok)throw new Error(`Markdown: ${h.statusText}`);const u=await h.text();s.value=u,i.value=await Pt(u);const d=h.headers.get("last-modified");if(d){const f=new Date(d);o.value=f.toLocaleString("zh-CN")}}catch(h){console.error("Markdown:",h),r.value=h instanceof Error?h.message:""}finally{e.value=!1}};return za(()=>t.url,()=>{c()}),za(()=>t.refresh,(h,u)=>{h&&h!==u&&c()}),Wr(()=>{c()}),(h,u)=>(q(),et("div",{class:pe(["markdown-viewer custom-scrollbar",{loading:e.value}])},[e.value?(q(),et("div",zx,u[0]||(u[0]=[M("div",{class:"loading-spinner"},null,-1),M("span",null,"...",-1)]))):r.value?(q(),et("div",Ux,[u[1]||(u[1]=M("div",{class:"error-icon"},"!",-1)),M("span",null,yt(r.value),1),M("button",{class:"retry-button",onClick:c},"")])):(q(),et("div",Vx,[M("div",jx,[M("h1",Gx,yt(a.value),1),o.value?(q(),et("div",Wx,"  "+yt(o.value),1)):de("",!0)]),M("div",{class:"markdown-content",innerHTML:i.value},null,8,qx)]))],2))}}),Xx="https://xiaowine.github.io/chip-docs";async function Yx(){try{const n=Af(`${Xx}/.data/changes.json`),t=await fetch(n);if(!t.ok)throw new Error("Failed to fetch changelog");return await t.json()}catch(n){return console.error("Error fetching changelog:",n),[]}}function Kx(n){try{return new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return n}}const Zx={class:"changelog"},Qx={key:0,class:"changelog-loading"},Jx={key:1,class:"changelog-error"},tE={key:2,class:"changelog-empty"},eE={key:3,class:"changelog-list"},sE=["onClick"],iE={class:"changelog-header-content"},nE={class:"changelog-date"},rE={class:"changelog-changes-count"},oE={class:"changelog-details"},aE={key:0,class:"changelog-section added"},lE={class:"changelog-section-header"},cE={class:"file-name"},hE={class:"file-md5"},uE={key:1,class:"changelog-section modified"},dE={class:"changelog-section-header"},fE={class:"file-name"},pE={key:0,class:"file-md5"},gE={key:1,class:"file-md5"},mE={key:2,class:"changelog-section removed"},bE={class:"changelog-section-header"},yE={class:"file-name"},wE={class:"file-md5"},vE=gs({__name:"ChangeLog",setup(n){const t=ft([]),e=ft(!0),s=ft(null),i=ft([]),r=async()=>{e.value=!0,s.value=null;try{const u=await Yx();t.value=u.sort((d,f)=>d.timestamp>f.timestamp?-1:d.timestamp<f.timestamp?1:0)}catch(u){s.value=u instanceof Error?u.message:""}finally{e.value=!1}},o=u=>u.changes.added.length+u.changes.modified.length+u.changes.removed.length,a=u=>{const d=i.value.indexOf(u);d>-1?i.value.splice(d,1):i.value.push(u)},c=(u,d)=>{const f=u;f.style.display="block";const p=f.scrollHeight+"px";f.style.height="0",f.style.opacity="0",f.offsetHeight,f.addEventListener("transitionend",function m(){f.style.height="auto",f.removeEventListener("transitionend",m),d()}),requestAnimationFrame(()=>{f.style.height=p,f.style.opacity="1"})},h=(u,d)=>{const f=u;f.style.height=f.scrollHeight+"px",f.offsetHeight;const p=()=>{f.removeEventListener("transitionend",p),d()};f.addEventListener("transitionend",p),requestAnimationFrame(()=>{f.style.height="0",f.style.opacity="0"})};return Wr(()=>{r()}),(u,d)=>(q(),et("div",Zx,[e.value?(q(),et("div",Qx,d[0]||(d[0]=[M("div",{class:"changelog-spinner"},null,-1),M("p",null,"...",-1)]))):s.value?(q(),et("div",Jx,[M("p",null,yt(s.value),1),M("button",{class:"changelog-retry-btn",onClick:r},"")])):t.value.length?(q(),et("div",eE,[(q(!0),et(Xt,null,Hn(t.value,(f,p)=>(q(),et("div",{key:p,class:pe(["changelog-item",{expanded:i.value.includes(p)}])},[M("div",{class:"changelog-header",onClick:m=>a(p)},[M("div",iE,[M("span",nE,yt(ie(Kx)(f.timestamp)),1),M("span",rE,yt(o(f))+"  ",1)]),M("span",{class:pe(["changelog-indicator",{expanded:i.value.includes(p)}])},d[2]||(d[2]=[M("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},[M("path",{fill:"currentColor",d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})],-1)]),2)],8,sE),At(tw,{name:"expand",onEnter:c,onLeave:h},{default:Ys(()=>[Ed(M("div",oE,[f.changes.added.length?(q(),et("div",aE,[M("div",lE,[d[3]||(d[3]=M("div",{class:"changelog-section-icon"},"",-1)),M("h4",null," ("+yt(f.changes.added.length)+")",1)]),M("ul",null,[(q(!0),et(Xt,null,Hn(f.changes.added,m=>(q(),et("li",{key:m.md5},[M("span",cE,yt(m.filename),1),M("span",hE,"[MD5: "+yt(m.md5)+"]",1)]))),128))])])):de("",!0),f.changes.modified.length?(q(),et("div",uE,[M("div",dE,[d[4]||(d[4]=M("div",{class:"changelog-section-icon"},"",-1)),M("h4",null," ("+yt(f.changes.modified.length)+")",1)]),M("ul",null,[(q(!0),et(Xt,null,Hn(f.changes.modified,m=>(q(),et("li",{key:m.new_md5||m.md5},[M("span",fE,yt(m.filename),1),m.md5?(q(),et("span",pE,"[MD5: "+yt(m.md5)+"]",1)):de("",!0),m.old_md5&&m.new_md5?(q(),et("span",gE,"[MD5: "+yt(m.old_md5)+"  "+yt(m.new_md5)+"]",1)):de("",!0)]))),128))])])):de("",!0),f.changes.removed.length?(q(),et("div",mE,[M("div",bE,[d[5]||(d[5]=M("div",{class:"changelog-section-icon"},"",-1)),M("h4",null," ("+yt(f.changes.removed.length)+")",1)]),M("ul",null,[(q(!0),et(Xt,null,Hn(f.changes.removed,m=>(q(),et("li",{key:m.md5},[M("span",yE,yt(m.filename),1),M("span",wE,"[MD5: "+yt(m.md5)+"]",1)]))),128))])])):de("",!0)],512),[[Yg,i.value.includes(p)]])]),_:2},1024)],2))),128))])):(q(),et("div",tE,d[1]||(d[1]=[M("p",null,"",-1)])))]))}}),AE=$s(vE,[["__scopeId","data-v-be6b0557"]]),_E={},SE={class:"section about"};function xE(n,t){return q(),et("div",SE,t[0]||(t[0]=[f_('<div class="avatar-container" data-v-ef7e504a><div class="avatar-image" data-v-ef7e504a></div></div><div class="social-links" data-v-ef7e504a><a href="https://github.com/xiaowine" target="_blank" class="social-icon github-icon" data-v-ef7e504a></a><a href="https://space.bilibili.com/393492876" target="_blank" class="social-icon bilibili-icon" data-v-ef7e504a></a><a href="https://oshwhub.com/xiao_wine" target="_blank" class="social-icon jlc-icon" data-v-ef7e504a></a></div><div class="author-name" data-v-ef7e504a>xiao_wine</div>',3)]))}const EE=$s(_E,[["render",xE],["__scopeId","data-v-ef7e504a"]]);var Oc={};Oc.d=(n,t)=>{for(var e in t)Oc.o(t,e)&&!Oc.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})};Oc.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var at=globalThis.pdfjsLib={};Oc.d(at,{AbortException:()=>Br,AnnotationEditorLayer:()=>xg,AnnotationEditorParamsType:()=>St,AnnotationEditorType:()=>dt,AnnotationEditorUIManager:()=>ma,AnnotationLayer:()=>Jp,AnnotationMode:()=>tr,AnnotationType:()=>he,ColorPicker:()=>Bd,DOMSVGFactory:()=>Od,DrawLayer:()=>Tg,FeatureTest:()=>$e,GlobalWorkerOptions:()=>$n,ImageKind:()=>Gu,InvalidPDFException:()=>fp,MathClamp:()=>Ds,OPS:()=>ri,OutputScale:()=>Vn,PDFDataRangeTransport:()=>_v,PDFDateString:()=>cm,PDFWorker:()=>Va,PasswordResponses:()=>kE,PermissionFlag:()=>TE,PixelsPerInch:()=>Hr,RenderingCancelledException:()=>am,ResponseException:()=>Dd,SignatureExtractor:()=>Bn,SupportedImageMimeTypes:()=>gp,TextLayer:()=>Gc,TouchManager:()=>Nd,Util:()=>st,VerbosityLevel:()=>xf,XfaLayer:()=>xv,build:()=>K1,createValidAbsoluteUrl:()=>IE,fetchData:()=>vu,getDocument:()=>B1,getFilenameFromUrl:()=>zE,getPdfFilenameFromUrl:()=>UE,getUuid:()=>_w,getXfaPageViewport:()=>VE,isDataScheme:()=>Tf,isPdfFile:()=>lm,isValidExplicitDest:()=>V1,noContextMenu:()=>Si,normalizeUnicode:()=>$E,setLayerDimensions:()=>ga,shadow:()=>_t,stopEvent:()=>ue,version:()=>Y1});const De=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),vw=[1,0,0,1,0,0],dp=[.001,0,0,.001,0,0],jf=1.35,Ls={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},tr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},CE="pdfjs_internal_editor_",dt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},St={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},TE={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},He={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Gu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},he={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ea={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},xf={ERRORS:0,WARNINGS:1,INFOS:5},ri={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},kE={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ef=xf.WARNINGS;function RE(n){Number.isInteger(n)&&(Ef=n)}function PE(){return Ef}function Cf(n){Ef>=xf.INFOS&&console.log(`Info: ${n}`)}function gt(n){Ef>=xf.WARNINGS&&console.log(`Warning: ${n}`)}function $t(n){throw new Error(n)}function fe(n,t){n||$t(t)}function ME(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function IE(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"){if(e.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(e.tryConvertEncoding)try{n=OE(n)}catch{}}const s=t?URL.parse(n,t):URL.parse(n);return ME(s)?s:null}function _t(n,t,e,s=!1){return Object.defineProperty(n,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const va=function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t}();class bb extends va{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Gf extends va{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class fp extends va{constructor(t){super(t,"InvalidPDFException")}}class Dd extends va{constructor(t,e,s){super(t,"ResponseException"),this.status=e,this.missing=s}}class LE extends va{constructor(t){super(t,"FormatError")}}class Br extends va{constructor(t){super(t,"AbortException")}}function Aw(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&$t("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<t;i+=e){const r=Math.min(i+e,t),o=n.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function wu(n){typeof n!="string"&&$t("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=n.charCodeAt(s)&255;return e}function DE(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function rm(n){const t=Object.create(null);for(const[e,s]of n)t[e]=s;return t}function FE(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function NE(){try{return new Function(""),!0}catch{return!1}}class $e{static get isLittleEndian(){return _t(this,"isLittleEndian",FE())}static get isEvalSupported(){return _t(this,"isEvalSupported",NE())}static get isOffscreenCanvasSupported(){return _t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return _t(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){if(typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"){const{platform:t,userAgent:e}=navigator;return _t(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}return _t(this,"platform",{isAndroid:!1,isLinux:!1,isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return _t(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const Wf=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var zn,Wu,pp;class st{static makeHexColor(t,e,s){return`#${Wf[t]}${Wf[e]}${Wf[s]}`}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const s=t[0]*e[0]+t[1]*e[2]+e[4],i=t[0]*e[1]+t[1]*e[3]+e[5];return[s,i]}static applyInverseTransform(t,e){const s=e[0]*e[3]-e[1]*e[2],i=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/s,r=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/s;return[i,r]}static getAxialAlignedBoundingBox(t,e){const s=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),r=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(s[0],i[0],r[0],o[0]),Math.min(s[1],i[1],r[1],o[1]),Math.max(s[0],i[0],r[0],o[0]),Math.max(s[1],i[1],r[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],s=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],a=(s+o)/2,c=Math.sqrt((s+o)**2-4*(s*o-r*i))/2,h=a+c||1,u=a-c||1;return[Math.sqrt(h),Math.sqrt(u)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>i)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>o?null:[s,r,i,o]}static bezierBoundingBox(t,e,s,i,r,o,a,c,h){return h?(h[0]=Math.min(h[0],t,a),h[1]=Math.min(h[1],e,c),h[2]=Math.max(h[2],t,a),h[3]=Math.max(h[3],e,c)):h=[Math.min(t,a),Math.min(e,c),Math.max(t,a),Math.max(e,c)],w(this,zn,pp).call(this,t,s,r,a,e,i,o,c,3*(-t+3*(s-r)+a),6*(t-2*s+r),3*(s-t),h),w(this,zn,pp).call(this,t,s,r,a,e,i,o,c,3*(-e+3*(i-o)+c),6*(e-2*i+o),3*(i-e),h),h}}zn=new WeakSet,Wu=function(t,e,s,i,r,o,a,c,h,u){if(h<=0||h>=1)return;const d=1-h,f=h*h,p=f*h,m=d*(d*(d*t+3*h*e)+3*f*s)+p*i,b=d*(d*(d*r+3*h*o)+3*f*a)+p*c;u[0]=Math.min(u[0],m),u[1]=Math.min(u[1],b),u[2]=Math.max(u[2],m),u[3]=Math.max(u[3],b)},pp=function(t,e,s,i,r,o,a,c,h,u,d,f){if(Math.abs(h)<1e-12){Math.abs(u)>=1e-12&&w(this,zn,Wu).call(this,t,e,s,i,r,o,a,c,-d/u,f);return}const p=u**2-4*d*h;if(p<0)return;const m=Math.sqrt(p),b=2*h;w(this,zn,Wu).call(this,t,e,s,i,r,o,a,c,(-u+m)/b,f),w(this,zn,Wu).call(this,t,e,s,i,r,o,a,c,(-u-m)/b,f)},y(st,zn);function OE(n){return decodeURIComponent(escape(n))}let qf=null,yb=null;function $E(n){return qf||(qf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,yb=new Map([["","t"]])),n.replaceAll(qf,(t,e,s)=>e?e.normalize("NFKC"):yb.get(s))}function _w(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),Aw(n)}const om="pdfjs_internal_id_";function BE(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[s,i,...r]=e;if(!n(s)&&!Number.isInteger(s)||!t(i))return!1;const o=r.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||a&&c===null))return!1;return!0}function Ds(n,t,e){return Math.min(Math.max(n,t),e)}function Sw(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(Aw(n))}function HE(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):wu(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});const sn="http://www.w3.org/2000/svg",eo=class eo{};U(eo,"CSS",96),U(eo,"PDF",72),U(eo,"PDF_TO_CSS_UNITS",eo.CSS/eo.PDF);let Hr=eo;async function vu(n,t="text"){if(Ca(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Au{constructor({viewBox:t,userUnit:e,scale:s,rotation:i,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=o,s*=e;const c=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let u,d,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:u=-1,d=0,f=0,p=1;break;case 90:u=0,d=1,f=1,p=0;break;case 270:u=0,d=-1,f=-1,p=0;break;case 0:u=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,p=-p);let m,b,A,v;u===0?(m=Math.abs(h-t[1])*s+r,b=Math.abs(c-t[0])*s+o,A=(t[3]-t[1])*s,v=(t[2]-t[0])*s):(m=Math.abs(c-t[0])*s+r,b=Math.abs(h-t[1])*s+o,A=(t[2]-t[0])*s,v=(t[3]-t[1])*s),this.transform=[u*s,d*s,f*s,p*s,m-u*s*c-f*s*h,b-d*s*c-p*s*h],this.width=A,this.height=v}get rawDims(){const t=this.viewBox;return _t(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Au({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(t,e){return st.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=st.applyTransform([t[0],t[1]],this.transform),s=st.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){return st.applyInverseTransform([t,e],this.transform)}}class am extends va{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Tf(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function lm(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function zE(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function UE(n,t="document.pdf"){if(typeof n!="string")return t;if(Tf(n))return gt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||t}class wb{constructor(){U(this,"started",Object.create(null));U(this,"times",[])}time(t){t in this.started&&gt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||gt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:i,end:r}of this.times)t.push(`${s.padEnd(e)} ${r-i}ms
`);return t.join("")}}function Ca(n,t){const e=t?URL.parse(n,t):URL.parse(n);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function Si(n){n.preventDefault()}function ue(n){n.preventDefault(),n.stopPropagation()}var qc;class cm{static toDateObject(t){if(!t||typeof t!="string")return null;l(this,qc)||g(this,qc,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=l(this,qc).exec(t);if(!e)return null;const s=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(e[6],10);c=c>=0&&c<=59?c:0;const h=e[7]||"Z";let u=parseInt(e[8],10);u=u>=0&&u<=23?u:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,h==="-"?(o+=u,a+=d):h==="+"&&(o-=u,a-=d),new Date(Date.UTC(s,i,r,o,a,c))}}qc=new WeakMap,y(cm,qc);function VE(n,{scale:t=1,rotation:e=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Au({viewBox:r,userUnit:1,scale:t,rotation:e})}function hm(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(gt(`Not a valid color format: "${n}"`),[0,0,0])}function jE(n){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of n.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;n.set(e,hm(s))}t.remove()}function Qt(n){const{a:t,b:e,c:s,d:i,e:r,f:o}=n.getTransform();return[t,e,s,i,r,o]}function Pi(n){const{a:t,b:e,c:s,d:i,e:r,f:o}=n.getTransform().invertSelf();return[t,e,s,i,r,o]}function ga(n,t,e=!1,s=!0){if(t instanceof Au){const{pageWidth:i,pageHeight:r}=t.rawDims,{style:o}=n,a=$e.isCSSRoundSupported,c=`var(--total-scale-factor) * ${i}px`,h=`var(--total-scale-factor) * ${r}px`,u=a?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,d=a?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!e||t.rotation%180===0?(o.width=u,o.height=d):(o.width=d,o.height=u)}s&&n.setAttribute("data-main-rotation",t.rotation)}class Vn{constructor(){const{pixelRatio:t}=Vn;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,s,i){let r=1/0,o=1/0,a=1/0;s>0&&(r=Math.sqrt(s/(t*e))),i!==-1&&(o=i/t,a=i/e);const c=Math.min(r,o,a);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}}const gp=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var er,io,zs,sr,Xc,ja,Yc,Ud,xw,Oe,Ew,Cw,uc,Tw,qu;const an=class an{constructor(t){y(this,Oe);y(this,er,null);y(this,io,null);y(this,zs);y(this,sr,null);y(this,Xc,null);y(this,ja,null);g(this,zs,t),l(an,Yc)||g(an,Yc,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=g(this,er,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=l(this,zs)._uiManager._signal;t.addEventListener("contextmenu",Si,{signal:e}),t.addEventListener("pointerdown",w(an,Ud,xw),{signal:e});const s=g(this,sr,document.createElement("div"));s.className="buttons",t.append(s);const i=l(this,zs).toolbarPosition;if(i){const{style:r}=t,o=l(this,zs)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return w(this,Oe,Tw).call(this),t}get div(){return l(this,er)}hide(){var t;l(this,er).classList.add("hidden"),(t=l(this,io))==null||t.hideDropdown()}show(){var t;l(this,er).classList.remove("hidden"),(t=l(this,Xc))==null||t.shown()}async addAltText(t){const e=await t.render();w(this,Oe,uc).call(this,e),l(this,sr).prepend(e,l(this,Oe,qu)),g(this,Xc,t)}addColorPicker(t){g(this,io,t);const e=t.renderButton();w(this,Oe,uc).call(this,e),l(this,sr).prepend(e,l(this,Oe,qu))}async addEditSignatureButton(t){const e=g(this,ja,await t.renderEditButton(l(this,zs)));w(this,Oe,uc).call(this,e),l(this,sr).prepend(e,l(this,Oe,qu))}updateEditSignatureButton(t){l(this,ja)&&(l(this,ja).title=t)}remove(){var t;l(this,er).remove(),(t=l(this,io))==null||t.destroy(),g(this,io,null)}};er=new WeakMap,io=new WeakMap,zs=new WeakMap,sr=new WeakMap,Xc=new WeakMap,ja=new WeakMap,Yc=new WeakMap,Ud=new WeakSet,xw=function(t){t.stopPropagation()},Oe=new WeakSet,Ew=function(t){l(this,zs)._focusEventsAllowed=!1,ue(t)},Cw=function(t){l(this,zs)._focusEventsAllowed=!0,ue(t)},uc=function(t){const e=l(this,zs)._uiManager._signal;t.addEventListener("focusin",w(this,Oe,Ew).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",w(this,Oe,Cw).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Si,{signal:e})},Tw=function(){const{editorType:t,_uiManager:e}=l(this,zs),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(an,Yc)[t]),w(this,Oe,uc).call(this,s),s.addEventListener("click",i=>{e.delete()},{signal:e._signal}),l(this,sr).append(s)},qu=function(){const t=document.createElement("div");return t.className="divider",t},y(an,Ud),y(an,Yc,null);let mp=an;var Kc,no,ro,zr,kw,Rw,Pw;class GE{constructor(t){y(this,zr);y(this,Kc,null);y(this,no,null);y(this,ro);g(this,ro,t)}show(t,e,s){const[i,r]=w(this,zr,Rw).call(this,e,s),{style:o}=l(this,no)||g(this,no,w(this,zr,kw).call(this));t.append(l(this,no)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,no).remove()}}Kc=new WeakMap,no=new WeakMap,ro=new WeakMap,zr=new WeakSet,kw=function(){const t=g(this,no,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Si,{signal:l(this,ro)._signal});const e=g(this,Kc,document.createElement("div"));return e.className="buttons",t.append(e),w(this,zr,Pw).call(this),t},Rw=function(t,e){let s=0,i=0;for(const r of t){const o=r.y+r.height;if(o<s)continue;const a=r.x+(e?r.width:0);if(o>s){i=a,s=o;continue}e?a>i&&(i=a):a<i&&(i=a)}return[e?1-i:i,s]},Pw=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,ro)._signal;t.addEventListener("contextmenu",Si,{signal:s}),t.addEventListener("click",()=>{l(this,ro).highlightSelection("floating_button")},{signal:s}),l(this,Kc).append(t)};function um(n,t,e){for(const s of e)t.addEventListener(s,n[s].bind(n))}var Vd;class WE{constructor(){y(this,Vd,0)}get id(){return`${CE}${Ke(this,Vd)._++}`}}Vd=new WeakMap;var Ga,Zc,Ue,Wa,Xu;const ym=class ym{constructor(){y(this,Wa);y(this,Ga,_w());y(this,Zc,0);y(this,Ue,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return _t(this,"_isSVGFittingCanvas",r)}async getFromFile(t){const{lastModified:e,name:s,size:i,type:r}=t;return w(this,Wa,Xu).call(this,`${e}_${s}_${i}_${r}`,t)}async getFromUrl(t){return w(this,Wa,Xu).call(this,t,t)}async getFromBlob(t,e){const s=await e;return w(this,Wa,Xu).call(this,t,s)}async getFromId(t){l(this,Ue)||g(this,Ue,new Map);const e=l(this,Ue).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){l(this,Ue)||g(this,Ue,new Map);let s=l(this,Ue).get(t);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,Ga)}_${Ke(this,Zc)._++}`,refCounter:1,isSvg:!1},l(this,Ue).set(t,s),l(this,Ue).set(s.id,s),s}getSvgUrl(t){const e=l(this,Ue).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var i;l(this,Ue)||g(this,Ue,new Map);const e=l(this,Ue).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),e.bitmap=null}isValidId(t){return t.startsWith(`image_${l(this,Ga)}_`)}};Ga=new WeakMap,Zc=new WeakMap,Ue=new WeakMap,Wa=new WeakSet,Xu=async function(t,e){l(this,Ue)||g(this,Ue,new Map);let s=l(this,Ue).get(t);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,Ga)}_${Ke(this,Zc)._++}`,refCounter:0,isSvg:!1});let i;if(typeof e=="string"?(s.url=e,i=await vu(e,"blob")):e instanceof File?i=s.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const r=ym._isSVGFittingCanvas,o=new FileReader,a=new Image,c=new Promise((h,u)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,h()},o.onload=async()=>{const d=s.svgUrl=o.result;a.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},a.onerror=o.onerror=u});o.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){gt(i),s=null}return l(this,Ue).set(t,s),s&&l(this,Ue).set(s.id,s),s};let bp=ym;var oe,ir,Qc,se;class qE{constructor(t=128){y(this,oe,[]);y(this,ir,!1);y(this,Qc);y(this,se,-1);g(this,Qc,t)}add({cmd:t,undo:e,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&t(),l(this,ir))return;const c={cmd:t,undo:e,post:s,type:r};if(l(this,se)===-1){l(this,oe).length>0&&(l(this,oe).length=0),g(this,se,0),l(this,oe).push(c);return}if(o&&l(this,oe)[l(this,se)].type===r){a&&(c.undo=l(this,oe)[l(this,se)].undo),l(this,oe)[l(this,se)]=c;return}const h=l(this,se)+1;h===l(this,Qc)?l(this,oe).splice(0,1):(g(this,se,h),h<l(this,oe).length&&l(this,oe).splice(h)),l(this,oe).push(c)}undo(){if(l(this,se)===-1)return;g(this,ir,!0);const{undo:t,post:e}=l(this,oe)[l(this,se)];t(),e==null||e(),g(this,ir,!1),g(this,se,l(this,se)-1)}redo(){if(l(this,se)<l(this,oe).length-1){g(this,se,l(this,se)+1),g(this,ir,!0);const{cmd:t,post:e}=l(this,oe)[l(this,se)];t(),e==null||e(),g(this,ir,!1)}}hasSomethingToUndo(){return l(this,se)!==-1}hasSomethingToRedo(){return l(this,se)<l(this,oe).length-1}cleanType(t){if(l(this,se)!==-1){for(let e=l(this,se);e>=0;e--)if(l(this,oe)[e].type!==t){l(this,oe).splice(e+1,l(this,se)-e),g(this,se,e);return}l(this,oe).length=0,g(this,se,-1)}}destroy(){g(this,oe,null)}}oe=new WeakMap,ir=new WeakMap,Qc=new WeakMap,se=new WeakMap;var jd,Mw;class _u{constructor(t){y(this,jd);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=$e.platform;for(const[s,i,r={}]of t)for(const o of s){const a=o.startsWith("mac+");e&&a?(this.callbacks.set(o.slice(4),{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1))):!e&&!a&&(this.callbacks.set(o,{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(w(this,jd,Mw).call(this,e));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:o=[],checker:a=null}}=s;a&&!a(t,e)||(i.bind(t,...o,e)(),r||ue(e))}}jd=new WeakSet,Mw=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Gd=class Gd{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return jE(t),_t(this,"_colors",t)}convert(t){const e=hm(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,i]of this._colors)if(i.every((r,o)=>r===e[o]))return Gd._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?st.makeHexColor(...e):t}};U(Gd,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let yp=Gd;var qa,ws,ye,Pe,Xa,cn,Ya,Us,nr,oo,Ka,ao,Ni,oi,lo,Jc,th,Za,eh,Oi,rr,Qa,or,$i,Wd,ar,sh,lr,co,ho,cr,ih,_e,Dt,hn,hr,uo,nh,rh,ur,Bi,un,oh,Vs,W,Yu,wp,Iw,Lw,Ku,Dw,Fw,Nw,vp,Ow,Ap,_p,$w,Qe,nn,Bw,Hw,Sp,zw,dc,xp;const La=class La{constructor(t,e,s,i,r,o,a,c,h,u,d,f,p,m){y(this,W);y(this,qa,new AbortController);y(this,ws,null);y(this,ye,new Map);y(this,Pe,new Map);y(this,Xa,null);y(this,cn,null);y(this,Ya,null);y(this,Us,new qE);y(this,nr,null);y(this,oo,null);y(this,Ka,0);y(this,ao,new Set);y(this,Ni,null);y(this,oi,null);y(this,lo,new Set);U(this,"_editorUndoBar",null);y(this,Jc,!1);y(this,th,!1);y(this,Za,!1);y(this,eh,null);y(this,Oi,null);y(this,rr,null);y(this,Qa,null);y(this,or,!1);y(this,$i,null);y(this,Wd,new WE);y(this,ar,!1);y(this,sh,!1);y(this,lr,null);y(this,co,null);y(this,ho,null);y(this,cr,null);y(this,ih,null);y(this,_e,dt.NONE);y(this,Dt,new Set);y(this,hn,null);y(this,hr,null);y(this,uo,null);y(this,nh,null);y(this,rh,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});y(this,ur,[0,0]);y(this,Bi,null);y(this,un,null);y(this,oh,null);y(this,Vs,null);const b=this._signal=l(this,qa).signal;g(this,un,t),g(this,oh,e),g(this,Xa,s),g(this,hr,i),this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:b}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),r._on("setpreference",this.onSetPreference.bind(this),{signal:b}),r._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:b}),w(this,W,Dw).call(this),w(this,W,$w).call(this),w(this,W,vp).call(this),g(this,cn,o.annotationStorage),g(this,eh,o.filterFactory),g(this,uo,a),g(this,Qa,c||null),g(this,Jc,h),g(this,th,u),g(this,Za,d),g(this,ih,f||null),this.viewParameters={realScale:Hr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const t=La.prototype,e=o=>l(o,un).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:c}=a;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return _t(this,"_keyboardManager",new _u([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,un).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,un).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}destroy(){var t,e,s,i,r,o,a,c;(t=l(this,Vs))==null||t.resolve(),g(this,Vs,null),(e=l(this,qa))==null||e.abort(),g(this,qa,null),this._signal=null;for(const h of l(this,Pe).values())h.destroy();l(this,Pe).clear(),l(this,ye).clear(),l(this,lo).clear(),(s=l(this,cr))==null||s.clear(),g(this,ws,null),l(this,Dt).clear(),l(this,Us).destroy(),(i=l(this,Xa))==null||i.destroy(),(r=l(this,hr))==null||r.destroy(),(o=l(this,$i))==null||o.hide(),g(this,$i,null),(a=l(this,ho))==null||a.destroy(),g(this,ho,null),l(this,Oi)&&(clearTimeout(l(this,Oi)),g(this,Oi,null)),l(this,Bi)&&(clearTimeout(l(this,Bi)),g(this,Bi,null)),(c=this._editorUndoBar)==null||c.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return l(this,ih)}get useNewAltTextFlow(){return l(this,th)}get useNewAltTextWhenAddingImage(){return l(this,Za)}get hcmFilter(){return _t(this,"hcmFilter",l(this,uo)?l(this,eh).addHCMFilter(l(this,uo).foreground,l(this,uo).background):"none")}get direction(){return _t(this,"direction",getComputedStyle(l(this,un)).direction)}get highlightColors(){return _t(this,"highlightColors",l(this,Qa)?new Map(l(this,Qa).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return _t(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,oo,t)}setMainHighlightColorPicker(t){g(this,ho,t)}editAltText(t,e=!1){var s;(s=l(this,Xa))==null||s.editAltText(this,t,e)}getSignature(t){var e;(e=l(this,hr))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return l(this,hr)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":g(this,Za,e);break}}onPageChanging({pageNumber:t}){g(this,Ka,t-1)}focusMainContainer(){l(this,un).focus()}findParent(t,e){for(const s of l(this,Pe).values()){const{x:i,y:r,width:o,height:a}=s.div.getBoundingClientRect();if(t>=i&&t<=i+o&&e>=r&&e<=r+a)return s}return null}disableUserSelect(t=!1){l(this,oh).classList.toggle("noUserSelect",t)}addShouldRescale(t){l(this,lo).add(t)}removeShouldRescale(t){l(this,lo).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*Hr.PDF_TO_CSS_UNITS;for(const s of l(this,lo))s.onScaleChanging();(e=l(this,oo))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o}=e,a=e.toString(),h=w(this,W,Yu).call(this,e).closest(".textLayer"),u=this.getSelectionBoxes(h);if(!u)return;e.empty();const d=w(this,W,wp).call(this,h),f=l(this,_e)===dt.NONE,p=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:u,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o,text:a}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(dt.HIGHLIGHT,p);return}p()}addToAnnotationStorage(t){!t.isEmpty()&&l(this,cn)&&!l(this,cn).has(t.id)&&l(this,cn).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,l(this,or)&&(g(this,or,!1),w(this,W,Ku).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of l(this,Dt))if(e.div.contains(t)){g(this,co,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!l(this,co))return;const[t,e]=l(this,co);g(this,co,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){w(this,W,vp).call(this),w(this,W,Ap).call(this)}removeEditListeners(){w(this,W,Ow).call(this),w(this,W,_p).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of l(this,oi))if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of l(this,oi))if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var s;if(t.preventDefault(),(s=l(this,ws))==null||s.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of l(this,Dt)){const r=i.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const o of l(this,oi))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){gt(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const h=await i.deserialize(c);if(!h)return;r.push(h)}const o=()=>{for(const c of r)w(this,W,Sp).call(this,c);w(this,W,xp).call(this,r)},a=()=>{for(const c of r)c.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){gt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,_e)!==dt.NONE&&!this.isEditorHandlingKeyboard&&La._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,or)&&(g(this,or,!1),w(this,W,Ku).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(w(this,W,Fw).call(this),w(this,W,Ap).call(this),w(this,W,Qe).call(this,{isEditing:l(this,_e)!==dt.NONE,isEmpty:w(this,W,dc).call(this),hasSomethingToUndo:l(this,Us).hasSomethingToUndo(),hasSomethingToRedo:l(this,Us).hasSomethingToRedo(),hasSelectedEditor:!1})):(w(this,W,Nw).call(this),w(this,W,_p).call(this),w(this,W,Qe).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!l(this,oi)){g(this,oi,t);for(const e of l(this,oi))w(this,W,nn).call(this,e.defaultPropertiesToUpdate)}}getId(){return l(this,Wd).id}get currentLayer(){return l(this,Pe).get(l(this,Ka))}getLayer(t){return l(this,Pe).get(t)}get currentPageIndex(){return l(this,Ka)}addLayer(t){l(this,Pe).set(t.pageIndex,t),l(this,ar)?t.enable():t.disable()}removeLayer(t){l(this,Pe).delete(t.pageIndex)}async updateMode(t,e=null,s=!1){var i,r;if(l(this,_e)!==t&&!(l(this,Vs)&&(await l(this,Vs).promise,!l(this,Vs)))){if(g(this,Vs,Promise.withResolvers()),g(this,_e,t),t===dt.NONE){this.setEditingState(!1),w(this,W,Hw).call(this),(i=this._editorUndoBar)==null||i.hide(),l(this,Vs).resolve();return}t===dt.SIGNATURE&&await((r=l(this,hr))==null?void 0:r.loadSignatures()),this.setEditingState(!0),await w(this,W,Bw).call(this),this.unselectAll();for(const o of l(this,Pe).values())o.updateMode(t);if(!e){s&&this.addNewEditorFromKeyboard(),l(this,Vs).resolve();return}for(const o of l(this,ye).values())o.annotationElementId===e?(this.setSelected(o),o.enterInEditMode()):o.unselect();l(this,Vs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==l(this,_e)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var s;if(l(this,oi)){switch(t){case St.CREATE:this.currentLayer.addNewEditor(e);return;case St.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,ho))==null||s.updateColor(e);break;case St.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,nh)||g(this,nh,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const i of l(this,Dt))i.updateParams(t,e);for(const i of l(this,oi))i.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){var r;for(const o of l(this,ye).values())o.editorType===t&&o.show(e);(((r=l(this,nh))==null?void 0:r.get(St.HIGHLIGHT_SHOW_ALL))??!0)!==e&&w(this,W,nn).call(this,[[St.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(l(this,sh)!==t){g(this,sh,t);for(const e of l(this,Pe).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const s of l(this,ye).values())s.pageIndex===t&&e.push(s);return e}getEditor(t){return l(this,ye).get(t)}addEditor(t){l(this,ye).set(t.id,t)}removeEditor(t){var e,s;t.div.contains(document.activeElement)&&(l(this,Oi)&&clearTimeout(l(this,Oi)),g(this,Oi,setTimeout(()=>{this.focusMainContainer(),g(this,Oi,null)},0))),l(this,ye).delete(t.id),t.annotationElementId&&((e=l(this,cr))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!l(this,ao).has(t.annotationElementId))&&((s=l(this,cn))==null||s.remove(t.id))}addDeletedAnnotationElement(t){l(this,ao).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return l(this,ao).has(t)}removeDeletedAnnotationElement(t){l(this,ao).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){l(this,ws)!==t&&(g(this,ws,t),t&&w(this,W,nn).call(this,t.propertiesToUpdate))}updateUI(t){l(this,W,zw)===t&&w(this,W,nn).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){w(this,W,nn).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(l(this,Dt).has(t)){l(this,Dt).delete(t),t.unselect(),w(this,W,Qe).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,Dt).add(t),t.select(),w(this,W,nn).call(this,t.propertiesToUpdate),w(this,W,Qe).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=l(this,oo))==null||e.commitOrRemove();for(const s of l(this,Dt))s!==t&&s.unselect();l(this,Dt).clear(),l(this,Dt).add(t),t.select(),w(this,W,nn).call(this,t.propertiesToUpdate),w(this,W,Qe).call(this,{hasSelectedEditor:!0})}isSelected(t){return l(this,Dt).has(t)}get firstSelectedEditor(){return l(this,Dt).values().next().value}unselect(t){t.unselect(),l(this,Dt).delete(t),w(this,W,Qe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,Dt).size!==0}get isEnterHandled(){return l(this,Dt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;l(this,Us).undo(),w(this,W,Qe).call(this,{hasSomethingToUndo:l(this,Us).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:w(this,W,dc).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){l(this,Us).redo(),w(this,W,Qe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,Us).hasSomethingToRedo(),isEmpty:w(this,W,dc).call(this)})}addCommands(t){l(this,Us).add(t),w(this,W,Qe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:w(this,W,dc).call(this)})}cleanUndoStack(t){l(this,Us).cleanType(t)}delete(){var r;this.commitOrRemove();const t=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...l(this,Dt)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},i=()=>{for(const o of e)w(this,W,Sp).call(this,o)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=l(this,ws))==null||t.commitOrRemove()}hasSomethingToControl(){return l(this,ws)||this.hasSelection}selectAll(){for(const t of l(this,Dt))t.commit();w(this,W,xp).call(this,l(this,ye).values())}unselectAll(){var t;if(!(l(this,ws)&&(l(this,ws).commitOrRemove(),l(this,_e)!==dt.NONE))&&!((t=l(this,oo))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of l(this,Dt))e.unselect();l(this,Dt).clear(),w(this,W,Qe).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,ur)[0]+=t,l(this,ur)[1]+=e;const[i,r]=l(this,ur),o=[...l(this,Dt)],a=1e3;l(this,Bi)&&clearTimeout(l(this,Bi)),g(this,Bi,setTimeout(()=>{g(this,Bi,null),l(this,ur)[0]=l(this,ur)[1]=0,this.addCommands({cmd:()=>{for(const c of o)l(this,ye).has(c.id)&&(c.translateInPage(i,r),c.translationDone())},undo:()=>{for(const c of o)l(this,ye).has(c.id)&&(c.translateInPage(-i,-r),c.translationDone())},mustExec:!1})},a));for(const c of o)c.translateInPage(t,e),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,Ni,new Map);for(const t of l(this,Dt))l(this,Ni).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Ni))return!1;this.disableUserSelect(!1);const t=l(this,Ni);g(this,Ni,null);let e=!1;for(const[{x:i,y:r,pageIndex:o},a]of t)a.newX=i,a.newY=r,a.newPageIndex=o,e||(e=i!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!e)return!1;const s=(i,r,o,a)=>{if(l(this,ye).has(i.id)){const c=l(this,Pe).get(a);c?i._setParentAndPosition(c,r,o):(i.pageIndex=a,i.x=r,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:o,newPageIndex:a}]of t)s(i,r,o,a)},undo:()=>{for(const[i,{savedX:r,savedY:o,savedPageIndex:a}]of t)s(i,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(l(this,Ni))for(const s of l(this,Ni).keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||l(this,Dt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return l(this,ws)===t}getActive(){return l(this,ws)}getMode(){return l(this,_e)}get imageManager(){return _t(this,"imageManager",new bp)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let h=0,u=e.rangeCount;h<u;h++)if(!t.contains(e.getRangeAt(h).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:o}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(h,u,d,f)=>({x:(u-i)/o,y:1-(h+d-s)/r,width:f/o,height:d/r});break;case"180":a=(h,u,d,f)=>({x:1-(h+d-s)/r,y:1-(u+f-i)/o,width:d/r,height:f/o});break;case"270":a=(h,u,d,f)=>({x:1-(u+f-i)/o,y:(h-s)/r,width:f/o,height:d/r});break;default:a=(h,u,d,f)=>({x:(h-s)/r,y:(u-i)/o,width:d/r,height:f/o});break}const c=[];for(let h=0,u=e.rangeCount;h<u;h++){const d=e.getRangeAt(h);if(!d.collapsed)for(const{x:f,y:p,width:m,height:b}of d.getClientRects())m===0||b===0||c.push(a(f,p,m,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:e}){(l(this,Ya)||g(this,Ya,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=l(this,Ya))==null||e.delete(t)}renderAnnotationElement(t){var i;const e=(i=l(this,Ya))==null?void 0:i.get(t.data.id);if(!e)return;const s=l(this,cn).getRawValue(e);s&&(l(this,_e)===dt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,e,s){var r;const i=(r=l(this,cr))==null?void 0:r.get(t);i&&(i.setCanvas(e,s),l(this,cr).delete(t))}addMissingCanvas(t,e){(l(this,cr)||g(this,cr,new Map)).set(t,e)}};qa=new WeakMap,ws=new WeakMap,ye=new WeakMap,Pe=new WeakMap,Xa=new WeakMap,cn=new WeakMap,Ya=new WeakMap,Us=new WeakMap,nr=new WeakMap,oo=new WeakMap,Ka=new WeakMap,ao=new WeakMap,Ni=new WeakMap,oi=new WeakMap,lo=new WeakMap,Jc=new WeakMap,th=new WeakMap,Za=new WeakMap,eh=new WeakMap,Oi=new WeakMap,rr=new WeakMap,Qa=new WeakMap,or=new WeakMap,$i=new WeakMap,Wd=new WeakMap,ar=new WeakMap,sh=new WeakMap,lr=new WeakMap,co=new WeakMap,ho=new WeakMap,cr=new WeakMap,ih=new WeakMap,_e=new WeakMap,Dt=new WeakMap,hn=new WeakMap,hr=new WeakMap,uo=new WeakMap,nh=new WeakMap,rh=new WeakMap,ur=new WeakMap,Bi=new WeakMap,un=new WeakMap,oh=new WeakMap,Vs=new WeakMap,W=new WeakSet,Yu=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},wp=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of l(this,Pe).values())if(s.hasTextLayer(t))return s;return null},Iw=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=w(this,W,Yu).call(this,t).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,$i)||g(this,$i,new GE(this)),l(this,$i).show(s,i,this.direction==="ltr"))},Lw=function(){var r,o,a;const t=document.getSelection();if(!t||t.isCollapsed){l(this,hn)&&((r=l(this,$i))==null||r.hide(),g(this,hn,null),w(this,W,Qe).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===l(this,hn))return;const i=w(this,W,Yu).call(this,t).closest(".textLayer");if(!i){l(this,hn)&&((o=l(this,$i))==null||o.hide(),g(this,hn,null),w(this,W,Qe).call(this,{hasSelectedText:!1}));return}if((a=l(this,$i))==null||a.hide(),g(this,hn,e),w(this,W,Qe).call(this,{hasSelectedText:!0}),!(l(this,_e)!==dt.HIGHLIGHT&&l(this,_e)!==dt.NONE)&&(l(this,_e)===dt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,or,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,_e)===dt.HIGHLIGHT?w(this,W,wp).call(this,i):null;c==null||c.toggleDrawing();const h=new AbortController,u=this.combinedSignal(h),d=f=>{f.type==="pointerup"&&f.button!==0||(h.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&w(this,W,Ku).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}},Ku=function(t=""){l(this,_e)===dt.HIGHLIGHT?this.highlightSelection(t):l(this,Jc)&&w(this,W,Iw).call(this)},Dw=function(){document.addEventListener("selectionchange",w(this,W,Lw).bind(this),{signal:this._signal})},Fw=function(){if(l(this,rr))return;g(this,rr,new AbortController);const t=this.combinedSignal(l(this,rr));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Nw=function(){var t;(t=l(this,rr))==null||t.abort(),g(this,rr,null)},vp=function(){if(l(this,lr))return;g(this,lr,new AbortController);const t=this.combinedSignal(l(this,lr));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},Ow=function(){var t;(t=l(this,lr))==null||t.abort(),g(this,lr,null)},Ap=function(){if(l(this,nr))return;g(this,nr,new AbortController);const t=this.combinedSignal(l(this,nr));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},_p=function(){var t;(t=l(this,nr))==null||t.abort(),g(this,nr,null)},$w=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Qe=function(t){Object.entries(t).some(([s,i])=>l(this,rh)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,rh),t)}),l(this,_e)===dt.HIGHLIGHT&&t.hasSelectedEditor===!1&&w(this,W,nn).call(this,[[St.HIGHLIGHT_FREE,!0]]))},nn=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Bw=async function(){if(!l(this,ar)){g(this,ar,!0);const t=[];for(const e of l(this,Pe).values())t.push(e.enable());await Promise.all(t);for(const e of l(this,ye).values())e.enable()}},Hw=function(){if(this.unselectAll(),l(this,ar)){g(this,ar,!1);for(const t of l(this,Pe).values())t.disable();for(const t of l(this,ye).values())t.disable()}},Sp=function(t){const e=l(this,Pe).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},zw=function(){let t=null;for(t of l(this,Dt));return t},dc=function(){if(l(this,ye).size===0)return!0;if(l(this,ye).size===1)for(const t of l(this,ye).values())return t.isEmpty();return!1},xp=function(t){for(const e of l(this,Dt))e.unselect();l(this,Dt).clear();for(const e of t)e.isEmpty()||(l(this,Dt).add(e),e.select());w(this,W,Qe).call(this,{hasSelectedEditor:this.hasSelection})},U(La,"TRANSLATE_SMALL",1),U(La,"TRANSLATE_BIG",10);let ma=La;var Se,Hi,ai,Ja,zi,vs,tl,Ui,us,dn,fo,Vi,dr,yi,fc,Zu;const Je=class Je{constructor(t){y(this,yi);y(this,Se,null);y(this,Hi,!1);y(this,ai,null);y(this,Ja,null);y(this,zi,null);y(this,vs,null);y(this,tl,!1);y(this,Ui,null);y(this,us,null);y(this,dn,null);y(this,fo,null);y(this,Vi,!1);g(this,us,t),g(this,Vi,t._uiManager.useNewAltTextFlow),l(Je,dr)||g(Je,dr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Je._l10n??(Je._l10n=t)}async render(){const t=g(this,ai,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=g(this,Ja,document.createElement("span"));t.append(e),l(this,Vi)?(t.classList.add("new"),t.setAttribute("data-l10n-id",l(Je,dr).missing),e.setAttribute("data-l10n-id",l(Je,dr)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,us)._uiManager._signal;t.addEventListener("contextmenu",Si,{signal:s}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,us)._uiManager.editAltText(l(this,us)),l(this,Vi)&&l(this,us)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,yi,fc)}})};return t.addEventListener("click",i,{capture:!0,signal:s}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(g(this,tl,!0),i(r))},{signal:s}),await w(this,yi,Zu).call(this),t}finish(){l(this,ai)&&(l(this,ai).focus({focusVisible:l(this,tl)}),g(this,tl,!1))}isEmpty(){return l(this,Vi)?l(this,Se)===null:!l(this,Se)&&!l(this,Hi)}hasData(){return l(this,Vi)?l(this,Se)!==null||!!l(this,dn):this.isEmpty()}get guessedText(){return l(this,dn)}async setGuessedText(t){l(this,Se)===null&&(g(this,dn,t),g(this,fo,await Je._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),w(this,yi,Zu).call(this))}toggleAltTextBadge(t=!1){var e;if(!l(this,Vi)||l(this,Se)){(e=l(this,Ui))==null||e.remove(),g(this,Ui,null);return}if(!l(this,Ui)){const s=g(this,Ui,document.createElement("div"));s.className="noAltTextBadge",l(this,us).div.append(s)}l(this,Ui).classList.toggle("hidden",!t)}serialize(t){let e=l(this,Se);return!t&&l(this,dn)===e&&(e=l(this,fo)),{altText:e,decorative:l(this,Hi),guessedText:l(this,dn),textWithDisclaimer:l(this,fo)}}get data(){return{altText:l(this,Se),decorative:l(this,Hi)}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(g(this,dn,s),g(this,fo,i)),!(l(this,Se)===t&&l(this,Hi)===e)&&(r||(g(this,Se,t),g(this,Hi,e)),w(this,yi,Zu).call(this))}toggle(t=!1){l(this,ai)&&(!t&&l(this,vs)&&(clearTimeout(l(this,vs)),g(this,vs,null)),l(this,ai).disabled=!t)}shown(){l(this,us)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,yi,fc)}})}destroy(){var t,e;(t=l(this,ai))==null||t.remove(),g(this,ai,null),g(this,Ja,null),g(this,zi,null),(e=l(this,Ui))==null||e.remove(),g(this,Ui,null)}};Se=new WeakMap,Hi=new WeakMap,ai=new WeakMap,Ja=new WeakMap,zi=new WeakMap,vs=new WeakMap,tl=new WeakMap,Ui=new WeakMap,us=new WeakMap,dn=new WeakMap,fo=new WeakMap,Vi=new WeakMap,dr=new WeakMap,yi=new WeakSet,fc=function(){return l(this,Se)&&"added"||l(this,Se)===null&&this.guessedText&&"review"||"missing"},Zu=async function(){var i,r,o;const t=l(this,ai);if(!t)return;if(l(this,Vi)){if(t.classList.toggle("done",!!l(this,Se)),t.setAttribute("data-l10n-id",l(Je,dr)[l(this,yi,fc)]),(i=l(this,Ja))==null||i.setAttribute("data-l10n-id",l(Je,dr)[`${l(this,yi,fc)}-label`]),!l(this,Se)){(r=l(this,zi))==null||r.remove();return}}else{if(!l(this,Se)&&!l(this,Hi)){t.classList.remove("done"),(o=l(this,zi))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=l(this,zi);if(!e){g(this,zi,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${l(this,us).id}`;const a=100,c=l(this,us)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,vs)),g(this,vs,null)},{once:!0}),t.addEventListener("mouseenter",()=>{g(this,vs,setTimeout(()=>{g(this,vs,null),l(this,zi).classList.add("show"),l(this,us)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:c}),t.addEventListener("mouseleave",()=>{var h;l(this,vs)&&(clearTimeout(l(this,vs)),g(this,vs,null)),(h=l(this,zi))==null||h.classList.remove("show")},{signal:c})}l(this,Hi)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=l(this,Se)),e.parentNode||t.append(e);const s=l(this,us).getElementForAltText();s==null||s.setAttribute("aria-describedby",e.id)},y(Je,dr,null),U(Je,"_l10n",null);let Fd=Je;var el,po,ah,lh,ch,hh,uh,fn,go,pn,mo,fr,Ur,Uw,Vw,jw;const wm=class wm{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){y(this,Ur);y(this,el);y(this,po,!1);y(this,ah,null);y(this,lh);y(this,ch);y(this,hh);y(this,uh);y(this,fn,null);y(this,go);y(this,pn,null);y(this,mo);y(this,fr,null);g(this,el,t),g(this,ah,s),g(this,lh,e),g(this,ch,i),g(this,hh,r),g(this,uh,o),g(this,mo,new AbortController),g(this,go,AbortSignal.any([a,l(this,mo).signal])),t.addEventListener("touchstart",w(this,Ur,Uw).bind(this),{passive:!1,signal:l(this,go)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Vn.pixelRatio}destroy(){var t,e;(t=l(this,mo))==null||t.abort(),g(this,mo,null),(e=l(this,fn))==null||e.abort(),g(this,fn,null)}};el=new WeakMap,po=new WeakMap,ah=new WeakMap,lh=new WeakMap,ch=new WeakMap,hh=new WeakMap,uh=new WeakMap,fn=new WeakMap,go=new WeakMap,pn=new WeakMap,mo=new WeakMap,fr=new WeakMap,Ur=new WeakSet,Uw=function(t){var i,r,o;if((i=l(this,lh))!=null&&i.call(this))return;if(t.touches.length===1){if(l(this,fn))return;const a=g(this,fn,new AbortController),c=AbortSignal.any([l(this,go),a.signal]),h=l(this,el),u={capture:!0,signal:c,passive:!1},d=f=>{var p;f.pointerType==="touch"&&((p=l(this,fn))==null||p.abort(),g(this,fn,null))};h.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ue(f),d(f))},u),h.addEventListener("pointerup",d,u),h.addEventListener("pointercancel",d,u);return}if(!l(this,fr)){g(this,fr,new AbortController);const a=AbortSignal.any([l(this,go),l(this,fr).signal]),c=l(this,el),h={signal:a,capture:!1,passive:!1};c.addEventListener("touchmove",w(this,Ur,Vw).bind(this),h);const u=w(this,Ur,jw).bind(this);c.addEventListener("touchend",u,h),c.addEventListener("touchcancel",u,h),h.capture=!0,c.addEventListener("pointerdown",ue,h),c.addEventListener("pointermove",ue,h),c.addEventListener("pointercancel",ue,h),c.addEventListener("pointerup",ue,h),(r=l(this,ch))==null||r.call(this)}if(ue(t),t.touches.length!==2||(o=l(this,ah))!=null&&o.call(this)){g(this,pn,null);return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),g(this,pn,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY})},Vw=function(t){var S;if(!l(this,pn)||t.touches.length!==2)return;ue(t);let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:i,screenY:r}=e,{screenX:o,screenY:a}=s,c=l(this,pn),{touch0X:h,touch0Y:u,touch1X:d,touch1Y:f}=c,p=d-h,m=f-u,b=o-i,A=a-r,v=Math.hypot(b,A)||1,_=Math.hypot(p,m)||1;if(!l(this,po)&&Math.abs(_-v)<=wm.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=o,c.touch1Y=a,!l(this,po)){g(this,po,!0);return}const x=[(i+o)/2,(r+a)/2];(S=l(this,hh))==null||S.call(this,x,_,v)},jw=function(t){var e;t.touches.length>=2||(l(this,fr).abort(),g(this,fr,null),(e=l(this,uh))==null||e.call(this),l(this,pn)&&(ue(t),g(this,pn,null),g(this,po,!1)))};let Nd=wm;var bo,li,qt,sl,pr,dh,yo,Me,wo,gn,gr,fh,vo,As,ph,Ao,mn,ji,il,nl,js,_o,gh,qd,ot,Ep,mh,Cp,Qu,Gw,Ww,Tp,Ju,kp,qw,Xw,Yw,Rp,Kw,Pp,Zw,Qw,Jw,Mp,pc;const wt=class wt{constructor(t){y(this,ot);y(this,bo,null);y(this,li,null);y(this,qt,null);y(this,sl,!1);y(this,pr,null);y(this,dh,"");y(this,yo,!1);y(this,Me,null);y(this,wo,null);y(this,gn,null);y(this,gr,null);y(this,fh,"");y(this,vo,!1);y(this,As,null);y(this,ph,!1);y(this,Ao,!1);y(this,mn,!1);y(this,ji,null);y(this,il,0);y(this,nl,0);y(this,js,null);y(this,_o,null);U(this,"_isCopy",!1);U(this,"_editToolbar",null);U(this,"_initialOptions",Object.create(null));U(this,"_initialData",null);U(this,"_isVisible",!0);U(this,"_uiManager",null);U(this,"_focusEventsAllowed",!0);y(this,gh,!1);y(this,qd,wt._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,o];const[a,c]=this.parentDimensions;this.x=t.x/a,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=wt.prototype._resizeWithKeyboard,e=ma.TRANSLATE_SMALL,s=ma.TRANSLATE_BIG;return _t(this,"_resizerKeyboardManager",new _u([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],wt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return _t(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new XE({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(wt._l10n??(wt._l10n=t),wt._l10nResizer||(wt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),wt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);wt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){$t("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,gh)}set _isDraggable(t){var e;g(this,gh,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,qd)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):w(this,ot,pc).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(l(this,vo)?g(this,vo,!1):this.parent.setSelected(this))}focusout(t){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,i){const[r,o]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(t+s)/r,this.y=(e+i)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[s,i]=this.parentDimensions;this.setAt(t*s,e*i,this.width*s,this.height*i),this._onTranslated()}translate(t,e){w(this,ot,Ep).call(this,this.parentDimensions,t,e)}translateInPage(t,e){l(this,As)||g(this,As,[this.x,this.y,this.width,this.height]),w(this,ot,Ep).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){l(this,As)||g(this,As,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=t/i,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[c,h]=this.getBaseTranslation();o+=c,a+=h;const{style:u}=s;u.left=`${(100*o).toFixed(2)}%`,u.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!l(this,As)&&(l(this,As)[0]!==this.x||l(this,As)[1]!==this.y)}get _hasBeenResized(){return!!l(this,As)&&(l(this,As)[2]!==this.width||l(this,As)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=wt,i=s/t,r=s/e;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,i]}=this;let{x:r,y:o,width:a,height:c}=this;if(a*=s,c*=i,r*=s,o*=i,this._mustFixPosition)switch(t){case 0:r=Ds(r,0,s-a),o=Ds(o,0,i-c);break;case 90:r=Ds(r,0,s-c),o=Ds(o,a,i);break;case 180:r=Ds(r,a,s),o=Ds(o,c,i);break;case 270:r=Ds(r,c,s),o=Ds(o,0,i-a);break}this.x=r/=s,this.y=o/=i;const[h,u]=this.getBaseTranslation();r+=h,o+=u,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var s;return w(s=wt,mh,Cp).call(s,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var s;return w(s=wt,mh,Cp).call(s,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(t,e){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*t/s).toFixed(2)}%`,l(this,yo)||(r.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:s}=t,i=s.endsWith("%"),r=!l(this,yo)&&e.endsWith("%");if(i&&r)return;const[o,a]=this.parentDimensions;i||(t.width=`${(100*parseFloat(s)/o).toFixed(2)}%`),!l(this,yo)&&!r&&(t.height=`${(100*parseFloat(e)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=l(this,qt))==null||t.finish()}async addEditToolbar(){return this._editToolbar||l(this,Ao)?this._editToolbar:(this._editToolbar=new mp(this),this.div.append(this._editToolbar.render()),l(this,qt)&&await this._editToolbar.addAltText(l(this,qt)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=l(this,qt))==null||t.destroy())}addContainer(t){var s;const e=(s=this._editToolbar)==null?void 0:s.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,qt)||(Fd.initialize(wt._l10n),g(this,qt,new Fd(this)),l(this,bo)&&(l(this,qt).data=l(this,bo),g(this,bo,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=l(this,qt))==null?void 0:t.data}set altTextData(t){l(this,qt)&&(l(this,qt).data=t)}get guessedAltText(){var t;return(t=l(this,qt))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=l(this,qt))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=l(this,qt))==null?void 0:e.serialize(t)}hasAltText(){return!!l(this,qt)&&!l(this,qt).isEmpty()}hasAltTextData(){var t;return((t=l(this,qt))==null?void 0:t.hasData())??!1}render(){var o;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=l(this,sl)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),w(this,ot,Pp).call(this);const[e,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),um(this,t,["keydown","pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,_o)||g(this,_o,new Nd({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:w(this,ot,qw).bind(this),onPinching:w(this,ot,Xw).bind(this),onPinchEnd:w(this,ot,Yw).bind(this),signal:this._uiManager._signal}))),(o=this._uiManager._editorUndoBar)==null||o.hide(),t}pointerdown(t){const{isMac:e}=$e.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(g(this,vo,!0),this._isDraggable){w(this,ot,Kw).call(this,t);return}w(this,ot,Rp).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,ji)&&clearTimeout(l(this,ji)),g(this,ji,setTimeout(()=>{var t;g(this,ji,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const i=this.parentScale,[r,o]=this.pageDimensions,[a,c]=this.pageTranslation,h=t/i,u=e/i,d=this.x*r,f=this.y*o,p=this.width*r,m=this.height*o;switch(s){case 0:return[d+h+a,o-f-u-m+c,d+h+p+a,o-f-u+c];case 90:return[d+u+a,o-f+h+c,d+u+m+a,o-f+h+p+c];case 180:return[d-h-p+a,o-f+u+c,d-h+a,o-f+u+m+c];case 270:return[d-u-m+a,o-f-h-p+c,d-u+a,o-f-h+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,i,r,o]=t,a=r-s,c=o-i;switch(this.rotation){case 0:return[s,e-o,a,c];case 90:return[s,e-i,c,a];case 180:return[r,e-i,a,c];case 270:return[r,e-o,c,a];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){g(this,Ao,!0)}disableEditMode(){g(this,Ao,!1)}isInEditMode(){return l(this,Ao)}shouldGetKeyboardEvents(){return l(this,mn)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return e<o&&i>0&&t<r&&s>0}rebuild(){w(this,ot,Pp).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){$t("An editor must be serializable")}static async deserialize(t,e,s){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s});i.rotation=t.rotation,g(i,bo,t.accessibilityData),i._isCopy=t.isCopy||!1;const[r,o]=i.pageDimensions,[a,c,h,u]=i.getRectInCurrentCoords(t.rect,o);return i.x=a/r,i.y=c/o,i.width=h/r,i.height=u/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=l(this,gr))==null||t.abort(),g(this,gr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,ji)&&(clearTimeout(l(this,ji)),g(this,ji,null)),w(this,ot,pc).call(this),this.removeEditToolbar(),l(this,js)){for(const s of l(this,js).values())clearTimeout(s);g(this,js,null)}this.parent=null,(e=l(this,_o))==null||e.destroy(),g(this,_o,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(w(this,ot,Gw).call(this),l(this,Me).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),g(this,gn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=l(this,Me).children;if(!l(this,li)){g(this,li,Array.from(e));const o=w(this,ot,Zw).bind(this),a=w(this,ot,Qw).bind(this),c=this._uiManager._signal;for(const h of l(this,li)){const u=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:c}),h.addEventListener("blur",a,{signal:c}),h.addEventListener("focus",w(this,ot,Jw).bind(this,u),{signal:c}),h.setAttribute("data-l10n-id",wt._l10nResizer[u])}}const s=l(this,li)[0];let i=0;for(const o of e){if(o===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,li).length/4);if(r!==i){if(r<i)for(let a=0;a<i-r;a++)l(this,Me).append(l(this,Me).firstChild);else if(r>i)for(let a=0;a<r-i;a++)l(this,Me).firstChild.before(l(this,Me).lastChild);let o=0;for(const a of e){const h=l(this,li)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",wt._l10nResizer[h])}}w(this,ot,Mp).call(this,0),g(this,mn,!0),l(this,Me).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){l(this,mn)&&w(this,ot,kp).call(this,l(this,fh),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){w(this,ot,pc).call(this),this.div.focus()}select(){var t,e,s;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(e=this._editToolbar)==null||e.show(),(s=l(this,qt))==null||s.toggleAltTextBadge(!1)}unselect(){var t,e,s,i,r;(t=l(this,Me))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,qt))==null||r.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return l(this,ph)}set isEditing(t){g(this,ph,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){g(this,yo,!0);const s=t/e,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){l(this,js)||g(this,js,new Map);const{action:s}=t;let i=l(this,js).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),l(this,js).delete(s),l(this,js).size===0&&g(this,js,null)},wt._telemetryTimeout),l(this,js).set(s,i);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),g(this,sl,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,sl,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};bo=new WeakMap,li=new WeakMap,qt=new WeakMap,sl=new WeakMap,pr=new WeakMap,dh=new WeakMap,yo=new WeakMap,Me=new WeakMap,wo=new WeakMap,gn=new WeakMap,gr=new WeakMap,fh=new WeakMap,vo=new WeakMap,As=new WeakMap,ph=new WeakMap,Ao=new WeakMap,mn=new WeakMap,ji=new WeakMap,il=new WeakMap,nl=new WeakMap,js=new WeakMap,_o=new WeakMap,gh=new WeakMap,qd=new WeakMap,ot=new WeakSet,Ep=function([t,e],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},mh=new WeakSet,Cp=function(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},Qu=function(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}},Gw=function(){if(l(this,Me))return;g(this,Me,document.createElement("div")),l(this,Me).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const i=document.createElement("div");l(this,Me).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",w(this,ot,Ww).bind(this,s),{signal:e}),i.addEventListener("contextmenu",Si,{signal:e}),i.tabIndex=-1}this.div.prepend(l(this,Me))},Ww=function(t,e){var u;e.preventDefault();const{isMac:s}=$e.platform;if(e.button!==0||e.ctrlKey&&s)return;(u=l(this,qt))==null||u.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,g(this,wo,[e.screenX,e.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",w(this,ot,kp).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",ue,{passive:!1,signal:o}),window.addEventListener("contextmenu",Si,{signal:o}),g(this,gn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const h=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=l(this,qt))==null||d.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=c,w(this,ot,Ju).call(this)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})},Tp=function(t,e,s,i){this.width=s,this.height=i,this.x=t,this.y=e;const[r,o]=this.parentDimensions;this.setDims(r*s,o*i),this.fixAndSetPosition(),this._onResized()},Ju=function(){if(!l(this,gn))return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:i}=l(this,gn);g(this,gn,null);const r=this.x,o=this.y,a=this.width,c=this.height;r===t&&o===e&&a===s&&c===i||this.addCommands({cmd:w(this,ot,Tp).bind(this,r,o,a,c),undo:w(this,ot,Tp).bind(this,t,e,s,i),mustExec:!0})},kp=function(t,e){const[s,i]=this.parentDimensions,r=this.x,o=this.y,a=this.width,c=this.height,h=wt.MIN_SIZE/s,u=wt.MIN_SIZE/i,d=w(this,ot,Qu).call(this,this.rotation),f=(z,G)=>[d[0]*z+d[2]*G,d[1]*z+d[3]*G],p=w(this,ot,Qu).call(this,360-this.rotation),m=(z,G)=>[p[0]*z+p[2]*G,p[1]*z+p[3]*G];let b,A,v=!1,_=!1;switch(t){case"topLeft":v=!0,b=(z,G)=>[0,0],A=(z,G)=>[z,G];break;case"topMiddle":b=(z,G)=>[z/2,0],A=(z,G)=>[z/2,G];break;case"topRight":v=!0,b=(z,G)=>[z,0],A=(z,G)=>[0,G];break;case"middleRight":_=!0,b=(z,G)=>[z,G/2],A=(z,G)=>[0,G/2];break;case"bottomRight":v=!0,b=(z,G)=>[z,G],A=(z,G)=>[0,0];break;case"bottomMiddle":b=(z,G)=>[z/2,G],A=(z,G)=>[z/2,0];break;case"bottomLeft":v=!0,b=(z,G)=>[0,G],A=(z,G)=>[z,0];break;case"middleLeft":_=!0,b=(z,G)=>[0,G/2],A=(z,G)=>[z,G/2];break}const x=b(a,c),S=A(a,c);let C=f(...S);const T=wt._round(r+C[0]),R=wt._round(o+C[1]);let L=1,P=1,F,N;if(e.fromKeyboard)({deltaX:F,deltaY:N}=e);else{const{screenX:z,screenY:G}=e,[Y,lt]=l(this,wo);[F,N]=this.screenToPageTranslation(z-Y,G-lt),l(this,wo)[0]=z,l(this,wo)[1]=G}if([F,N]=m(F/s,N/i),v){const z=Math.hypot(a,c);L=P=Math.max(Math.min(Math.hypot(S[0]-x[0]-F,S[1]-x[1]-N)/z,1/a,1/c),h/a,u/c)}else _?L=Math.max(h,Math.min(1,Math.abs(S[0]-x[0]-F)))/a:P=Math.max(u,Math.min(1,Math.abs(S[1]-x[1]-N)))/c;const D=wt._round(a*L),tt=wt._round(c*P);C=f(...A(D,tt));const nt=T-C[0],Nt=R-C[1];l(this,As)||g(this,As,[this.x,this.y,this.width,this.height]),this.width=D,this.height=tt,this.x=nt,this.y=Nt,this.setDims(s*D,i*tt),this.fixAndSetPosition(),this._onResizing()},qw=function(){var t;g(this,gn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=l(this,qt))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},Xw=function(t,e,s){let r=.7*(s/e)+1-.7;if(r===1)return;const o=w(this,ot,Qu).call(this,this.rotation),a=(T,R)=>[o[0]*T+o[2]*R,o[1]*T+o[3]*R],[c,h]=this.parentDimensions,u=this.x,d=this.y,f=this.width,p=this.height,m=wt.MIN_SIZE/c,b=wt.MIN_SIZE/h;r=Math.max(Math.min(r,1/f,1/p),m/f,b/p);const A=wt._round(f*r),v=wt._round(p*r);if(A===f&&v===p)return;l(this,As)||g(this,As,[u,d,f,p]);const _=a(f/2,p/2),x=wt._round(u+_[0]),S=wt._round(d+_[1]),C=a(A/2,v/2);this.x=x-C[0],this.y=S-C[1],this.width=A,this.height=v,this.setDims(c*A,h*v),this.fixAndSetPosition(),this._onResizing()},Yw=function(){var t;(t=l(this,qt))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),w(this,ot,Ju).call(this)},Rp=function(t){const{isMac:e}=$e.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Kw=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:r},a=h=>{i.abort(),g(this,pr,null),g(this,vo,!1),this._uiManager.endDragSession()||w(this,ot,Rp).call(this,h),s&&this._onStopDragging()};e&&(g(this,il,t.clientX),g(this,nl,t.clientY),g(this,pr,t.pointerId),g(this,dh,t.pointerType),window.addEventListener("pointermove",h=>{s||(s=!0,this._onStartDragging());const{clientX:u,clientY:d,pointerId:f}=h;if(f!==l(this,pr)){ue(h);return}const[p,m]=this.screenToPageTranslation(u-l(this,il),d-l(this,nl));g(this,il,u),g(this,nl,d),this._uiManager.dragSelectedEditors(p,m)},o),window.addEventListener("touchmove",ue,o),window.addEventListener("pointerdown",h=>{h.pointerType===l(this,dh)&&(l(this,_o)||h.isPrimary)&&a(h),ue(h)},o));const c=h=>{if(!l(this,pr)||l(this,pr)===h.pointerId){a(h);return}ue(h)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},Pp=function(){if(l(this,gr)||!this.div)return;g(this,gr,new AbortController);const t=this._uiManager.combinedSignal(l(this,gr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Zw=function(t){wt._resizerKeyboardManager.exec(this,t)},Qw=function(t){var e;l(this,mn)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==l(this,Me)&&w(this,ot,pc).call(this)},Jw=function(t){g(this,fh,l(this,mn)?t:"")},Mp=function(t){if(l(this,li))for(const e of l(this,li))e.tabIndex=t},pc=function(){g(this,mn,!1),w(this,ot,Mp).call(this,-1),w(this,ot,Ju).call(this)},y(wt,mh),U(wt,"_l10n",null),U(wt,"_l10nResizer",null),U(wt,"_borderLineWidth",-1),U(wt,"_colorManager",new yp),U(wt,"_zIndex",1),U(wt,"_telemetryTimeout",1e3);let te=wt;class XE extends te{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const vb=3285377520,Hs=4294901760,Mi=65535;class tv{constructor(t){this.h1=t?t&4294967295:vb,this.h2=t?t&4294967295:vb}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let b=0,A=t.length;b<A;b++){const v=t.charCodeAt(b);v<=255?e[s++]=v:(e[s++]=v>>>8,e[s++]=v&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,o=new Uint32Array(e.buffer,0,i);let a=0,c=0,h=this.h1,u=this.h2;const d=3432918353,f=461845907,p=d&Mi,m=f&Mi;for(let b=0;b<i;b++)b&1?(a=o[b],a=a*d&Hs|a*p&Mi,a=a<<15|a>>>17,a=a*f&Hs|a*m&Mi,h^=a,h=h<<13|h>>>19,h=h*5+3864292196):(c=o[b],c=c*d&Hs|c*p&Mi,c=c<<15|c>>>17,c=c*f&Hs|c*m&Mi,u^=c,u=u<<13|u>>>19,u=u*5+3864292196);switch(a=0,r){case 3:a^=e[i*4+2]<<16;case 2:a^=e[i*4+1]<<8;case 1:a^=e[i*4],a=a*d&Hs|a*p&Mi,a=a<<15|a>>>17,a=a*f&Hs|a*m&Mi,i&1?h^=a:u^=a}this.h1=h,this.h2=u}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Hs|t*36045&Mi,e=e*4283543511&Hs|((e<<16|t>>>16)*2950163797&Hs)>>>16,t^=e>>>1,t=t*444984403&Hs|t*60499&Mi,e=e*3301882366&Hs|((e<<16|t>>>16)*3120437893&Hs)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Ip=Object.freeze({map:null,hash:"",transfer:void 0});var So,xo,xe,Xd,ev;class dm{constructor(){y(this,Xd);y(this,So,!1);y(this,xo,null);y(this,xe,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=l(this,xe).get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return l(this,xe).get(t)}remove(t){if(l(this,xe).delete(t),l(this,xe).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of l(this,xe).values())if(e instanceof te)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=l(this,xe).get(t);let i=!1;if(s!==void 0)for(const[r,o]of Object.entries(e))s[r]!==o&&(i=!0,s[r]=o);else i=!0,l(this,xe).set(t,e);i&&w(this,Xd,ev).call(this),e instanceof te&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return l(this,xe).has(t)}getAll(){return l(this,xe).size>0?rm(l(this,xe)):null}setAll(t){for(const[e,s]of Object.entries(t))this.setValue(e,s)}get size(){return l(this,xe).size}resetModified(){l(this,So)&&(g(this,So,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new sv(this)}get serializable(){if(l(this,xe).size===0)return Ip;const t=new Map,e=new tv,s=[],i=Object.create(null);let r=!1;for(const[o,a]of l(this,xe)){const c=a instanceof te?a.serialize(!1,i):a;c&&(t.set(o,c),e.update(`${o}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const o of t.values())o.bitmap&&s.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:Ip}get editorStats(){let t=null;const e=new Map;for(const s of l(this,xe).values()){if(!(s instanceof te))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;e.has(r)||e.set(r,Object.getPrototypeOf(s).constructor),t||(t=Object.create(null));const o=t[r]||(t[r]=new Map);for(const[a,c]of Object.entries(i)){if(a==="type")continue;let h=o.get(a);h||(h=new Map,o.set(a,h));const u=h.get(c)??0;h.set(c,u+1)}}for(const[s,i]of e)t[s]=i.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){g(this,xo,null)}get modifiedIds(){if(l(this,xo))return l(this,xo);const t=[];for(const e of l(this,xe).values())!(e instanceof te)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return g(this,xo,{ids:new Set(t),hash:t.join(",")})}}So=new WeakMap,xo=new WeakMap,xe=new WeakMap,Xd=new WeakSet,ev=function(){l(this,So)||(g(this,So,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var bh;class sv extends dm{constructor(e){super();y(this,bh);const{map:s,hash:i,transfer:r}=e.serializable,o=structuredClone(s,r?{transfer:r}:null);g(this,bh,{map:o,hash:i,transfer:r})}get print(){$t("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,bh)}get modifiedIds(){return _t(this,"modifiedIds",{ids:new Set,hash:""})}}bh=new WeakMap;var rl;class YE{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){y(this,rl,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),l(this,rl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:s}){if(!(!t||l(this,rl).has(t.loadedName))){if(fe(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:o}=t,a=new FontFace(i,r,o);this.addNativeFontFace(a);try{await a.load(),l(this,rl).add(i),s==null||s(t)}catch{gt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}$t("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw gt(`Failed to load font '${s.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return _t(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return _t(this,"isSyncFontLoadingSupported",De||$e.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(fe(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:e,callback:t};return s.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return _t(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(S,C){return S.charCodeAt(C)<<24|S.charCodeAt(C+1)<<16|S.charCodeAt(C+2)<<8|S.charCodeAt(C+3)&255}function i(S,C,T,R){const L=S.substring(0,C),P=S.substring(C+T);return L+R+P}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const c=a.getContext("2d");let h=0;function u(S,C){if(++h>30){gt("Load test font never loaded."),C();return}if(c.font="30px "+S,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(u.bind(null,S,C))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,d.length,d);const m=16,b=1482184792;let A=s(f,m);for(r=0,o=d.length-3;r<o;r+=4)A=A-b+s(d,r)|0;r<d.length&&(A=A-b+s(d+"XXX",r)|0),f=i(f,m,4,DE(A));const v=`url(data:font/opentype;base64,${btoa(f)});`,_=`@font-face {font-family:"${d}";src:${v}}`;this.insertRule(_);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const S of[t.loadedName,d]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=S,x.append(C)}this._document.body.append(x),u(d,()=>{x.remove(),e.complete()})}}rl=new WeakMap;class KE{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this._inspectFont=e}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Sw(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return(s=this._inspectFont)==null||s.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let i;try{i=t.get(s)}catch(o){gt(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=r}}const Du={DATA:1,ERROR:2},ce={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ab(){}function cs(n){if(n instanceof Br||n instanceof fp||n instanceof bb||n instanceof Dd||n instanceof Gf)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||$t('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Br(n.message);case"InvalidPDFException":return new fp(n.message);case"PasswordException":return new bb(n.message,n.code);case"ResponseException":return new Dd(n.message,n.status,n.missing);case"UnknownErrorException":return new Gf(n.message,n.details)}return new Gf(n.message,n.toString())}var ol,ei,iv,nv,rv,td;class gc{constructor(t,e,s){y(this,ei);y(this,ol,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",w(this,ei,iv).bind(this),{signal:l(this,ol).signal})}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},s)}catch(o){r.reject(o)}return r.promise}sendWithStream(t,e,s,i){const r=this.streamId++,o=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:h=>{const u=Promise.withResolvers();return this.streamControllers[r]={controller:h,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:a,action:t,streamId:r,data:e,desiredSize:h.desiredSize},i),u.promise},pull:h=>{const u=Promise.withResolvers();return this.streamControllers[r].pullCall=u,c.postMessage({sourceName:o,targetName:a,stream:ce.PULL,streamId:r,desiredSize:h.desiredSize}),u.promise},cancel:h=>{fe(h instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[r].cancelCall=u,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:o,targetName:a,stream:ce.CANCEL,streamId:r,reason:cs(h)}),u.promise}},s)}destroy(){var t;(t=l(this,ol))==null||t.abort(),g(this,ol,null)}}ol=new WeakMap,ei=new WeakSet,iv=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){w(this,ei,rv).call(this,t);return}if(t.callback){const s=t.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===Du.DATA)i.resolve(t.data);else if(t.callback===Du.ERROR)i.reject(cs(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,i=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(o){r.postMessage({sourceName:s,targetName:i,callback:Du.DATA,callbackId:t.callbackId,data:o})},function(o){r.postMessage({sourceName:s,targetName:i,callback:Du.ERROR,callbackId:t.callbackId,reason:cs(o)})});return}if(t.streamId){w(this,ei,nv).call(this,t);return}e(t.data)},nv=function(t){const e=t.streamId,s=this.sourceName,i=t.sourceName,r=this.comObj,o=this,a=this.actionHandler[t.action],c={enqueue(h,u=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=u,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:ce.ENQUEUE,streamId:e,chunk:h},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:ce.CLOSE,streamId:e}),delete o.streamSinks[e])},error(h){fe(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:ce.ERROR,streamId:e,reason:cs(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,Promise.try(a,t.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:ce.START_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:s,targetName:i,stream:ce.START_COMPLETE,streamId:e,reason:cs(h)})})},rv=function(t){const e=t.streamId,s=this.sourceName,i=t.sourceName,r=this.comObj,o=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case ce.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(cs(t.reason));break;case ce.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(cs(t.reason));break;case ce.PULL:if(!a){r.postMessage({sourceName:s,targetName:i,stream:ce.PULL_COMPLETE,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,Promise.try(a.onPull||Ab).then(function(){r.postMessage({sourceName:s,targetName:i,stream:ce.PULL_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:s,targetName:i,stream:ce.PULL_COMPLETE,streamId:e,reason:cs(h)})});break;case ce.ENQUEUE:if(fe(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case ce.CLOSE:if(fe(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),w(this,ei,td).call(this,o,e);break;case ce.ERROR:fe(o,"error should have stream controller"),o.controller.error(cs(t.reason)),w(this,ei,td).call(this,o,e);break;case ce.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(cs(t.reason)),w(this,ei,td).call(this,o,e);break;case ce.CANCEL:if(!a)break;const c=cs(t.reason);Promise.try(a.onCancel||Ab,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:ce.CANCEL_COMPLETE,streamId:e,success:!0})},function(h){r.postMessage({sourceName:s,targetName:i,stream:ce.CANCEL_COMPLETE,streamId:e,reason:cs(h)})}),a.sinkCapability.reject(c),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},td=async function(t,e){var s,i,r;await Promise.allSettled([(s=t.startCall)==null?void 0:s.promise,(i=t.pullCall)==null?void 0:i.promise,(r=t.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[e]};var yh;class ov{constructor({enableHWA:t=!1}){y(this,yh,!1);g(this,yh,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,yh)})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){$t("Abstract method `_createCanvas` called.")}}yh=new WeakMap;class ZE extends ov{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class av{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){$t("Abstract method `_fetch` called.")}}class _b extends av{async _fetch(t){const e=await vu(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):wu(e)}}class lv{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,i,r){return"none"}destroy(t=!1){}}var Eo,al,bn,yn,Ve,Co,To,Z,ze,mc,Ta,ed,ka,cv,Lp,Ra,bc,yc,Dp,wc;class QE extends lv{constructor({docId:e,ownerDocument:s=globalThis.document}){super();y(this,Z);y(this,Eo);y(this,al);y(this,bn);y(this,yn);y(this,Ve);y(this,Co);y(this,To,0);g(this,yn,e),g(this,Ve,s)}addFilter(e){if(!e)return"none";let s=l(this,Z,ze).get(e);if(s)return s;const[i,r,o]=w(this,Z,ed).call(this,e),a=e.length===1?i:`${i}${r}${o}`;if(s=l(this,Z,ze).get(a),s)return l(this,Z,ze).set(e,s),s;const c=`g_${l(this,yn)}_transfer_map_${Ke(this,To)._++}`,h=w(this,Z,ka).call(this,c);l(this,Z,ze).set(e,h),l(this,Z,ze).set(a,h);const u=w(this,Z,Ra).call(this,c);return w(this,Z,yc).call(this,i,r,o,u),h}addHCMFilter(e,s){var m;const i=`${e}-${s}`,r="base";let o=l(this,Z,mc).get(r);if((o==null?void 0:o.key)===i||(o?((m=o.filter)==null||m.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},l(this,Z,mc).set(r,o)),!e||!s))return o.url;const a=w(this,Z,wc).call(this,e);e=st.makeHexColor(...a);const c=w(this,Z,wc).call(this,s);if(s=st.makeHexColor(...c),l(this,Z,Ta).style.color="",e==="#000000"&&s==="#ffffff"||e===s)return o.url;const h=new Array(256);for(let b=0;b<=255;b++){const A=b/255;h[b]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const u=h.join(","),d=`g_${l(this,yn)}_hcm_filter`,f=o.filter=w(this,Z,Ra).call(this,d);w(this,Z,yc).call(this,u,u,u,f),w(this,Z,Lp).call(this,f);const p=(b,A)=>{const v=a[b]/255,_=c[b]/255,x=new Array(A+1);for(let S=0;S<=A;S++)x[S]=v+S/A*(_-v);return x.join(",")};return w(this,Z,yc).call(this,p(0,5),p(1,5),p(2,5),f),o.url=w(this,Z,ka).call(this,d),o.url}addAlphaFilter(e){let s=l(this,Z,ze).get(e);if(s)return s;const[i]=w(this,Z,ed).call(this,[e]),r=`alpha_${i}`;if(s=l(this,Z,ze).get(r),s)return l(this,Z,ze).set(e,s),s;const o=`g_${l(this,yn)}_alpha_map_${Ke(this,To)._++}`,a=w(this,Z,ka).call(this,o);l(this,Z,ze).set(e,a),l(this,Z,ze).set(r,a);const c=w(this,Z,Ra).call(this,o);return w(this,Z,Dp).call(this,i,c),a}addLuminosityFilter(e){let s=l(this,Z,ze).get(e||"luminosity");if(s)return s;let i,r;if(e?([i]=w(this,Z,ed).call(this,[e]),r=`luminosity_${i}`):r="luminosity",s=l(this,Z,ze).get(r),s)return l(this,Z,ze).set(e,s),s;const o=`g_${l(this,yn)}_luminosity_map_${Ke(this,To)._++}`,a=w(this,Z,ka).call(this,o);l(this,Z,ze).set(e,a),l(this,Z,ze).set(r,a);const c=w(this,Z,Ra).call(this,o);return w(this,Z,cv).call(this,c),e&&w(this,Z,Dp).call(this,i,c),a}addHighlightHCMFilter(e,s,i,r,o){var _;const a=`${s}-${i}-${r}-${o}`;let c=l(this,Z,mc).get(e);if((c==null?void 0:c.key)===a||(c?((_=c.filter)==null||_.remove(),c.key=a,c.url="none",c.filter=null):(c={key:a,url:"none",filter:null},l(this,Z,mc).set(e,c)),!s||!i))return c.url;const[h,u]=[s,i].map(w(this,Z,wc).bind(this));let d=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[p,m]=[r,o].map(w(this,Z,wc).bind(this));f<d&&([d,f,p,m]=[f,d,m,p]),l(this,Z,Ta).style.color="";const b=(x,S,C)=>{const T=new Array(256),R=(f-d)/C,L=x/255,P=(S-x)/(255*C);let F=0;for(let N=0;N<=C;N++){const D=Math.round(d+N*R),tt=L+N*P;for(let nt=F;nt<=D;nt++)T[nt]=tt;F=D+1}for(let N=F;N<256;N++)T[N]=T[F-1];return T.join(",")},A=`g_${l(this,yn)}_hcm_${e}_filter`,v=c.filter=w(this,Z,Ra).call(this,A);return w(this,Z,Lp).call(this,v),w(this,Z,yc).call(this,b(p[0],m[0],5),b(p[1],m[1],5),b(p[2],m[2],5),v),c.url=w(this,Z,ka).call(this,A),c.url}destroy(e=!1){var s,i,r,o;e&&((s=l(this,Co))!=null&&s.size)||((i=l(this,bn))==null||i.parentNode.parentNode.remove(),g(this,bn,null),(r=l(this,al))==null||r.clear(),g(this,al,null),(o=l(this,Co))==null||o.clear(),g(this,Co,null),g(this,To,0))}}Eo=new WeakMap,al=new WeakMap,bn=new WeakMap,yn=new WeakMap,Ve=new WeakMap,Co=new WeakMap,To=new WeakMap,Z=new WeakSet,ze=function(){return l(this,al)||g(this,al,new Map)},mc=function(){return l(this,Co)||g(this,Co,new Map)},Ta=function(){if(!l(this,bn)){const e=l(this,Ve).createElement("div"),{style:s}=e;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Ve).createElementNS(sn,"svg");i.setAttribute("width",0),i.setAttribute("height",0),g(this,bn,l(this,Ve).createElementNS(sn,"defs")),e.append(i),i.append(l(this,bn)),l(this,Ve).body.append(e)}return l(this,bn)},ed=function(e){if(e.length===1){const h=e[0],u=new Array(256);for(let f=0;f<256;f++)u[f]=h[f]/255;const d=u.join(",");return[d,d,d]}const[s,i,r]=e,o=new Array(256),a=new Array(256),c=new Array(256);for(let h=0;h<256;h++)o[h]=s[h]/255,a[h]=i[h]/255,c[h]=r[h]/255;return[o.join(","),a.join(","),c.join(",")]},ka=function(e){if(l(this,Eo)===void 0){g(this,Eo,"");const s=l(this,Ve).URL;s!==l(this,Ve).baseURI&&(Tf(s)?gt('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,Eo,s.split("#",1)[0]))}return`url(${l(this,Eo)}#${e})`},cv=function(e){const s=l(this,Ve).createElementNS(sn,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(s)},Lp=function(e){const s=l(this,Ve).createElementNS(sn,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(s)},Ra=function(e){const s=l(this,Ve).createElementNS(sn,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",e),l(this,Z,Ta).append(s),s},bc=function(e,s,i){const r=l(this,Ve).createElementNS(sn,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),e.append(r)},yc=function(e,s,i,r){const o=l(this,Ve).createElementNS(sn,"feComponentTransfer");r.append(o),w(this,Z,bc).call(this,o,"feFuncR",e),w(this,Z,bc).call(this,o,"feFuncG",s),w(this,Z,bc).call(this,o,"feFuncB",i)},Dp=function(e,s){const i=l(this,Ve).createElementNS(sn,"feComponentTransfer");s.append(i),w(this,Z,bc).call(this,i,"feFuncA",e)},wc=function(e){return l(this,Z,Ta).style.color=e,hm(getComputedStyle(l(this,Z,Ta)).getPropertyValue("color"))};class hv{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){$t("Abstract method `_fetch` called.")}}class Sb extends hv{async _fetch(t){const e=await vu(t,"arraybuffer");return new Uint8Array(e)}}class uv{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){$t("Abstract method `_fetch` called.")}}class xb extends uv{async _fetch(t){const e=await vu(t,"arraybuffer");return new Uint8Array(e)}}De&&gt("Please use the `legacy` build in Node.js environments.");async function fm(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class JE extends lv{}class t1 extends ov{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class e1 extends av{async _fetch(t){return fm(t)}}class s1 extends hv{async _fetch(t){return fm(t)}}class i1 extends uv{async _fetch(t){return fm(t)}}const We={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Fp(n,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,s),n.clip(i)}class pm{getPattern(){$t("Abstract method `getPattern` called.")}}class n1 extends pm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,i){let r;if(i===We.STROKE||i===We.FILL){const o=e.current.getClippedPathBoundingBox(i,Qt(t))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,h=e.cachedCanvases.getCanvas("pattern",a,c),u=h.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-o[0],-o[1]),s=st.transform(s,[1,0,0,1,o[0],o[1]]),u.transform(...e.baseTransform),this.matrix&&u.transform(...this.matrix),Fp(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),r=t.createPattern(h.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else Fp(t,this._bbox),r=this._createGradient(t);return r}}function Xf(n,t,e,s,i,r,o,a){const c=t.coords,h=t.colors,u=n.data,d=n.width*4;let f;c[e+1]>c[s+1]&&(f=e,e=s,s=f,f=r,r=o,o=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=o,o=a,a=f),c[e+1]>c[s+1]&&(f=e,e=s,s=f,f=r,r=o,o=f);const p=(c[e]+t.offsetX)*t.scaleX,m=(c[e+1]+t.offsetY)*t.scaleY,b=(c[s]+t.offsetX)*t.scaleX,A=(c[s+1]+t.offsetY)*t.scaleY,v=(c[i]+t.offsetX)*t.scaleX,_=(c[i+1]+t.offsetY)*t.scaleY;if(m>=_)return;const x=h[r],S=h[r+1],C=h[r+2],T=h[o],R=h[o+1],L=h[o+2],P=h[a],F=h[a+1],N=h[a+2],D=Math.round(m),tt=Math.round(_);let nt,Nt,z,G,Y,lt,mt,Ht;for(let zt=D;zt<=tt;zt++){if(zt<A){const Ut=zt<m?0:(m-zt)/(m-A);nt=p-(p-b)*Ut,Nt=x-(x-T)*Ut,z=S-(S-R)*Ut,G=C-(C-L)*Ut}else{let Ut;zt>_?Ut=1:A===_?Ut=0:Ut=(A-zt)/(A-_),nt=b-(b-v)*Ut,Nt=T-(T-P)*Ut,z=R-(R-F)*Ut,G=L-(L-N)*Ut}let ee;zt<m?ee=0:zt>_?ee=1:ee=(m-zt)/(m-_),Y=p-(p-v)*ee,lt=x-(x-P)*ee,mt=S-(S-F)*ee,Ht=C-(C-N)*ee;const qn=Math.round(Math.min(nt,Y)),Ei=Math.round(Math.max(nt,Y));let Be=d*zt+qn*4;for(let Ut=qn;Ut<=Ei;Ut++)ee=(nt-Ut)/(nt-Y),ee<0?ee=0:ee>1&&(ee=1),u[Be++]=Nt-(Nt-lt)*ee|0,u[Be++]=z-(z-mt)*ee|0,u[Be++]=G-(G-Ht)*ee|0,u[Be++]=255}}function r1(n,t,e){const s=t.coords,i=t.colors;let r,o;switch(t.type){case"lattice":const a=t.verticesPerRow,c=Math.floor(s.length/a)-1,h=a-1;for(r=0;r<c;r++){let u=r*a;for(let d=0;d<h;d++,u++)Xf(n,e,s[u],s[u+1],s[u+a],i[u],i[u+1],i[u+a]),Xf(n,e,s[u+a+1],s[u+1],s[u+a],i[u+a+1],i[u+1],i[u+a])}break;case"triangles":for(r=0,o=s.length;r<o;r+=3)Xf(n,e,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class o1 extends pm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,s){const a=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-a,u=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(h*t[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(u*t[1]*1.1)),3e3),p=h/d,m=u/f,b={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-c,scaleX:1/p,scaleY:1/m},A=d+2*2,v=f+2*2,_=s.getCanvas("mesh",A,v),x=_.context,S=x.createImageData(d,f);if(e){const T=S.data;for(let R=0,L=T.length;R<L;R+=4)T[R]=e[0],T[R+1]=e[1],T[R+2]=e[2],T[R+3]=255}for(const T of this._figures)r1(S,T,b);return x.putImageData(S,2,2),{canvas:_.canvas,offsetX:a-2*p,offsetY:c-2*m,scaleX:p,scaleY:m}}getPattern(t,e,s,i){Fp(t,this._bbox);let r;if(i===We.SHADING)r=st.singularValueDecompose2dScale(Qt(t));else if(r=st.singularValueDecompose2dScale(e.baseTransform),this.matrix){const a=st.singularValueDecompose2dScale(this.matrix);r=[r[0]*a[0],r[1]*a[1]]}const o=this._createMeshCanvas(r,i===We.SHADING?null:this._background,e.cachedCanvases);return i!==We.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class a1 extends pm{getPattern(){return"hotpink"}}function l1(n){switch(n[0]){case"RadialAxial":return new n1(n);case"Mesh":return new o1(n);case"Dummy":return new a1}throw new Error(`Unknown IR type: ${n[0]}`)}const Eb={COLORED:1,UNCOLORED:2},Yd=class Yd{constructor(t,e,s,i,r){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:s,paintType:i,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:c,ystep:h}=this;c=Math.abs(c),h=Math.abs(h),Cf("TilingType: "+r);const u=e[0],d=e[1],f=e[2],p=e[3],m=f-u,b=p-d,A=st.singularValueDecompose2dScale(this.matrix),v=st.singularValueDecompose2dScale(this.baseTransform),_=A[0]*v[0],x=A[1]*v[1];let S=m,C=b,T=!1,R=!1;const L=Math.ceil(c*_),P=Math.ceil(h*x),F=Math.ceil(m*_),N=Math.ceil(b*x);L>=F?S=c:T=!0,P>=N?C=h:R=!0;const D=this.getSizeAndScale(S,this.ctx.canvas.width,_),tt=this.getSizeAndScale(C,this.ctx.canvas.height,x),nt=t.cachedCanvases.getCanvas("pattern",D.size,tt.size),Nt=nt.context,z=a.createCanvasGraphics(Nt);if(z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(z,i,o),Nt.translate(-D.scale*u,-tt.scale*d),z.transform(D.scale,0,0,tt.scale,0,0),Nt.save(),this.clipBbox(z,u,d,f,p),z.baseTransform=Qt(z.ctx),z.executeOperatorList(s),z.endDrawing(),Nt.restore(),T||R){const G=nt.canvas;T&&(S=c),R&&(C=h);const Y=this.getSizeAndScale(S,this.ctx.canvas.width,_),lt=this.getSizeAndScale(C,this.ctx.canvas.height,x),mt=Y.size,Ht=lt.size,zt=t.cachedCanvases.getCanvas("pattern-workaround",mt,Ht),ee=zt.context,qn=T?Math.floor(m/c):0,Ei=R?Math.floor(b/h):0;for(let Be=0;Be<=qn;Be++)for(let Ut=0;Ut<=Ei;Ut++)ee.drawImage(G,mt*Be,Ht*Ut,mt,Ht,0,0,mt,Ht);return{canvas:zt.canvas,scaleX:Y.scale,scaleY:lt.scale,offsetX:u,offsetY:d}}return{canvas:nt.canvas,scaleX:D.scale,scaleY:tt.scale,offsetX:u,offsetY:d}}getSizeAndScale(t,e,s){const i=Math.max(Yd.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*s);return r>=i?r=i:s=r/t,{scale:s,size:r}}clipBbox(t,e,s,i,r){const o=i-e,a=r-s;t.ctx.rect(e,s,o,a),t.current.updateRectMinMax(Qt(t.ctx),[e,s,i,r]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const i=t.ctx,r=t.current;switch(e){case Eb.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,r.fillColor=o.fillStyle,r.strokeColor=o.strokeStyle;break;case Eb.UNCOLORED:const a=st.makeHexColor(s[0],s[1],s[2]);i.fillStyle=a,i.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new LE(`Unsupported paint type: ${e}`)}}getPattern(t,e,s,i){let r=s;i!==We.SHADING&&(r=st.transform(r,e.baseTransform),this.matrix&&(r=st.transform(r,this.matrix)));const o=this.createPatternCanvas(e);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const c=t.createPattern(o.canvas,"repeat");return c.setTransform(a),c}};U(Yd,"MAX_PATTERN_SIZE",3e3);let Np=Yd;function c1({src:n,srcPos:t=0,dest:e,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=$e.isLittleEndian?4278190080:255,[c,h]=o?[r,a]:[a,r],u=s>>3,d=s&7,f=n.length;e=new Uint32Array(e.buffer);let p=0;for(let m=0;m<i;m++){for(const A=t+u;t<A;t++){const v=t<f?n[t]:255;e[p++]=v&128?h:c,e[p++]=v&64?h:c,e[p++]=v&32?h:c,e[p++]=v&16?h:c,e[p++]=v&8?h:c,e[p++]=v&4?h:c,e[p++]=v&2?h:c,e[p++]=v&1?h:c}if(d===0)continue;const b=t<f?n[t++]:255;for(let A=0;A<d;A++)e[p++]=b&1<<7-A?h:c}return{srcPos:t,destPos:p}}const Cb=16,Tb=100,h1=15,kb=10,Rb=1e3,ps=16;function u1(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(s,i){t.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){t.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,o,a,c){t.transform(s,i,r,o,a,c),this.__originalTransform(s,i,r,o,a,c)},n.setTransform=function(s,i,r,o,a,c){t.setTransform(s,i,r,o,a,c),this.__originalSetTransform(s,i,r,o,a,c)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){t.rotate(s),this.__originalRotate(s)},n.clip=function(s){t.clip(s),this.__originalClip(s)},n.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},n.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},n.bezierCurveTo=function(e,s,i,r,o,a){t.bezierCurveTo(e,s,i,r,o,a),this.__originalBezierCurveTo(e,s,i,r,o,a)},n.rect=function(e,s,i,r){t.rect(e,s,i,r),this.__originalRect(e,s,i,r)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class d1{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,s)):(i=this.canvasFactory.create(e,s),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Fu(n,t,e,s,i,r,o,a,c,h){const[u,d,f,p,m,b]=Qt(n);if(d===0&&f===0){const _=o*u+m,x=Math.round(_),S=a*p+b,C=Math.round(S),T=(o+c)*u+m,R=Math.abs(Math.round(T)-x)||1,L=(a+h)*p+b,P=Math.abs(Math.round(L)-C)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(p),x,C),n.drawImage(t,e,s,i,r,0,0,R,P),n.setTransform(u,d,f,p,m,b),[R,P]}if(u===0&&p===0){const _=a*f+m,x=Math.round(_),S=o*d+b,C=Math.round(S),T=(a+h)*f+m,R=Math.abs(Math.round(T)-x)||1,L=(o+c)*d+b,P=Math.abs(Math.round(L)-C)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,x,C),n.drawImage(t,e,s,i,r,0,0,P,R),n.setTransform(u,d,f,p,m,b),[P,R]}n.drawImage(t,e,s,i,r,o,a,c,h);const A=Math.hypot(u,d),v=Math.hypot(f,p);return[A*c,v*h]}function f1(n){const{width:t,height:e}=n;if(t>Rb||e>Rb)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=t+1;let o=new Uint8Array(r*(e+1)),a,c,h;const u=t+7&-8;let d=new Uint8Array(u*e),f=0;for(const v of n.data){let _=128;for(;_>0;)d[f++]=v&_?0:255,_>>=1}let p=0;for(f=0,d[f]!==0&&(o[0]=1,++p),c=1;c<t;c++)d[f]!==d[f+1]&&(o[c]=d[f]?2:1,++p),f++;for(d[f]!==0&&(o[c]=2,++p),a=1;a<e;a++){f=a*u,h=a*r,d[f-u]!==d[f]&&(o[h]=d[f]?1:8,++p);let v=(d[f]?4:0)+(d[f-u]?8:0);for(c=1;c<t;c++)v=(v>>2)+(d[f+1]?4:0)+(d[f-u+1]?8:0),i[v]&&(o[h+c]=i[v],++p),f++;if(d[f-u]!==d[f]&&(o[h+c]=d[f]?2:4,++p),p>s)return null}for(f=u*(e-1),h=a*r,d[f]!==0&&(o[h]=8,++p),c=1;c<t;c++)d[f]!==d[f+1]&&(o[h+c]=d[f]?4:8,++p),f++;if(d[f]!==0&&(o[h+c]=4,++p),p>s)return null;const m=new Int32Array([0,r,-1,0,-r,0,0,0,1]),b=new Path2D;for(a=0;p&&a<=e;a++){let v=a*r;const _=v+t;for(;v<_&&!o[v];)v++;if(v===_)continue;b.moveTo(v%r,a);const x=v;let S=o[v];do{const C=m[S];do v+=C;while(!o[v]);const T=o[v];T!==5&&T!==10?(S=T,o[v]=0):(S=T&51*S>>4,o[v]&=S>>2|S<<2),b.lineTo(v%r,v/r|0),o[v]||--p}while(x!==v);--a}return d=null,o=null,function(v){v.save(),v.scale(1/t,-1/e),v.translate(0,-e),v.fill(b),v.beginPath(),v.restore()}}class Pb{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=vw,this.textMatrixScale=1,this.fontMatrix=dp,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=He.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,s){[e,s]=st.applyTransform([e,s],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(t,e){const s=st.applyTransform(e,t),i=st.applyTransform(e.slice(2),t),r=st.applyTransform([e[0],e[3]],t),o=st.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,s[0],i[0],r[0],o[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],o[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],o[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],o[1])}updateScalingPathMinMax(t,e){st.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,s,i,r,o,a,c,h,u){const d=st.bezierBoundingBox(e,s,i,r,o,a,c,h,u);u||this.updateRectMinMax(t,d)}getPathBoundingBox(t=We.FILL,e=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(t===We.STROKE){e||$t("Stroke bounding box must include transform.");const i=st.singularValueDecompose2dScale(e),r=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=o,s[2]+=r,s[3]+=o}return s}updateClipFromPath(){const t=st.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=We.FILL,e=null){return st.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Mb(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,s=t.width,i=e%ps,r=(e-i)/ps,o=i===0?r:r+1,a=n.createImageData(s,ps);let c=0,h;const u=t.data,d=a.data;let f,p,m,b;if(t.kind===Gu.GRAYSCALE_1BPP){const A=u.byteLength,v=new Uint32Array(d.buffer,0,d.byteLength>>2),_=v.length,x=s+7>>3,S=4294967295,C=$e.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(m=f<r?ps:i,h=0,p=0;p<m;p++){const T=A-c;let R=0;const L=T>x?s:T*8-7,P=L&-8;let F=0,N=0;for(;R<P;R+=8)N=u[c++],v[h++]=N&128?S:C,v[h++]=N&64?S:C,v[h++]=N&32?S:C,v[h++]=N&16?S:C,v[h++]=N&8?S:C,v[h++]=N&4?S:C,v[h++]=N&2?S:C,v[h++]=N&1?S:C;for(;R<L;R++)F===0&&(N=u[c++],F=128),v[h++]=N&F?S:C,F>>=1}for(;h<_;)v[h++]=0;n.putImageData(a,0,f*ps)}}else if(t.kind===Gu.RGBA_32BPP){for(p=0,b=s*ps*4,f=0;f<r;f++)d.set(u.subarray(c,c+b)),c+=b,n.putImageData(a,0,p),p+=ps;f<o&&(b=s*i*4,d.set(u.subarray(c,c+b)),n.putImageData(a,0,p))}else if(t.kind===Gu.RGB_24BPP)for(m=ps,b=s*m,f=0;f<o;f++){for(f>=r&&(m=i,b=s*m),h=0,p=b;p--;)d[h++]=u[c++],d[h++]=u[c++],d[h++]=u[c++],d[h++]=255;n.putImageData(a,0,f*ps)}else throw new Error(`bad image kind: ${t.kind}`)}function Ib(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,i=e%ps,r=(e-i)/ps,o=i===0?r:r+1,a=n.createImageData(s,ps);let c=0;const h=t.data,u=a.data;for(let d=0;d<o;d++){const f=d<r?ps:i;({srcPos:c}=c1({src:h,srcPos:c,dest:u,width:s,height:f,nonBlackColor:0})),n.putImageData(a,0,d*ps)}}function rc(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)n[s]!==void 0&&(t[s]=n[s]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function Nu(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!De){const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}}function Lb(n,t){if(t)return!0;const e=st.singularValueDecompose2dScale(n);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const s=Math.fround(Vn.pixelRatio*Hr.PDF_TO_CSS_UNITS);return e[0]<=s&&e[1]<=s}const p1=["butt","round","square"],g1=["miter","round","bevel"],m1={},Db={};var xi,Op,$p,Bp;const vm=class vm{constructor(t,e,s,i,r,{optionalContentConfig:o,markedContentStack:a=null},c,h){y(this,xi);this.ctx=t,this.current=new Pb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new d1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,s){const c=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Qt(this.compositeCtx))}this.ctx.save(),Nu(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Qt(this.ctx)}executeOperatorList(t,e,s,i){const r=t.argsArray,o=t.fnArray;let a=e||0;const c=r.length;if(c===a)return a;const h=c-a>kb&&typeof s=="function",u=h?Date.now()+h1:0;let d=0;const f=this.commonObjs,p=this.objs;let m;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,s),a;if(m=o[a],m!==ri.dependency)this[m].apply(this,r[a]);else for(const b of r[a]){const A=b.startsWith("g_")?f:p;if(!A.has(b))return A.get(b,s),a}if(a++,a===c)return a;if(h&&++d>kb){if(Date.now()>u)return s(),a;d=0}}}endDrawing(){w(this,xi,Op).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),w(this,xi,$p).call(this)}_scaleImage(t,e){const s=t.width??t.displayWidth,i=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),a=s,c=i,h="prescale1",u,d;for(;r>2&&a>1||o>2&&c>1;){let f=a,p=c;r>2&&a>1&&(f=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/f),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),u=this.cachedCanvases.getCanvas(h,f,p),d=u.context,d.clearRect(0,0,f,p),d.drawImage(t,0,0,a,c,0,0,f,p),t=u.canvas,a=f,c=p,h=h==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:a,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:s,height:i}=t,r=this.current.fillColor,o=this.current.patternFill,a=Qt(e);let c,h,u,d;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;h=JSON.stringify(o?a:[a.slice(0,4),r]),c=this._cachedBitmapsMap.get(L),c||(c=new Map,this._cachedBitmapsMap.set(L,c));const P=c.get(h);if(P&&!o){const F=Math.round(Math.min(a[0],a[2])+a[4]),N=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:P,offsetX:F,offsetY:N}}u=P}u||(d=this.cachedCanvases.getCanvas("maskCanvas",s,i),Ib(d.context,t));let f=st.transform(a,[1/s,0,0,-1/i,0,0]);f=st.transform(f,[1,0,0,1,0,-i]);const[p,m,b,A]=st.getAxialAlignedBoundingBox([0,0,s,i],f),v=Math.round(b-p)||1,_=Math.round(A-m)||1,x=this.cachedCanvases.getCanvas("fillCanvas",v,_),S=x.context,C=p,T=m;S.translate(-C,-T),S.transform(...f),u||(u=this._scaleImage(d.canvas,Pi(S)),u=u.img,c&&o&&c.set(h,u)),S.imageSmoothingEnabled=Lb(Qt(S),t.interpolate),Fu(S,u,0,0,u.width,u.height,0,0,s,i),S.globalCompositeOperation="source-in";const R=st.transform(Pi(S),[1,0,0,1,-C,-T]);return S.fillStyle=o?r.getPattern(e,this,R,We.FILL):r,S.fillRect(0,0,s,i),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(h,x.canvas)),{canvas:x.canvas,offsetX:Math.round(C),offsetY:Math.round(T)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=p1[t]}setLineJoin(t){this.ctx.lineJoin=g1[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,s]of t)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...Qt(this.suspendedCtx)),rc(this.suspendedCtx,r),u1(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),rc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,i){const r=i[0],o=i[1],a=i[2]-r,c=i[3]-o;a===0||c===0||(this.genericComposeSMask(e.context,s,a,c,e.subtype,e.backdrop,e.transferMap,r,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,i,r,o,a,c,h,u,d){let f=t.canvas,p=c-u,m=h-d;if(o){const A=st.makeHexColor(...o);if(p<0||m<0||p+s>f.width||m+i>f.height){const v=this.cachedCanvases.getCanvas("maskExtension",s,i),_=v.context;_.drawImage(f,-p,-m),_.globalCompositeOperation="destination-atop",_.fillStyle=A,_.fillRect(0,0,s,i),_.globalCompositeOperation="source-over",f=v.canvas,p=m=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(p,m,s,i),t.clip(v),t.globalCompositeOperation="destination-atop",t.fillStyle=A,t.fillRect(p,m,s,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?e.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(a));const b=new Path2D;b.rect(c,h,s,i),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(f,p,m,s,i,c,h,s,i),e.restore()}save(){this.inSMaskMode?(rc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),rc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,s,i,r,o){this.ctx.transform(t,e,s,i,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s){const i=this.ctx,r=this.current;let o=r.x,a=r.y,c,h;const u=Qt(i),d=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,f=d?s.slice(0):null;for(let p=0,m=0,b=t.length;p<b;p++)switch(t[p]|0){case ri.rectangle:o=e[m++],a=e[m++];const A=e[m++],v=e[m++],_=o+A,x=a+v;i.moveTo(o,a),A===0||v===0?i.lineTo(_,x):(i.lineTo(_,a),i.lineTo(_,x),i.lineTo(o,x)),d||r.updateRectMinMax(u,[o,a,_,x]),i.closePath();break;case ri.moveTo:o=e[m++],a=e[m++],i.moveTo(o,a),d||r.updatePathMinMax(u,o,a);break;case ri.lineTo:o=e[m++],a=e[m++],i.lineTo(o,a),d||r.updatePathMinMax(u,o,a);break;case ri.curveTo:c=o,h=a,o=e[m+4],a=e[m+5],i.bezierCurveTo(e[m],e[m+1],e[m+2],e[m+3],o,a),r.updateCurvePathMinMax(u,c,h,e[m],e[m+1],e[m+2],e[m+3],o,a,f),m+=6;break;case ri.curveTo2:c=o,h=a,i.bezierCurveTo(o,a,e[m],e[m+1],e[m+2],e[m+3]),r.updateCurvePathMinMax(u,c,h,o,a,e[m],e[m+1],e[m+2],e[m+3],f),o=e[m+2],a=e[m+3],m+=4;break;case ri.curveTo3:c=o,h=a,o=e[m+2],a=e[m+3],i.bezierCurveTo(e[m],e[m+1],o,a,o,a),r.updateCurvePathMinMax(u,c,h,e[m],e[m+1],o,a,o,a,f),m+=4;break;case ri.closePath:i.closePath();break}d&&r.updateScalingPathMinMax(u,f),r.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,s=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(e.save(),e.strokeStyle=s.getPattern(e,this,Pi(e),We.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(e.save(),e.fillStyle=s.getPattern(e,this,Pi(e),We.FILL),r=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),r&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=m1}eoClip(){this.pendingClip=Db}beginText(){this.current.textMatrix=vw,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const s=new Path2D,i=e.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:c,path:h}of t)s.addPath(h,new DOMMatrix(r).preMultiplySelf(i).translate(o,a).scale(c,-c));e.clip(s),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var u;const s=this.commonObjs.get(t),i=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=s.fontMatrix||dp,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&gt("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=e,s.isType3Font)return;const r=s.loadedName||"sans-serif",o=((u=s.systemFontInfo)==null?void 0:u.css)||`"${r}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const c=s.italic?"italic":"normal";let h=e;e<Cb?h=Cb:e>Tb&&(h=Tb),this.current.fontSizeScale=e/h,this.ctx.font=`${c} ${a} ${h}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,s,i,r,o){this.current.textMatrix=[t,e,s,i,r,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,s,i,r){const o=this.ctx,a=this.current,c=a.font,h=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,d=h&He.FILL_STROKE_MASK,f=!!(h&He.ADD_TO_PATH_FLAG),p=a.patternFill&&!c.missingFile,m=a.patternStroke&&!c.missingFile;let b;if((c.disableFontFace||f||p||m)&&(b=c.getPathGenerator(this.commonObjs,t)),c.disableFontFace||p||m){o.save(),o.translate(e,s),o.scale(u,-u);let A;if((d===He.FILL||d===He.FILL_STROKE)&&(i?(A=o.getTransform(),o.setTransform(...i),o.fill(w(this,xi,Bp).call(this,b,A,i))):o.fill(b)),d===He.STROKE||d===He.FILL_STROKE)if(r){A||(A=o.getTransform()),o.setTransform(...r);const{a:v,b:_,c:x,d:S}=A,C=st.inverseTransform(r),T=st.transform([v,_,x,S,0,0],C),[R,L]=st.singularValueDecompose2dScale(T);o.lineWidth*=Math.max(R,L)/u,o.stroke(w(this,xi,Bp).call(this,b,A,r))}else o.lineWidth/=u,o.stroke(b);o.restore()}else(d===He.FILL||d===He.FILL_STROKE)&&o.fillText(t,e,s),(d===He.STROKE||d===He.FILL_STROKE)&&o.strokeText(t,e,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Qt(o),x:e,y:s,fontSize:u,path:b})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){s=!0;break}return _t(this,"isFontSubpixelAAEnabled",s)}showText(t){const e=this.current,s=e.font;if(s.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const r=this.ctx,o=e.fontSizeScale,a=e.charSpacing,c=e.wordSpacing,h=e.fontDirection,u=e.textHScale*h,d=t.length,f=s.vertical,p=f?1:-1,m=s.defaultVMetrics,b=i*e.fontMatrix[0],A=e.textRenderingMode===He.FILL&&!s.disableFontFace&&!e.patternFill;r.save(),r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),h>0?r.scale(u,-1):r.scale(u,1);let v,_;if(e.patternFill){r.save();const R=e.fillColor.getPattern(r,this,Pi(r),We.FILL);v=Qt(r),r.restore(),r.fillStyle=R}if(e.patternStroke){r.save();const R=e.strokeColor.getPattern(r,this,Pi(r),We.STROKE);_=Qt(r),r.restore(),r.strokeStyle=R}let x=e.lineWidth;const S=e.textMatrixScale;if(S===0||x===0){const R=e.textRenderingMode&He.FILL_STROKE_MASK;(R===He.STROKE||R===He.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=S;if(o!==1&&(r.scale(o,o),x/=o),r.lineWidth=x,s.isInvalidPDFjsFont){const R=[];let L=0;for(const P of t)R.push(P.unicode),L+=P.width;r.fillText(R.join(""),0,0),e.x+=L*b*u,r.restore(),this.compose();return}let C=0,T;for(T=0;T<d;++T){const R=t[T];if(typeof R=="number"){C+=p*R*i/1e3;continue}let L=!1;const P=(R.isSpace?c:0)+a,F=R.fontChar,N=R.accent;let D,tt,nt=R.width;if(f){const z=R.vmetric||m,G=-(R.vmetric?z[1]:nt*.5)*b,Y=z[2]*b;nt=z?-z[0]:nt,D=G/o,tt=(C+Y)/o}else D=C/o,tt=0;if(s.remeasure&&nt>0){const z=r.measureText(F).width*1e3/i*o;if(nt<z&&this.isFontSubpixelAAEnabled){const G=nt/z;L=!0,r.save(),r.scale(G,1),D/=G}else nt!==z&&(D+=(nt-z)/2e3*i/o)}if(this.contentVisible&&(R.isInFont||s.missingFile)){if(A&&!N)r.fillText(F,D,tt);else if(this.paintChar(F,D,tt,v,_),N){const z=D+i*N.offset.x/o,G=tt-i*N.offset.y/o;this.paintChar(N.fontChar,z,G,v,_)}}const Nt=f?nt*b-P*h:nt*b+P*h;C+=Nt,L&&r.restore()}f?e.y-=C:e.x+=C*u,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,s=this.current,i=s.font,r=s.fontSize,o=s.fontDirection,a=i.vertical?1:-1,c=s.charSpacing,h=s.wordSpacing,u=s.textHScale*o,d=s.fontMatrix||dp,f=t.length,p=s.textRenderingMode===He.INVISIBLE;let m,b,A,v;if(!(p||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...s.textMatrix),e.translate(s.x,s.y+s.textRise),e.scale(u,o),m=0;m<f;++m){if(b=t[m],typeof b=="number"){v=a*b*r/1e3,this.ctx.translate(v,0),s.x+=v*u;continue}const _=(b.isSpace?h:0)+c,x=i.charProcOperatorList[b.operatorListId];if(!x){gt(`Type3 character "${b.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=b,this.save(),e.scale(r,r),e.transform(...d),this.executeOperatorList(x),this.restore()),A=st.applyTransform([b.width,0],d)[0]*r+_,e.translate(A,0),s.x+=A*u}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,s,i,r,o){this.ctx.rect(s,i,r-s,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const s=t[1],i=this.baseTransform||Qt(this.ctx),r={createCanvasGraphics:o=>new vm(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Np(t,s,this.ctx,r,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,s){this.ctx.strokeStyle=this.current.strokeColor=st.makeHexColor(t,e,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,s){this.ctx.fillStyle=this.current.fillColor=st.makeHexColor(t,e,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=l1(this.getObject(t)),this.cachedPatterns.set(t,s)),e&&(s.matrix=e),s}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const s=this._getPattern(t);e.fillStyle=s.getPattern(e,this,Pi(e),We.SHADING);const i=Pi(e);if(i){const{width:r,height:o}=e.canvas,[a,c,h,u]=st.getAxialAlignedBoundingBox([0,0,r,o],i);this.ctx.fillRect(a,c,h-a,u-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){$t("Should not call beginInlineImage")}beginImageData(){$t("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Qt(this.ctx),e)){const s=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],s,i),this.current.updateRectMinMax(Qt(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Cf("TODO: Support non-isolated groups."),t.knockout&&gt("Knockout groups not supported.");const s=Qt(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=st.getAxialAlignedBoundingBox(t.bbox,Qt(e));const r=[0,0,e.canvas.width,e.canvas.height];i=st.intersect(i,r)||[0,0,0,0];const o=Math.floor(i[0]),a=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-o,1),h=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,c,h]);let u="groupAt"+this.groupLevel;t.smask&&(u+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(u,c,h),f=d.context;f.translate(-o,-a),f.transform(...s),t.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:o,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,a),e.save()),rc(e,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Qt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=st.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(t,e,s,i,r){if(w(this,xi,Op).call(this),Nu(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],a=e[3]-e[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=e[0],s[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=a;const[c,h]=st.singularValueDecompose2dScale(Qt(this.ctx)),{viewportScale:u}=this,d=Math.ceil(o*this.outputScaleX*u),f=Math.ceil(a*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(c,0,0,-h,0,a*h),Nu(this.ctx)}else Nu(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new Pb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),w(this,xi,$p).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=f1(t)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(t),o=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s=0,i=0,r,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const c=Qt(a);a.transform(e,s,i,r,0,0);const h=this._createMaskCanvas(t);a.setTransform(1,0,0,1,h.offsetX-c[4],h.offsetY-c[5]);for(let u=0,d=o.length;u<d;u+=2){const f=st.transform(c,[e,s,i,r,o[u],o[u+1]]),[p,m]=st.applyTransform([0,0],f);a.drawImage(h.canvas,p,m)}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of t){const{data:o,width:a,height:c,transform:h}=r,u=this.cachedCanvases.getCanvas("maskCanvas",a,c),d=u.context;d.save();const f=this.getObject(o,r);Ib(d,f),d.globalCompositeOperation="source-in",d.fillStyle=i?s.getPattern(d,this,Pi(e),We.FILL):s,d.fillRect(0,0,a,c),d.restore(),e.save(),e.transform(...h),e.scale(1,-1),Fu(e,u.canvas,0,0,a,c,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){gt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,s,i){if(!this.contentVisible)return;const r=this.getObject(t);if(!r){gt("Dependent image isn't ready yet");return}const o=r.width,a=r.height,c=[];for(let h=0,u=i.length;h<u;h+=2)c.push({transform:[e,0,0,s,i[h],i[h+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:i}=t,r=this.cachedCanvases.getCanvas("inlineImage",s,i),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,s=t.height,i=this.ctx;if(this.save(),!De){const{filter:a}=i;a!=="none"&&a!==""&&(i.filter="none")}i.scale(1/e,-1/s);let r;if(t.bitmap)r=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)r=t;else{const c=this.cachedCanvases.getCanvas("inlineImage",e,s).context;Mb(c,t),r=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(r,Pi(i));i.imageSmoothingEnabled=Lb(Qt(i),t.interpolate),Fu(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-s,e,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const r=t.width,o=t.height,c=this.cachedCanvases.getCanvas("inlineImage",r,o).context;Mb(c,t),i=this.applyTransferMapsToCanvas(c)}for(const r of e)s.save(),s.transform(...r.transform),s.scale(1,-1),Fu(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(e||(this.pendingClip===Db?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Qt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:i,d:r}=this.ctx.getTransform();let o,a;if(s===0&&i===0){const c=Math.abs(e),h=Math.abs(r);if(c===h)if(t===0)o=a=1/c;else{const u=c*t;o=a=u<1?1/u:1}else if(t===0)o=1/c,a=1/h;else{const u=c*t,d=h*t;o=u<1?1/u:1,a=d<1?1/d:1}}else{const c=Math.abs(e*r-s*i),h=Math.hypot(e,s),u=Math.hypot(i,r);if(t===0)o=u/c,a=h/c;else{const d=t*c;o=u>d?u/d:1,a=h>d?h/d:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(e.lineWidth=s||1,i===1&&r===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(i,r),o.length>0){const a=Math.max(i,r);e.setLineDash(o.map(c=>c/a)),e.lineDashOffset/=a}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};xi=new WeakSet,Op=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},$p=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},Bp=function(t,e,s){const i=new Path2D;return i.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),i};let Ua=vm;for(const n in ri)Ua.prototype[n]!==void 0&&(Ua.prototype[ri[n]]=Ua.prototype[n]);var wh,vh;class $n{static get workerPort(){return l(this,wh)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");g(this,wh,t)}static get workerSrc(){return l(this,vh)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");g(this,vh,t)}}wh=new WeakMap,vh=new WeakMap,y($n,wh,null),y($n,vh,"");var ko,Ah;class b1{constructor({parsedData:t,rawData:e}){y(this,ko);y(this,Ah);g(this,ko,t),g(this,Ah,e)}getRaw(){return l(this,Ah)}get(t){return l(this,ko).get(t)??null}getAll(){return rm(l(this,ko))}has(t){return l(this,ko).has(t)}}ko=new WeakMap,Ah=new WeakMap;const Pa=Symbol("INTERNAL");var _h,Sh,xh,ll;class y1{constructor(t,{name:e,intent:s,usage:i,rbGroups:r}){y(this,_h,!1);y(this,Sh,!1);y(this,xh,!1);y(this,ll,!0);g(this,_h,!!(t&Ls.DISPLAY)),g(this,Sh,!!(t&Ls.PRINT)),this.name=e,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,xh))return l(this,ll);if(!l(this,ll))return!1;const{print:t,view:e}=this.usage;return l(this,_h)?(e==null?void 0:e.viewState)!=="OFF":l(this,Sh)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,s=!1){t!==Pa&&$t("Internal method `_setVisible` called."),g(this,xh,s),g(this,ll,e)}}_h=new WeakMap,Sh=new WeakMap,xh=new WeakMap,ll=new WeakMap;var mr,Ft,cl,hl,Eh,Hp;class w1{constructor(t,e=Ls.DISPLAY){y(this,Eh);y(this,mr,null);y(this,Ft,new Map);y(this,cl,null);y(this,hl,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,g(this,hl,t.order);for(const s of t.groups)l(this,Ft).set(s.id,new y1(e,s));if(t.baseState==="OFF")for(const s of l(this,Ft).values())s._setVisible(Pa,!1);for(const s of t.on)l(this,Ft).get(s)._setVisible(Pa,!0);for(const s of t.off)l(this,Ft).get(s)._setVisible(Pa,!1);g(this,cl,this.getHash())}}isVisible(t){if(l(this,Ft).size===0)return!0;if(!t)return Cf("Optional content group not defined."),!0;if(t.type==="OCG")return l(this,Ft).has(t.id)?l(this,Ft).get(t.id).visible:(gt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return w(this,Eh,Hp).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!l(this,Ft).has(e))return gt(`Optional content group not found: ${e}`),!0;if(l(this,Ft).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!l(this,Ft).has(e))return gt(`Optional content group not found: ${e}`),!0;if(!l(this,Ft).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!l(this,Ft).has(e))return gt(`Optional content group not found: ${e}`),!0;if(!l(this,Ft).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!l(this,Ft).has(e))return gt(`Optional content group not found: ${e}`),!0;if(l(this,Ft).get(e).visible)return!1}return!0}return gt(`Unknown optional content policy ${t.policy}.`),!0}return gt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){var r;const i=l(this,Ft).get(t);if(!i){gt(`Optional content group not found: ${t}`);return}if(s&&e&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==t&&((r=l(this,Ft).get(a))==null||r._setVisible(Pa,!1,!0));i._setVisible(Pa,!!e,!0),g(this,mr,null)}setOCGState({state:t,preserveRB:e}){let s;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,Ft).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!r.visible,e);break}}g(this,mr,null)}get hasInitialVisibility(){return l(this,cl)===null||this.getHash()===l(this,cl)}getOrder(){return l(this,Ft).size?l(this,hl)?l(this,hl).slice():[...l(this,Ft).keys()]:null}getGroups(){return l(this,Ft).size>0?rm(l(this,Ft)):null}getGroup(t){return l(this,Ft).get(t)||null}getHash(){if(l(this,mr)!==null)return l(this,mr);const t=new tv;for(const[e,s]of l(this,Ft))t.update(`${e}:${s.visible}`);return g(this,mr,t.hexdigest())}}mr=new WeakMap,Ft=new WeakMap,cl=new WeakMap,hl=new WeakMap,Eh=new WeakSet,Hp=function(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let i=1;i<e;i++){const r=t[i];let o;if(Array.isArray(r))o=w(this,Eh,Hp).call(this,r);else if(l(this,Ft).has(r))o=l(this,Ft).get(r).visible;else return gt(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class v1{constructor(t,{disableRange:e=!1,disableStream:s=!1}){fe(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:o,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,h)=>{this._onReceiveData({begin:c,chunk:h})}),t.addProgressListener((c,h)=>{this._onProgress({loaded:c,total:h})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(s),!0)});fe(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,s,i,r;t.total===void 0?(s=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||s.call(e,{loaded:t.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){fe(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new A1(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new _1(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeReaders.slice(0))s.cancel(t);this._pdfDataRangeTransport.abort()}}class A1{constructor(t,e,s=!1,i=null){this._stream=t,this._done=s||!1,this._filename=lm(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class _1{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function S1(n){let t=!0,e=s("filename\\*","i").exec(n);if(e){e=e[1];let u=a(e);return u=unescape(u),u=c(u),u=h(u),r(u)}if(e=o(n),e){const u=h(e);return r(u)}if(e=s("filename","i").exec(n),e){e=e[1];let u=a(e);return u=h(u),r(u)}function s(u,d){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(u,d){if(u){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(u,{fatal:!0}),p=wu(d);d=f.decode(p),t=!1}catch{}}return d}function r(u){return t&&/[\x80-\xff]/.test(u)&&(u=i("utf-8",u),t&&(u=i("iso-8859-1",u))),u}function o(u){const d=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(u))!==null;){let[,b,A,v]=f;if(b=parseInt(b,10),b in d){if(b===0)break;continue}d[b]=[A,v]}const m=[];for(let b=0;b<d.length&&b in d;++b){let[A,v]=d[b];v=a(v),A&&(v=unescape(v),b===0&&(v=c(v))),m.push(v)}return m.join("")}function a(u){if(u.startsWith('"')){const d=u.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}u=d.join('"')}return u}function c(u){const d=u.indexOf("'");if(d===-1)return u;const f=u.slice(0,d),m=u.slice(d+1).replace(/^[^']*'/,"");return i(f,m)}function h(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,m){if(p==="q"||p==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,A){return String.fromCharCode(parseInt(A,16))}),i(f,m);try{m=atob(m)}catch{}return i(f,m)})}return""}function dv(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const s in t){const i=t[s];i!==void 0&&e.append(s,i)}return e}function kf(n){var t;return((t=URL.parse(n))==null?void 0:t.origin)??null}function fv({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*e)||s||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function pv(n){const t=n.get("Content-Disposition");if(t){let e=S1(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(lm(e))return e}return null}function Su(n,t){return new Dd(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function gv(n){return n===200||n===206}function mv(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function bv(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(gt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class Fb{constructor(t){U(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=dv(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return fe(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new x1(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new E1(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class x1{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),i=e.url;fetch(i,mv(s,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=kf(r.url),!gv(r.status))throw Su(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:c}=fv({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=c||this._contentLength,this._filename=pv(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Br("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:bv(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class E1{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${s-1}`);const o=i.url;fetch(o,mv(r,this._withCredentials,this._abortController)).then(a=>{const c=kf(a.url);if(c!==t._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${t._responseOrigin}".`);if(!gv(a.status))throw Su(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:bv(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const Yf=200,Kf=206;function C1(n){const t=n.response;return typeof t!="string"?t:wu(t).buffer}class T1{constructor({url:t,httpHeaders:e,withCredentials:s}){U(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=dv(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,o]of this.headers)e.setRequestHeader(r,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=Kf):i.expectedStatus=Yf,e.responseType="arraybuffer",fe(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){var i;const s=this.pendingRequests[t];s&&((i=s.onProgress)==null||i.call(s,e))}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Yf;if(!(r===Yf&&s.expectedStatus===Kf)&&r!==s.expectedStatus){s.onError(i.status);return}const a=C1(i);if(r===Kf){const c=i.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);h?s.onDone({begin:parseInt(h[1],10),chunk:a}):(gt('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class k1{constructor(t){this._source=t,this._manager=new T1(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return fe(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new R1(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new P1(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class R1{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=kf(e.responseURL);const s=e.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[c,...h]=a.split(": ");return[c,h.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=fv({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=pv(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Su(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class P1{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=kf((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=Su(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const M1=/^[a-z][a-z0-9\-+.]+:/i;function I1(n){if(M1.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class L1{constructor(t){this.source=t,this.url=I1(t.url),fe(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return fe(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new D1(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new F1(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class D1{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Su(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Br("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class F1{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const N1=1e5,Nb=30;var Hb,br,ds,Ch,Th,Ro,wn,kh,Rh,Po,ul,dl,yr,fl,Ph,pl,Mo,Mh,Ih,gl,Io,Lh,wr,ml,jn,yv,wv,zp,Os,sd,Up,vv,Av;const me=class me{constructor({textContentSource:t,container:e,viewport:s}){y(this,jn);y(this,br,Promise.withResolvers());y(this,ds,null);y(this,Ch,!1);y(this,Th,!!((Hb=globalThis.FontInspector)!=null&&Hb.enabled));y(this,Ro,null);y(this,wn,null);y(this,kh,0);y(this,Rh,0);y(this,Po,null);y(this,ul,null);y(this,dl,0);y(this,yr,0);y(this,fl,Object.create(null));y(this,Ph,[]);y(this,pl,null);y(this,Mo,[]);y(this,Mh,new WeakMap);y(this,Ih,null);var c;if(t instanceof ReadableStream)g(this,pl,t);else if(typeof t=="object")g(this,pl,new ReadableStream({start(h){h.enqueue(t),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,ds,g(this,ul,e)),g(this,yr,s.scale*Vn.pixelRatio),g(this,dl,s.rotation),g(this,wn,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:o,pageY:a}=s.rawDims;g(this,Ih,[1,0,0,-1,-o,a+r]),g(this,Rh,i),g(this,kh,r),w(c=me,Os,vv).call(c),ga(e,s),l(this,br).promise.finally(()=>{l(me,ml).delete(this),g(this,wn,null),g(this,fl,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=$e.platform;return _t(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{l(this,Po).read().then(({value:e,done:s})=>{if(s){l(this,br).resolve();return}l(this,Ro)??g(this,Ro,e.lang),Object.assign(l(this,fl),e.styles),w(this,jn,yv).call(this,e.items),t()},l(this,br).reject)};return g(this,Po,l(this,pl).getReader()),l(me,ml).add(this),t(),l(this,br).promise}update({viewport:t,onBefore:e=null}){var r;const s=t.scale*Vn.pixelRatio,i=t.rotation;if(i!==l(this,dl)&&(e==null||e(),g(this,dl,i),ga(l(this,ul),{rotation:i})),s!==l(this,yr)){e==null||e(),g(this,yr,s);const o={div:null,properties:null,ctx:w(r=me,Os,sd).call(r,l(this,Ro))};for(const a of l(this,Mo))o.properties=l(this,Mh).get(a),o.div=a,w(this,jn,zp).call(this,o)}}cancel(){var e;const t=new Br("TextLayer task cancelled.");(e=l(this,Po))==null||e.cancel(t).catch(()=>{}),g(this,Po,null),l(this,br).reject(t)}get textDivs(){return l(this,Mo)}get textContentItemsStr(){return l(this,Ph)}static cleanup(){if(!(l(this,ml).size>0)){l(this,gl).clear();for(const{canvas:t}of l(this,Io).values())t.remove();l(this,Io).clear()}}};br=new WeakMap,ds=new WeakMap,Ch=new WeakMap,Th=new WeakMap,Ro=new WeakMap,wn=new WeakMap,kh=new WeakMap,Rh=new WeakMap,Po=new WeakMap,ul=new WeakMap,dl=new WeakMap,yr=new WeakMap,fl=new WeakMap,Ph=new WeakMap,pl=new WeakMap,Mo=new WeakMap,Mh=new WeakMap,Ih=new WeakMap,gl=new WeakMap,Io=new WeakMap,Lh=new WeakMap,wr=new WeakMap,ml=new WeakMap,jn=new WeakSet,yv=function(t){var i,r;if(l(this,Ch))return;(r=l(this,wn)).ctx??(r.ctx=w(i=me,Os,sd).call(i,l(this,Ro)));const e=l(this,Mo),s=l(this,Ph);for(const o of t){if(e.length>N1){gt("Ignoring additional textDivs for performance reasons."),g(this,Ch,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=l(this,ds);g(this,ds,document.createElement("span")),l(this,ds).classList.add("markedContent"),o.id!==null&&l(this,ds).setAttribute("id",`${o.id}`),a.append(l(this,ds))}else o.type==="endMarkedContent"&&g(this,ds,l(this,ds).parentNode);continue}s.push(o.str),w(this,jn,wv).call(this,o)}},wv=function(t){var b;const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};l(this,Mo).push(e);const i=st.transform(l(this,Ih),t.transform);let r=Math.atan2(i[1],i[0]);const o=l(this,fl)[t.fontName];o.vertical&&(r+=Math.PI/2);let a=l(this,Th)&&o.fontSubstitution||o.fontFamily;a=me.fontFamilyMap.get(a)||a;const c=Math.hypot(i[2],i[3]),h=c*w(b=me,Os,Av).call(b,a,o,l(this,Ro));let u,d;r===0?(u=i[4],d=i[5]-h):(u=i[4]+h*Math.sin(r),d=i[5]-h*Math.cos(r));const f="calc(var(--total-scale-factor) *",p=e.style;l(this,ds)===l(this,ul)?(p.left=`${(100*u/l(this,Rh)).toFixed(2)}%`,p.top=`${(100*d/l(this,kh)).toFixed(2)}%`):(p.left=`${f}${u.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(l(me,wr)*c).toFixed(2)}px)`,p.fontFamily=a,s.fontSize=c,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,l(this,Th)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),r!==0&&(s.angle=r*(180/Math.PI));let m=!1;if(t.str.length>1)m=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const A=Math.abs(t.transform[0]),v=Math.abs(t.transform[3]);A!==v&&Math.max(A,v)/Math.min(A,v)>1.5&&(m=!0)}if(m&&(s.canvasWidth=o.vertical?t.height:t.width),l(this,Mh).set(e,s),l(this,wn).div=e,l(this,wn).properties=s,w(this,jn,zp).call(this,l(this,wn)),s.hasText&&l(this,ds).append(e),s.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),l(this,ds).append(A)}},zp=function(t){var a;const{div:e,properties:s,ctx:i}=t,{style:r}=e;let o="";if(l(me,wr)>1&&(o=`scale(${1/l(me,wr)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:h,fontSize:u}=s;w(a=me,Os,Up).call(a,i,u*l(this,yr),c);const{width:d}=i.measureText(e.textContent);d>0&&(o=`scaleX(${h*l(this,yr)/d}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Os=new WeakSet,sd=function(t=null){let e=l(this,Io).get(t||(t=""));if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Io).set(t,e),l(this,Lh).set(e,{size:0,family:""})}return e},Up=function(t,e,s){const i=l(this,Lh).get(t);e===i.size&&s===i.family||(t.font=`${e}px ${s}`,i.size=e,i.family=s)},vv=function(){if(l(this,wr)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),g(this,wr,t.getBoundingClientRect().height),t.remove()},Av=function(t,e,s){const i=l(this,gl).get(t);if(i)return i;const r=w(this,Os,sd).call(this,s);r.canvas.width=r.canvas.height=Nb,w(this,Os,Up).call(this,r,Nb,t);const o=r.measureText(""),a=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let h=.8;return a?h=a/(a+c):($e.platform.isFirefox&&gt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?h=e.ascent:e.descent&&(h=1+e.descent)),l(this,gl).set(t,h),h},y(me,Os),y(me,gl,new Map),y(me,Io,new Map),y(me,Lh,new WeakMap),y(me,wr,null),y(me,ml,new Set);let Gc=me;class Wc{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function i(r){var c;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Wc.shouldBuildText(a))(c=r==null?void 0:r.attributes)!=null&&c.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&e.push({str:o}),!!r.children)for(const h of r.children)i(h)}return i(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const O1=65536,$1=100;function B1(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new jp,{docId:e}=t,s=n.url?H1(n.url):null,i=n.data?z1(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,c=n.range instanceof _v?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:O1;let u=n.worker instanceof Va?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Tf(n.docBaseUrl)?n.docBaseUrl:null,p=Ou(n.cMapUrl),m=n.cMapPacked!==!1,b=n.CMapReaderFactory||(De?e1:_b),A=Ou(n.iccUrl),v=Ou(n.standardFontDataUrl),_=n.StandardFontDataFactory||(De?s1:Sb),x=Ou(n.wasmUrl),S=n.WasmFactory||(De?i1:xb),C=n.stopAtErrors!==!0,T=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,R=n.isEvalSupported!==!1,L=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!De,P=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!De&&($e.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,N=typeof n.disableFontFace=="boolean"?n.disableFontFace:De,D=n.fontExtraProperties===!0,tt=n.enableXfa===!0,nt=n.ownerDocument||globalThis.document,Nt=n.disableRange===!0,z=n.disableStream===!0,G=n.disableAutoFetch===!0,Y=n.pdfBug===!0,lt=n.CanvasFactory||(De?t1:ZE),mt=n.FilterFactory||(De?JE:QE),Ht=n.enableHWA===!0,zt=n.useWasm!==!1,ee=c?c.length:n.length??NaN,qn=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!De&&!N,Ei=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(b===_b&&_===Sb&&S===xb&&p&&v&&x&&Ca(p,document.baseURI)&&Ca(v,document.baseURI)&&Ca(x,document.baseURI)),Be=null;RE(d);const Ut={canvasFactory:new lt({ownerDocument:nt,enableHWA:Ht}),filterFactory:new mt({docId:e,ownerDocument:nt}),cMapReaderFactory:Ei?null:new b({baseUrl:p,isCompressed:m}),standardFontDataFactory:Ei?null:new _({baseUrl:v}),wasmFactory:Ei?null:new S({baseUrl:x})};if(!u){const ii={verbosity:d,port:$n.workerPort};u=ii.port?Va.fromPort(ii):new Va(ii),t._worker=u}const Zl={docId:e,apiVersion:"5.0.375",data:i,password:a,disableAutoFetch:G,rangeChunkSize:h,length:ee,docBaseUrl:f,enableXfa:tt,evaluatorOptions:{maxImageSize:T,disableFontFace:N,ignoreErrors:C,isEvalSupported:R,isOffscreenCanvasSupported:L,isImageDecoderSupported:P,canvasMaxAreaInBytes:F,fontExtraProperties:D,useSystemFonts:qn,useWasm:zt,useWorkerFetch:Ei,cMapUrl:p,iccUrl:A,standardFontDataUrl:v,wasmUrl:x}},Cu={ownerDocument:nt,pdfBug:Y,styleElement:Be,loadingParams:{disableAutoFetch:G,enableXfa:tt}};return u.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const ii=u.messageHandler.sendWithPromise("GetDocRequest",Zl,i?[i.buffer]:null);let Tu;if(c)Tu=new v1(c,{disableRange:Nt,disableStream:z});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let E;if(De)if(Ca(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");E=Fb}else E=L1;else E=Ca(s)?Fb:k1;Tu=new E({url:s,length:ee,httpHeaders:r,withCredentials:o,rangeChunkSize:h,disableRange:Nt,disableStream:z})}return ii.then(E=>{if(t.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const k=new gc(e,E,u.port),I=new q1(k,t,Tu,Cu,Ut);t._transport=I,k.send("Ready",null)})}).catch(t._capability.reject),t}function H1(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(De)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function z1(n){if(De&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return wu(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Ou(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Vp=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,U1=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",V1=BE.bind(null,Vp,U1);var Kd;const Zd=class Zd{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ke(Zd,Kd)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,s,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};Kd=new WeakMap,y(Zd,Kd,0);let jp=Zd;class _v{constructor(t,e,s=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const s of this._rangeListeners)s(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){$t("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class j1{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return _t(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var vn,Lo,vc;class G1{constructor(t,e,s,i=!1){y(this,Lo);y(this,vn,!1);this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=i?new wb:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new Sv,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Au({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return _t(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:s="display",annotationMode:i=tr.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:c=null,pageColors:h=null,printAnnotationStorage:u=null,isEditing:d=!1}){var S,C;(S=this._stats)==null||S.time("Overall");const f=this._transport.getRenderingIntent(s,i,u,d),{renderingIntent:p,cacheKey:m}=f;g(this,vn,!1),a||(a=this._transport.getOptionalContentConfig(p));let b=this._intentStates.get(m);b||(b=Object.create(null),this._intentStates.set(m,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const A=!!(p&Ls.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(f));const v=T=>{var R;b.renderTasks.delete(_),A&&g(this,vn,!0),w(this,Lo,vc).call(this),T?(_.capability.reject(T),this._abortOperatorList({intentState:b,reason:T instanceof Error?T:new Error(T)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(R=globalThis.Stats)!=null&&R.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new Wp({callback:v,params:{canvasContext:t,viewport:e,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:h});(b.renderTasks||(b.renderTasks=new Set)).add(_);const x=_.task;return Promise.all([b.displayReadyCapability.promise,a]).then(([T,R])=>{var L;if(this.destroyed){v();return}if((L=this._stats)==null||L.time("Rendering"),!(R.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:T,optionalContentConfig:R}),_.operatorListChanged()}).catch(v),x}getOperatorList({intent:t="display",annotationMode:e=tr.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var h;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(t,e,s,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let c;return a.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(c),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Wc.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,i){function r(){o.read().then(function({value:c,done:h}){if(h){s(a);return}a.lang??(a.lang=c.lang),Object.assign(a.styles,c.styles),a.items.push(...c.items),r()},i)}const o=e.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),g(this,vn,!1),Promise.all(t)}cleanup(t=!1){g(this,vn,!0);const e=w(this,Lo,vc).call(this);return t&&e&&this._stats&&(this._stats=new wb),e}_startRenderPage(t,e){var i,r;const s=this._intentStates.get(e);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(t))}_renderPageChunk(t,e){for(let s=0,i=t.length;s<i;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&w(this,Lo,vc).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:i},o).getReader(),h=this._intentStates.get(e);h.streamReader=c;const u=()=>{c.read().then(({value:d,done:f})=>{if(f){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,h),u())},d=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const f of h.renderTasks)f.operatorListChanged();w(this,Lo,vc).call(this)}if(h.displayReadyCapability)h.displayReadyCapability.reject(d);else if(h.opListReadCapability)h.opListReadCapability.reject(d);else throw d}})};u()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof am){let i=$1;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new Br(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}vn=new WeakMap,Lo=new WeakSet,vc=function(){if(!l(this,vn)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,vn,!1),!0};var An,Qd;class W1{constructor(){y(this,An,new Map);y(this,Qd,Promise.resolve())}postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};l(this,Qd).then(()=>{for(const[i]of l(this,An))i.call(this,s)})}addEventListener(t,e,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){gt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);i=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}l(this,An).set(e,i)}removeEventListener(t,e){const s=l(this,An).get(e);s==null||s(),l(this,An).delete(e)}terminate(){for(const[,t]of l(this,An))t==null||t();l(this,An).clear()}}An=new WeakMap,Qd=new WeakMap;var Jd,Do,Fo,bl,id,yl,nd;const Kt=class Kt{constructor({name:t=null,port:e=null,verbosity:s=PE()}={}){y(this,bl);var i;if(this.name=t,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((i=l(Kt,Fo))!=null&&i.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(l(Kt,Fo)||g(Kt,Fo,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new gc("main","worker",t),this._messageHandler.on("ready",function(){}),w(this,bl,id).call(this)}_initialize(){if(l(Kt,Do)||l(Kt,yl,nd)){this._setupFakeWorker();return}let{workerSrc:t}=Kt;try{Kt._isSameOrigin(window.location,t)||(t=Kt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new gc("main","worker",e),i=()=>{r.abort(),s.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;e.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",a=>{if(r.abort(),this.destroyed||!a){i();return}this._messageHandler=s,this._port=e,this._webWorker=e,w(this,bl,id).call(this)}),s.on("ready",a=>{if(r.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{Cf("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(Kt,Do)||(gt("Setting up fake worker."),g(Kt,Do,!0)),Kt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new W1;this._port=e;const s=`fake${Ke(Kt,Jd)._++}`,i=new gc(s+"_worker",s,e);t.setup(i,e),this._messageHandler=new gc(s,s+"_worker",e),w(this,bl,id).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,s;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=l(Kt,Fo))==null||e.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(t){var s;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(s=l(this,Fo))==null?void 0:s.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Kt(t)}static get workerSrc(){if($n.workerSrc)return $n.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return _t(this,"_setupFakeWorkerGlobal",(async()=>l(this,yl,nd)?l(this,yl,nd):(await import(this.workerSrc)).WorkerMessageHandler)())}};Jd=new WeakMap,Do=new WeakMap,Fo=new WeakMap,bl=new WeakSet,id=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},yl=new WeakSet,nd=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},y(Kt,yl),y(Kt,Jd,0),y(Kt,Do,!1),y(Kt,Fo),De&&(g(Kt,Do,!0),$n.workerSrc||($n.workerSrc="./pdf.worker.mjs")),Kt._isSameOrigin=(t,e)=>{const s=URL.parse(t);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(e,s);return s.origin===i.origin},Kt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Va=Kt;var _n,Gi,wl,vl,Sn,No,Ac;class q1{constructor(t,e,s,i,r){y(this,No);y(this,_n,new Map);y(this,Gi,new Map);y(this,wl,new Map);y(this,vl,new Map);y(this,Sn,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Sv,this.fontLoader=new YE({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return _t(this,"annotationStorage",new dm)}getRenderingIntent(t,e=tr.ENABLE,s=null,i=!1,r=!1){let o=Ls.DISPLAY,a=Ip;switch(t){case"any":o=Ls.ANY;break;case"display":break;case"print":o=Ls.PRINT;break;default:gt(`getRenderingIntent - invalid intent: ${t}`)}const c=o&Ls.PRINT&&s instanceof sv?s:this.annotationStorage;switch(e){case tr.DISABLE:o+=Ls.ANNOTATIONS_DISABLE;break;case tr.ENABLE:break;case tr.ENABLE_FORMS:o+=Ls.ANNOTATIONS_FORMS;break;case tr.ENABLE_STORAGE:o+=Ls.ANNOTATIONS_STORAGE,a=c.serializable;break;default:gt(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(o+=Ls.IS_EDITING),r&&(o+=Ls.OPLIST);const{ids:h,hash:u}=c.modifiedIds,d=[o,a.hash,u];return{renderingIntent:o,cacheKey:d.join("_"),annotationStorageSerializable:a,modifiedIds:h}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,Sn))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of l(this,Gi).values())t.push(i._destroy());l(this,Gi).clear(),l(this,wl).clear(),l(this,vl).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,_n).clear(),this.filterFactory.destroy(),Gc.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Br("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,i)=>{fe(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){i.close();return}fe(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:o}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((a=e.onProgress)==null||a.call(e,this._lastProgress)),this._fullReader.onProgress=c=>{var h;(h=e.onProgress)==null||h.call(e,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:o}}),t.on("GetRangeReader",(s,i)=>{fe(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){i.close();return}fe(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{r.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new j1(s,this))}),t.on("DocException",s=>{e._capability.reject(cs(s))}),t.on("PasswordRequest",s=>{g(this,Sn,Promise.withResolvers());try{if(!e.onPassword)throw cs(s);const i=r=>{r instanceof Error?l(this,Sn).reject(r):l(this,Sn).resolve({password:r})};e.onPassword(i,s.code)}catch(i){l(this,Sn).reject(i)}return l(this,Sn).promise}),t.on("DataLoaded",s=>{var i;(i=e.onProgress)==null||i.call(e,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,Gi).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,i,r])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const u=r.error;gt(`Error during font loading: ${u}`),this.commonObjs.resolve(s,u);break}const a=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(u,d)=>globalThis.FontInspector.fontAdded(u,d):null,c=new KE(r,a);this.fontLoader.bind(c).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(s,c)});break;case"CopyLocalImage":const{imageRef:h}=r;fe(h,"The imageRef must be defined.");for(const u of l(this,Gi).values())for(const[,d]of u.objs)if((d==null?void 0:d.ref)===h)return d.dataLen?(this.commonObjs.resolve(s,structuredClone(d)),d.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([s,i,r,o])=>{var c;if(this.destroyed)return;const a=l(this,Gi).get(i);if(!a.objs.has(s)){if(a._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",s=>{var i;this.destroyed||(i=e.onProgress)==null||i.call(e,{loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&gt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((s=this._fullReader)==null?void 0:s.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=l(this,wl).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,vl).set(r.refStr,t);const o=new G1(e,r,this,this._params.pdfBug);return l(this,Gi).set(e,o),o});return l(this,wl).set(e,i),i}getPageIndex(t){return Vp(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return w(this,No,Ac).call(this,"GetFieldObjects")}hasJSActions(){return w(this,No,Ac).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return w(this,No,Ac).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return w(this,No,Ac).call(this,"GetOptionalContentConfig").then(e=>new w1(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=l(this,_n).get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(i=>{var r,o;return{info:i[0],metadata:i[1]?new b1(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return l(this,_n).set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of l(this,Gi).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),l(this,_n).clear(),this.filterFactory.destroy(!0),Gc.cleanup()}}cachedPageNumber(t){if(!Vp(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return l(this,vl).get(e)??null}}_n=new WeakMap,Gi=new WeakMap,wl=new WeakMap,vl=new WeakMap,Sn=new WeakMap,No=new WeakSet,Ac=function(t,e=null){const s=l(this,_n).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise(t,e);return l(this,_n).set(t,i),i};const oc=Symbol("INITIAL_DATA");var _s,Dh,Gp;class Sv{constructor(){y(this,Dh);y(this,_s,Object.create(null))}get(t,e=null){if(e){const i=w(this,Dh,Gp).call(this,t);return i.promise.then(()=>e(i.data)),null}const s=l(this,_s)[t];if(!s||s.data===oc)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=l(this,_s)[t];return!!e&&e.data!==oc}delete(t){const e=l(this,_s)[t];return!e||e.data===oc?!1:(delete l(this,_s)[t],!0)}resolve(t,e=null){const s=w(this,Dh,Gp).call(this,t);s.data=e,s.resolve()}clear(){var t;for(const e in l(this,_s)){const{data:s}=l(this,_s)[e];(t=s==null?void 0:s.bitmap)==null||t.close()}g(this,_s,Object.create(null))}*[Symbol.iterator](){for(const t in l(this,_s)){const{data:e}=l(this,_s)[t];e!==oc&&(yield[t,e])}}}_s=new WeakMap,Dh=new WeakSet,Gp=function(t){var e;return(e=l(this,_s))[t]||(e[t]={...Promise.withResolvers(),data:oc})};var vr;class X1{constructor(t){y(this,vr,null);U(this,"onContinue",null);U(this,"onError",null);g(this,vr,t)}get promise(){return l(this,vr).capability.promise}cancel(t=0){l(this,vr).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=l(this,vr).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=l(this,vr);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}vr=new WeakMap;var Ar,Oo;const so=class so{constructor({callback:t,params:e,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:h,useRequestAnimationFrame:u=!1,pdfBug:d=!1,pageColors:f=null}){y(this,Ar,null);this.callback=t,this.params=e,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=h,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new X1(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var a,c;if(this.cancelled)return;if(this._canvas){if(l(so,Oo).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(so,Oo).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:o}=this.params;this.gfx=new Ua(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(t=null,e=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,Ar)&&(window.cancelAnimationFrame(l(this,Ar)),g(this,Ar,null)),l(so,Oo).delete(this._canvas),t||(t=new am(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(r=(i=this.task).onError)==null||r.call(i,t)}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,Ar,window.requestAnimationFrame(()=>{g(this,Ar,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(so,Oo).delete(this._canvas),this.callback())))}};Ar=new WeakMap,Oo=new WeakMap,y(so,Oo,new WeakSet);let Wp=so;const Y1="5.0.375",K1="23972e194";function Ob(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function ac(n){return Math.max(0,Math.min(255,255*n))}class $b{static CMYK_G([t,e,s,i]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=ac(t),[t,t,t]}static G_HTML([t]){const e=Ob(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(ac)}static RGB_HTML(t){return`#${t.map(Ob).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,s+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,s,i]){return[ac(1-Math.min(1,t+i)),ac(1-Math.min(1,s+i)),ac(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const i=1-t,r=1-e,o=1-s,a=Math.min(i,r,o);return["CMYK",i,r,o,a]}}class Z1{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){$t("Abstract method `_createSVG` called.")}}class Od extends Z1{_createSVG(t){return document.createElementNS(sn,t)}}class xv{static setupStorage(t,e,s,i,r){const o=i.getValue(e,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),r==="print")break;t.addEventListener("input",a=>{i.setValue(e,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?t.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",a=>{i.setValue(e,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),r==="print")break;t.addEventListener("input",a=>{i.setValue(e,{value:a.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}t.addEventListener("input",a=>{const c=a.target.options,h=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(e,{value:h})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:i,linkService:r}){const{attributes:o}=e,a=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[c,h]of Object.entries(o))if(h!=null)switch(c){case"class":h.length&&t.setAttribute(c,h.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",h);break;case"style":Object.assign(t.style,h);break;case"textContent":t.textContent=h;break;default:(!a||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,h)}a&&r.addLinkAttributes(t,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(t,o.dataId,e,s)}static render(t){var d,f;const e=t.annotationStorage,s=t.linkService,i=t.xfaHtml,r=t.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:r,linkService:s});const a=r!=="richText",c=t.div;if(c.append(o),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;c.style.transform=p}a&&c.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);o.append(p),a&&Wc.shouldBuildText(i.name)&&h.push(p)}return{textDivs:h}}const u=[[i,-1,o]];for(;u.length>0;){const[p,m,b]=u.at(-1);if(m+1===p.children.length){u.pop();continue}const A=p.children[++u.at(-1)[1]];if(A===null)continue;const{name:v}=A;if(v==="#text"){const x=document.createTextNode(A.value);h.push(x),b.append(x);continue}const _=(d=A==null?void 0:A.attributes)!=null&&d.xmlns?document.createElementNS(A.attributes.xmlns,v):document.createElement(v);if(b.append(_),A.attributes&&this.setAttributes({html:_,element:A,storage:e,intent:r,linkService:s}),((f=A.children)==null?void 0:f.length)>0)u.push([A,-1,_]);else if(A.value){const x=document.createTextNode(A.value);a&&Wc.shouldBuildText(v)&&h.push(x),_.append(x)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:h}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const xu=1e3,Q1=9,ba=new WeakSet;class Bb{static create(t){switch(t.data.annotationType){case he.LINK:return new Ev(t);case he.TEXT:return new J1(t);case he.WIDGET:switch(t.data.fieldType){case"Tx":return new tC(t);case"Btn":return t.data.radioButton?new kv(t):t.data.checkBox?new sC(t):new iC(t);case"Ch":return new nC(t);case"Sig":return new eC(t)}return new Aa(t);case he.POPUP:return new Xp(t);case he.FREETEXT:return new Lv(t);case he.LINE:return new oC(t);case he.SQUARE:return new aC(t);case he.CIRCLE:return new lC(t);case he.POLYLINE:return new Dv(t);case he.CARET:return new hC(t);case he.INK:return new gm(t);case he.POLYGON:return new cC(t);case he.HIGHLIGHT:return new Fv(t);case he.UNDERLINE:return new uC(t);case he.SQUIGGLY:return new dC(t);case he.STRIKEOUT:return new fC(t);case he.STAMP:return new Nv(t);case he.FILEATTACHMENT:return new pC(t);default:return new le(t)}}}var $o,Al,_l,Fh,qp;const Am=class Am{constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){y(this,Fh);y(this,$o,null);y(this,Al,!1);y(this,_l,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:s}){return!!(t!=null&&t.str||e!=null&&e.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Am._hasPopupData(this.data)}updateEdited(t){var s;if(!this.container)return;l(this,$o)||g(this,$o,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&w(this,Fh,qp).call(this,e),(s=l(this,_l))==null||s.popup.updateEdited(t)}resetEdited(){var t;l(this,$o)&&(w(this,Fh,qp).call(this,l(this,$o).rect),(t=l(this,_l))==null||t.popup.resetEdited(),g(this,$o,null))}_createContainer(t){const{data:e,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof Aa||(r.tabIndex=xu);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Xp){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:a,height:c}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,A=e.borderStyle.verticalCornerRadius;if(b>0||A>0){const _=`calc(${b}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;o.borderRadius=_}else if(this instanceof kv){const _=`calc(${a}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;o.borderRadius=_}switch(e.borderStyle.style){case Ea.SOLID:o.borderStyle="solid";break;case Ea.DASHED:o.borderStyle="dashed";break;case Ea.BEVELED:gt("Unimplemented border style: beveled");break;case Ea.INSET:gt("Unimplemented border style: inset");break;case Ea.UNDERLINE:o.borderBottomStyle="solid";break}const v=e.borderColor||null;v?(g(this,Al,!0),o.borderColor=st.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):o.borderWidth=0}const h=st.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:u,pageHeight:d,pageX:f,pageY:p}=i.rawDims;o.left=`${100*(h[0]-f)/u}%`,o.top=`${100*(h[1]-p)/d}%`;const{rotation:m}=e;return e.hasOwnCanvas||m===0?(o.width=`${100*a/u}%`,o.height=`${100*c/d}%`):this.setRotation(m,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:o}=this;t%180!==0&&([r,o]=[o,r]),e.style.width=`${100*r/s}%`,e.style.height=`${100*o/i}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,i)=>{const r=i.detail[e],o=r[0],a=r.slice(1);i.target.style[s]=$b[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:$b[`${o}_rgb`](a)})};return _t(this,"_commonActions",{display:e=>{const{display:s}=e.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const i of Object.keys(e.detail)){const r=t[i]||s[i];r==null||r(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[i,r]of Object.entries(e)){const o=s[i];if(o){const a={detail:{[i]:r},target:t};o(a),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,i,r]=this.data.rect.map(b=>Math.fround(b));if(t.length===8){const[b,A,v,_]=t.subarray(2,6);if(i===b&&r===A&&e===v&&s===_)return}const{style:o}=this.container;let a;if(l(this,Al)){const{borderColor:b,borderWidth:A}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const c=i-e,h=r-s,{svgFactory:u}=this,d=u.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=u.createElement("defs");d.append(f);const p=u.createElement("clipPath"),m=`clippath_${this.data.id}`;p.setAttribute("id",m),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let b=2,A=t.length;b<A;b+=8){const v=t[b],_=t[b+1],x=t[b+2],S=t[b+3],C=u.createElement("rect"),T=(x-e)/c,R=(r-_)/h,L=(v-x)/c,P=(_-S)/h;C.setAttribute("x",T),C.setAttribute("y",R),C.setAttribute("width",L),C.setAttribute("height",P),p.append(C),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${R}" width="${L}" height="${P}"/>`)}l(this,Al)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(d),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{data:t}=this,e=g(this,_l,new Xp({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){$t("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:r,id:o,exportValues:a}of i){if(r===-1||o===e)continue;const c=typeof a=="string"?a:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!ba.has(h)){gt(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:h})}return s}for(const i of document.getElementsByName(t)){const{exportValue:r}=i,o=i.getAttribute("data-element-id");o!==e&&ba.has(i)&&s.push({id:o,exportValue:r,domElement:i})}return s}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};$o=new WeakMap,Al=new WeakMap,_l=new WeakMap,Fh=new WeakSet,qp=function(t){const{container:{style:e},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}}}=this;s==null||s.splice(0,4,...t),e.left=`${100*(t[0]-a)/r}%`,e.top=`${100*(o-t[3]+c)/o}%`,i===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(i)};let le=Am;var Fs,Zr,Cv,Tv;class Ev extends le{constructor(e,s=null){super(e,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});y(this,Fs);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let r=!1;return e.url?(s.addLinkAttributes(i,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(i,e.action),r=!0):e.attachment?(w(this,Fs,Cv).call(this,i,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(w(this,Fs,Tv).call(this,i,e.setOCGState),r=!0):e.dest?(this._bindLink(i,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),r=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(e,s){e.href=this.linkService.getDestinationHash(s),e.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&w(this,Fs,Zr).call(this)}_bindNamedAction(e,s){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(s),!1),w(this,Fs,Zr).call(this)}_bindJSAction(e,s){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const o=i.get(r);o&&(e[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}e.onclick||(e.onclick=()=>!1),w(this,Fs,Zr).call(this)}_bindResetFormAction(e,s){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),w(this,Fs,Zr).call(this),!this._fieldObjects){gt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{var d;i==null||i();const{fields:r,refs:o,include:a}=s,c=[];if(r.length!==0||o.length!==0){const f=new Set(o);for(const p of r){const m=this._fieldObjects[p]||[];for(const{id:b}of m)f.add(b)}for(const p of Object.values(this._fieldObjects))for(const m of p)f.has(m.id)===a&&c.push(m)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const h=this.annotationStorage,u=[];for(const f of c){const{id:p}=f;switch(u.push(p),f.type){case"text":{const b=f.defaultValue||"";h.setValue(p,{value:b});break}case"checkbox":case"radiobutton":{const b=f.defaultValue===f.exportValues;h.setValue(p,{value:b});break}case"combobox":case"listbox":{const b=f.defaultValue||"";h.setValue(p,{value:b});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!ba.has(m)){gt(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}Fs=new WeakSet,Zr=function(){this.container.setAttribute("data-internal-link","")},Cv=function(e,s,i=null){e.href=this.linkService.getAnchorUrl(""),s.description&&(e.title=s.description),e.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},w(this,Fs,Zr).call(this)},Tv=function(e,s){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(s),!1),w(this,Fs,Zr).call(this)};class J1 extends le{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Aa extends le{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return $e.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,i,r){s.includes("mouse")?t.addEventListener(s,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(s,o=>{var a;if(s==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o)}}))})}_setEventListeners(t,e,s,i){var r,o,a;for(const[c,h]of s)(h==="Action"||(r=this.data.actions)!=null&&r[h])&&((h==="Focus"||h==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,c,h,i),h==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):h==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":st.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||Q1,r=t.style;let o;const a=2,c=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-a),u=Math.round(h/(jf*i))||1,d=h/u;o=Math.min(i,c(d/jf))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,c(h/jf))}r.fontSize=`calc(${o}px * var(--total-scale-factor))`,r.color=st.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class tC extends Aa{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,i){const r=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=s),r.setValue(o.id,{[i]:s})}render(){var i,r;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let a=o.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&a.length>c&&(a=a.slice(0,c));let h=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const u={userValue:a,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=h??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",h??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ba.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=xu,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",f=>{t.setValue(e,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),u.formattedValue=null}),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";s.value=u.userValue=p,u.formattedValue=null});let d=f=>{const{formattedValue:p}=u;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var b;if(u.focused)return;const{target:m}=p;u.userValue&&(m.value=u.userValue),u.lastCommittedValue=m.value,u.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(u.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const m={value(b){u.userValue=b.detail.value??"",t.setValue(e,{value:u.userValue.toString()}),b.target.value=u.userValue},formattedValue(b){const{formattedValue:A}=b.detail;u.formattedValue=A,A!=null&&b.target!==document.activeElement&&(b.target.value=A),t.setValue(e,{formattedValue:A})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var x;const{charLimit:A}=b.detail,{target:v}=b;if(A===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",A);let _=u.userValue;!_||_.length<=A||(_=_.slice(0,A),v.value=u.userValue=_,t.setValue(e,{value:_}),(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(m,p)}),s.addEventListener("keydown",p=>{var A;u.commitKey=1;let m=-1;if(p.key==="Escape"?m=0:p.key==="Enter"&&!this.data.multiLine?m=2:p.key==="Tab"&&(u.commitKey=3),m===-1)return;const{value:b}=p.target;u.lastCommittedValue!==b&&(u.lastCommittedValue=b,u.userValue=b,(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:m,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=d;d=null,s.addEventListener("blur",p=>{var b,A;if(!u.focused||!p.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(u.focused=!1);const{value:m}=p.target;u.userValue=m,u.lastCommittedValue!==m&&((A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:u.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",p=>{var C;u.lastCommittedValue=null;const{data:m,target:b}=p,{value:A,selectionStart:v,selectionEnd:_}=b;let x=v,S=_;switch(p.inputType){case"deleteWordBackward":{const T=A.substring(0,v).match(/\w*[^\w]*$/);T&&(x-=T[0].length);break}case"deleteWordForward":{const T=A.substring(v).match(/^[^\w]*\w*/);T&&(S+=T[0].length);break}case"deleteContentBackward":v===_&&(x-=1);break;case"deleteContentForward":v===_&&(S+=1);break}p.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,change:m||"",willCommit:!1,selStart:x,selEnd:S}})}),this._setEventListeners(s,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(d&&s.addEventListener("blur",d),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class eC extends Aa{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class sC extends Aa{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let i=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return ba.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=xu,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const h of this._getElementsByName(a,s)){const u=c&&h.exportValue===e.exportValue;h.domElement&&(h.domElement.checked=u),t.setValue(h.id,{value:u})}t.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=e.defaultFieldValue||"Off";o.target.checked=a===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class kv extends Aa{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let i=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(s,{value:i})),i)for(const o of this._getElementsByName(e.fieldName,s))t.setValue(o.id,{value:!1});const r=document.createElement("input");if(ba.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=xu,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const h of this._getElementsByName(a,s))t.setValue(h.id,{value:!1});t.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=e.defaultFieldValue;o.target.checked=a!=null&&a===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;r.addEventListener("updatefromsandbox",a=>{const c={value:h=>{const u=o===h.detail.value;for(const d of this._getElementsByName(h.target.name)){const f=u&&d.id===s;d.domElement&&(d.domElement.checked=f),t.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class iC extends Ev{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class nC extends Aa{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");ba.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=xu;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",u=>{const d=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===d});for(const u of this.data.options){const d=document.createElement("option");d.textContent=u.displayValue,d.value=u.exportValue,s.value.includes(u.exportValue)&&(d.setAttribute("selected",!0),r=!1),i.append(d)}let o=null;if(r){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),i.prepend(u),o=()=>{u.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=u=>{const d=u?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,m=>m.selected).map(m=>m[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=a(!1);const h=u=>{const d=u.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",u=>{const d={value(f){o==null||o();const p=f.detail.value,m=new Set(Array.isArray(p)?p:[p]);for(const b of i.options)b.selected=m.has(b.value);t.setValue(e,{value:a(!0)}),c=a(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,m=f.detail.remove;p[m].selected=!1,i.remove(m),p.length>0&&Array.prototype.findIndex.call(p,A=>A.selected)===-1&&(p[0].selected=!0),t.setValue(e,{value:a(!0),items:h(f)}),c=a(!1)},clear(f){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),c=a(!1)},insert(f){const{index:p,displayValue:m,exportValue:b}=f.detail.insert,A=i.children[p],v=document.createElement("option");v.textContent=m,v.value=b,A?A.before(v):i.append(v),t.setValue(e,{value:a(!0),items:h(f)}),c=a(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const m of p){const{displayValue:b,exportValue:A}=m,v=document.createElement("option");v.textContent=b,v.value=A,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:a(!0),items:h(f)}),c=a(!1)},indices(f){const p=new Set(f.detail.indices);for(const m of f.target.options)m.selected=p.has(m.index);t.setValue(e,{value:a(!0)}),c=a(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,u)}),i.addEventListener("input",u=>{var p;const d=a(!0),f=a(!1);t.setValue(e,{value:d}),u.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):i.addEventListener("input",function(u){t.setValue(e,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Xp extends le{constructor(t){const{data:e,elements:s}=t;super(t,{isRenderable:le._hasPopupData(e)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new rC({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",e.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(s=>`${om}${s}`).join(",")),this.container}}var Sl,tf,ef,xl,El,ne,xn,Cl,Nh,Oh,Tl,En,ci,Cn,$h,Tn,Bh,Bo,Ho,Bt,rd,Yp,Rv,Pv,Mv,Iv,od,ad,Kp;class rC{constructor({container:t,color:e,elements:s,titleObj:i,modificationDate:r,contentsObj:o,richText:a,parent:c,rect:h,parentRect:u,open:d}){y(this,Bt);y(this,Sl,w(this,Bt,Mv).bind(this));y(this,tf,w(this,Bt,Kp).bind(this));y(this,ef,w(this,Bt,ad).bind(this));y(this,xl,w(this,Bt,od).bind(this));y(this,El,null);y(this,ne,null);y(this,xn,null);y(this,Cl,null);y(this,Nh,null);y(this,Oh,null);y(this,Tl,null);y(this,En,!1);y(this,ci,null);y(this,Cn,null);y(this,$h,null);y(this,Tn,null);y(this,Bh,null);y(this,Bo,null);y(this,Ho,!1);var f;g(this,ne,t),g(this,Bh,i),g(this,xn,o),g(this,Tn,a),g(this,Oh,c),g(this,El,e),g(this,$h,h),g(this,Tl,u),g(this,Nh,s),g(this,Cl,cm.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",l(this,xl)),p.addEventListener("mouseenter",l(this,ef)),p.addEventListener("mouseleave",l(this,tf)),p.classList.add("popupTriggerArea");for(const p of s)(f=p.container)==null||f.addEventListener("keydown",l(this,Sl));l(this,ne).hidden=!0,d&&w(this,Bt,od).call(this)}render(){if(l(this,ci))return;const t=g(this,ci,document.createElement("div"));if(t.className="popup",l(this,El)){const r=t.style.outlineColor=st.makeHexColor(...l(this,El));t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const e=document.createElement("span");e.className="header";const s=document.createElement("h1");if(e.append(s),{dir:s.dir,str:s.textContent}=l(this,Bh),t.append(e),l(this,Cl)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,Cl).valueOf()})),e.append(r)}const i=l(this,Bt,rd);if(i)xv.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,xn));t.append(r)}l(this,ne).append(t)}_formatContents({str:t,dir:e}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let r=0,o=i.length;r<o;++r){const a=i[r];s.append(document.createTextNode(a)),r<o-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:t,popupContent:e}){var s;l(this,Bo)||g(this,Bo,{contentsObj:l(this,xn),richText:l(this,Tn)}),t&&g(this,Cn,null),e&&(g(this,Tn,w(this,Bt,Pv).call(this,e)),g(this,xn,null)),(s=l(this,ci))==null||s.remove(),g(this,ci,null)}resetEdited(){var t;l(this,Bo)&&({contentsObj:Ke(this,xn)._,richText:Ke(this,Tn)._}=l(this,Bo),g(this,Bo,null),(t=l(this,ci))==null||t.remove(),g(this,ci,null),g(this,Cn,null))}forceHide(){g(this,Ho,this.isVisible),l(this,Ho)&&(l(this,ne).hidden=!0)}maybeShow(){l(this,Ho)&&(l(this,ci)||w(this,Bt,ad).call(this),g(this,Ho,!1),l(this,ne).hidden=!1)}get isVisible(){return l(this,ne).hidden===!1}}Sl=new WeakMap,tf=new WeakMap,ef=new WeakMap,xl=new WeakMap,El=new WeakMap,ne=new WeakMap,xn=new WeakMap,Cl=new WeakMap,Nh=new WeakMap,Oh=new WeakMap,Tl=new WeakMap,En=new WeakMap,ci=new WeakMap,Cn=new WeakMap,$h=new WeakMap,Tn=new WeakMap,Bh=new WeakMap,Bo=new WeakMap,Ho=new WeakMap,Bt=new WeakSet,rd=function(){const t=l(this,Tn),e=l(this,xn);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&l(this,Tn).html||null},Yp=function(){var t,e,s;return((s=(e=(t=l(this,Bt,rd))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:s.fontSize)||0},Rv=function(){var t,e,s;return((s=(e=(t=l(this,Bt,rd))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:s.color)||null},Pv=function(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:l(this,Bt,Rv),fontSize:l(this,Bt,Yp)?`calc(${l(this,Bt,Yp)}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:i});return s},Mv=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&l(this,En))&&w(this,Bt,od).call(this)},Iv=function(){if(l(this,Cn)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:i,pageY:r}}}=l(this,Oh);let o=!!l(this,Tl),a=o?l(this,Tl):l(this,$h);for(const m of l(this,Nh))if(!a||st.intersect(m.data.rect,a)!==null){a=m.data.rect,o=!0;break}const c=st.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),u=o?a[2]-a[0]+5:0,d=c[0]+u,f=c[1];g(this,Cn,[100*(d-i)/e,100*(f-r)/s]);const{style:p}=l(this,ne);p.left=`${l(this,Cn)[0]}%`,p.top=`${l(this,Cn)[1]}%`},od=function(){g(this,En,!l(this,En)),l(this,En)?(w(this,Bt,ad).call(this),l(this,ne).addEventListener("click",l(this,xl)),l(this,ne).addEventListener("keydown",l(this,Sl))):(w(this,Bt,Kp).call(this),l(this,ne).removeEventListener("click",l(this,xl)),l(this,ne).removeEventListener("keydown",l(this,Sl)))},ad=function(){l(this,ci)||this.render(),this.isVisible?l(this,En)&&l(this,ne).classList.add("focused"):(w(this,Bt,Iv).call(this),l(this,ne).hidden=!1,l(this,ne).style.zIndex=parseInt(l(this,ne).style.zIndex)+1e3)},Kp=function(){l(this,ne).classList.remove("focused"),!(l(this,En)||!this.isVisible)&&(l(this,ne).hidden=!0,l(this,ne).style.zIndex=parseInt(l(this,ne).style.zIndex)-1e3)};class Lv extends le{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=dt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Hh;class oC extends le{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,Hh,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=g(this,Hh,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Hh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hh=new WeakMap;var zh;class aC extends le{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,zh,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=e.borderStyle.width,a=g(this,zh,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",s-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,zh)}addHighlightArea(){this.container.classList.add("highlightArea")}}zh=new WeakMap;var Uh;class lC extends le{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,Uh,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=e.borderStyle.width,a=g(this,Uh,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",i/2),a.setAttribute("rx",s/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Uh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Uh=new WeakMap;var Vh;class Dv extends le{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,Vh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:s,borderStyle:i,popupRef:r},width:o,height:a}=this;if(!s)return this.container;const c=this.svgFactory.create(o,a,!0);let h=[];for(let d=0,f=s.length;d<f;d+=2){const p=s[d]-e[0],m=e[3]-s[d+1];h.push(`${p},${m}`)}h=h.join(" ");const u=g(this,Vh,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",h),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),c.append(u),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Vh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Vh=new WeakMap;class cC extends Dv{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class hC extends le{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var jh,zo,Gh,Zp;class gm extends le{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,Gh);y(this,jh,null);y(this,zo,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?dt.HIGHLIGHT:dt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:s,inkLists:i,borderStyle:r,popupRef:o}}=this,{transform:a,width:c,height:h}=w(this,Gh,Zp).call(this,s,e),u=this.svgFactory.create(c,h,!0),d=g(this,jh,this.svgFactory.createElement("svg:g"));u.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",a);for(let f=0,p=i.length;f<p;f++){const m=this.svgFactory.createElement(this.svgElementName);l(this,zo).push(m),m.setAttribute("points",i[f].join(",")),d.append(m)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:s,points:i,rect:r}=e,o=l(this,jh);if(s>=0&&o.setAttribute("stroke-width",s||1),i)for(let a=0,c=l(this,zo).length;a<c;a++)l(this,zo)[a].setAttribute("points",i[a].join(","));if(r){const{transform:a,width:c,height:h}=w(this,Gh,Zp).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return l(this,zo)}addHighlightArea(){this.container.classList.add("highlightArea")}}jh=new WeakMap,zo=new WeakMap,Gh=new WeakSet,Zp=function(e,s){switch(e){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class Fv extends le{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=dt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class uC extends le{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class dC extends le{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class fC extends le{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Nv extends le{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=dt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Wh,qh,Qp;class pC extends le{constructor(e){var i;super(e,{isRenderable:!0});y(this,qh);y(this,Wh,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",w(this,qh,Qp).bind(this)),g(this,Wh,i);const{isMac:r}=$e.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&w(this,qh,Qp).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return l(this,Wh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wh=new WeakMap,qh=new WeakSet,Qp=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var Xh,Uo,_r,Yh,Vr,tg,eg;const _m=class _m{constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:o,structTreeLayer:a}){y(this,Vr);y(this,Xh,null);y(this,Uo,null);y(this,_r,new Map);y(this,Yh,null);this.div=t,g(this,Xh,e),g(this,Uo,s),g(this,Yh,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,_r).size>0}async render(t){var o;const{annotations:e}=t,s=this.div;ga(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Od,annotationStorage:t.annotationStorage||new dm,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const c=a.annotationType===he.POPUP;if(c){const d=i.get(a.id);if(!d)continue;r.elements=d}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const h=Bb.create(r);if(!h.isRenderable)continue;if(!c&&a.popupRef){const d=i.get(a.popupRef);d?d.push(h):i.set(a.popupRef,[h])}const u=h.render();a.hidden&&(u.style.visibility="hidden"),await w(this,Vr,tg).call(this,u,a.id),h._isEditable&&(l(this,_r).set(h.data.id,h),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(h))}w(this,Vr,eg).call(this)}async addLinkAnnotations(t,e){const s={data:null,layer:this.div,linkService:e,svgFactory:new Od,parent:this};for(const i of t){i.borderStyle||(i.borderStyle=_m._defaultBorderStyle),s.data=i;const r=Bb.create(s);if(!r.isRenderable)continue;const o=r.render();await w(this,Vr,tg).call(this,o,i.id)}}update({viewport:t}){const e=this.div;this.viewport=t,ga(e,{rotation:t.rotation}),w(this,Vr,eg).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(l(this,_r).values())}getEditableAnnotation(t){return l(this,_r).get(t)}static get _defaultBorderStyle(){return _t(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ea.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Xh=new WeakMap,Uo=new WeakMap,_r=new WeakMap,Yh=new WeakMap,Vr=new WeakSet,tg=async function(t,e){var o,a;const s=t.firstChild||t,i=s.id=`${om}${e}`,r=await((o=l(this,Yh))==null?void 0:o.getAriaAttributes(i));if(r)for(const[c,h]of r)s.setAttribute(c,h);this.div.append(t),(a=l(this,Xh))==null||a.moveElementInDOM(this.div,t,s,!1)},eg=function(){var e;if(!l(this,Uo))return;const t=this.div;for(const[s,i]of l(this,Uo)){const r=t.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):r.append(i);const a=l(this,_r).get(s);a&&(a._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(s,r.id,i),a._hasNoCanvas=!1):a.canvas=i)}l(this,Uo).clear()};let Jp=_m;const $u=/\r\n?|\n/g;var hi,Ss,Kh,Vo,xs,ge,Ov,$v,Bv,ld,Un,cd,hd,Hv,ig,zv;const Gt=class Gt extends te{constructor(e){super({...e,name:"freeTextEditor"});y(this,ge);y(this,hi);y(this,Ss,"");y(this,Kh,`${this.id}-editor`);y(this,Vo,null);y(this,xs);g(this,hi,e.color||Gt._defaultColor||te._defaultLineColor),g(this,xs,e.fontSize||Gt._defaultFontSize)}static get _keyboardManager(){const e=Gt.prototype,s=o=>o.isEmpty(),i=ma.TRANSLATE_SMALL,r=ma.TRANSLATE_BIG;return _t(this,"_keyboardManager",new _u([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(e,s){te.initialize(e,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,s){switch(e){case St.FREETEXT_SIZE:Gt._defaultFontSize=s;break;case St.FREETEXT_COLOR:Gt._defaultColor=s;break}}updateParams(e,s){switch(e){case St.FREETEXT_SIZE:w(this,ge,Ov).call(this,s);break;case St.FREETEXT_COLOR:w(this,ge,$v).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[St.FREETEXT_SIZE,Gt._defaultFontSize],[St.FREETEXT_COLOR,Gt._defaultColor||te._defaultLineColor]]}get propertiesToUpdate(){return[[St.FREETEXT_SIZE,l(this,xs)],[St.FREETEXT_COLOR,l(this,hi)]]}_translateEmpty(e,s){this._uiManager.translateSelectedEditors(e,s,!0)}getInitialTranslation(){const e=this.parentScale;return[-Gt._internalPadding*e,-(Gt._internalPadding+l(this,xs))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(dt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,Vo,new AbortController);const e=this._uiManager.combinedSignal(l(this,Vo));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,Kh)),this._isDraggable=!0,(e=l(this,Vo))==null||e.abort(),g(this,Vo,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var s;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=l(this,Ss),s=g(this,Ss,w(this,ge,Bv).call(this).trimEnd());if(e===s)return;const i=r=>{if(g(this,Ss,r),!r){this.remove();return}w(this,ge,hd).call(this),this._uiManager.rebuild(this),w(this,ge,ld).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(e)},mustExec:!1}),w(this,ge,ld).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Gt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,s;(this._isCopy||this.annotationElementId)&&(e=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,Kh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,xs)}px * var(--total-scale-factor))`,i.color=l(this,hi),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),um(this,this.div,["dblclick","keydown"]),this._isCopy||this.annotationElementId){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[u,d]=this.pageDimensions,[f,p]=this.pageTranslation;let m,b;switch(this.rotation){case 0:m=e+(a[0]-f)/u,b=s+this.height-(a[1]-p)/d;break;case 90:m=e+(a[0]-f)/u,b=s-(a[1]-p)/d,[c,h]=[h,-c];break;case 180:m=e-this.width+(a[0]-f)/u,b=s-(a[1]-p)/d,[c,h]=[-c,-h];break;case 270:m=e+(a[0]-f-this.height*d)/u,b=s+(a[1]-p-this.width*u)/d,[c,h]=[-h,c];break}this.setAt(m*r,b*o,c,h)}else this._moveAfterPaste(e,s);w(this,ge,hd).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var m,b,A;const s=e.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const r=w(m=Gt,Un,ig).call(m,s.getData("text")||"").replaceAll($u,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:h}=a,u=[],d=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(d.push(c.nodeValue.slice(h).replaceAll($u,"")),v!==this.editorDiv){let _=u;for(const x of this.editorDiv.childNodes){if(x===v){_=d;continue}_.push(w(b=Gt,Un,cd).call(b,x))}}u.push(c.nodeValue.slice(0,h).replaceAll($u,""))}else if(c===this.editorDiv){let v=u,_=0;for(const x of this.editorDiv.childNodes)_++===h&&(v=d),v.push(w(A=Gt,Un,cd).call(A,x))}g(this,Ss,`${u.join(`
`)}${r}${d.join(`
`)}`),w(this,ge,hd).call(this);const f=new Range;let p=u.reduce((v,_)=>v+_.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const _=v.nodeValue.length;if(p<=_){f.setStart(v,p),f.setEnd(v,p);break}p-=_}o.removeAllRanges(),o.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(e,s,i){var a;let r=null;if(e instanceof Lv){const{data:{defaultAppearanceData:{fontSize:c,fontColor:h},rect:u,rotation:d,id:f,popupRef:p},textContent:m,textPosition:b,parent:{page:{pageNumber:A}}}=e;if(!m||m.length===0)return null;r=e={annotationType:dt.FREETEXT,color:Array.from(h),fontSize:c,value:m.join(`
`),position:b,pageIndex:A-1,rect:u.slice(0),rotation:d,id:f,deleted:!1,popupRef:p}}const o=await super.deserialize(e,s,i);return g(o,xs,e.fontSize),g(o,hi,st.makeHexColor(...e.color)),g(o,Ss,w(a=Gt,Un,ig).call(a,e.value)),o.annotationElementId=e.id||null,o._initialData=r,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Gt._internalPadding*this.parentScale,i=this.getRect(s,s),r=te._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,hi)),o={annotationType:dt.FREETEXT,color:r,fontSize:l(this,xs),value:w(this,ge,Hv).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(o.isCopy=!0,o):this.annotationElementId&&!w(this,ge,zv).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const s=super.renderAnnotationElement(e);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,xs)}px * var(--total-scale-factor))`,i.color=l(this,hi),s.replaceChildren();for(const o of l(this,Ss).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),s.append(a)}const r=Gt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:l(this,Ss)}),s}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};hi=new WeakMap,Ss=new WeakMap,Kh=new WeakMap,Vo=new WeakMap,xs=new WeakMap,ge=new WeakSet,Ov=function(e){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-l(this,xs))*this.parentScale),g(this,xs,r),w(this,ge,ld).call(this)},i=l(this,xs);this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},$v=function(e){const s=r=>{g(this,hi,this.editorDiv.style.color=r)},i=l(this,hi);this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Bv=function(){var i;const e=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(w(i=Gt,Un,cd).call(i,r)),s=r);return e.join(`
`)},ld=function(){const[e,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/s):(this.width=i.height/e,this.height=i.width/s),this.fixAndSetPosition()},Un=new WeakSet,cd=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll($u,"")},hd=function(){if(this.editorDiv.replaceChildren(),!!l(this,Ss))for(const e of l(this,Ss).split(`
`)){const s=document.createElement("div");s.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(s)}},Hv=function(){return l(this,Ss).replaceAll(""," ")},ig=function(e){return e.replaceAll(" ","")},zv=function(e){const{value:s,fontSize:i,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==s||e.fontSize!==i||e.color.some((a,c)=>a!==r[c])||e.pageIndex!==o},y(Gt,Un),U(Gt,"_freeTextDefaultContent",""),U(Gt,"_internalPadding",0),U(Gt,"_defaultColor",null),U(Gt,"_defaultFontSize",10),U(Gt,"_type","freetext"),U(Gt,"_editorType",dt.FREETEXT);let sg=Gt;class Q{toSVGPath(){$t("Abstract method `toSVGPath` must be implemented.")}get box(){$t("Abstract getter `box` must be implemented.")}serialize(t,e){$t("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,i,r,o){o||(o=new Float32Array(t.length));for(let a=0,c=t.length;a<c;a+=2)o[a]=e+t[a]*i,o[a+1]=s+t[a+1]*r;return o}static _rescaleAndSwap(t,e,s,i,r,o){o||(o=new Float32Array(t.length));for(let a=0,c=t.length;a<c;a+=2)o[a]=e+t[a+1]*i,o[a+1]=s+t[a]*r;return o}static _translate(t,e,s,i){i||(i=new Float32Array(t.length));for(let r=0,o=t.length;r<o;r+=2)i[r]=e+t[r],i[r+1]=s+t[r+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,i,r){switch(r){case 90:return[1-e/s,t/i];case 180:return[1-t/s,1-e/i];case 270:return[e/s,1-t/i];default:return[t/s,e/i]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,i,r,o){return[(t+5*s)/6,(e+5*i)/6,(5*s+r)/6,(5*i+o)/6,(s+r)/2,(i+o)/2]}}U(Q,"PRECISION",1e-4);var Es,ui,kl,Rl,Wi,vt,jo,Go,Zh,Qh,Pl,Ml,Sr,Jh,sf,nf,ve,_c,Uv,Vv,jv,Gv,Wv,qv;const ln=class ln{constructor({x:t,y:e},s,i,r,o,a=0){y(this,ve);y(this,Es);y(this,ui,[]);y(this,kl);y(this,Rl);y(this,Wi,[]);y(this,vt,new Float32Array(18));y(this,jo);y(this,Go);y(this,Zh);y(this,Qh);y(this,Pl);y(this,Ml);y(this,Sr,[]);g(this,Es,s),g(this,Ml,r*i),g(this,Rl,o),l(this,vt).set([NaN,NaN,NaN,NaN,t,e],6),g(this,kl,a),g(this,Qh,l(ln,Jh)*i),g(this,Zh,l(ln,nf)*i),g(this,Pl,i),l(this,Sr).push(t,e)}isEmpty(){return isNaN(l(this,vt)[8])}add({x:t,y:e}){var P;g(this,jo,t),g(this,Go,e);const[s,i,r,o]=l(this,Es);let[a,c,h,u]=l(this,vt).subarray(8,12);const d=t-h,f=e-u,p=Math.hypot(d,f);if(p<l(this,Zh))return!1;const m=p-l(this,Qh),b=m/p,A=b*d,v=b*f;let _=a,x=c;a=h,c=u,h+=A,u+=v,(P=l(this,Sr))==null||P.push(t,e);const S=-v/m,C=A/m,T=S*l(this,Ml),R=C*l(this,Ml);return l(this,vt).set(l(this,vt).subarray(2,8),0),l(this,vt).set([h+T,u+R],4),l(this,vt).set(l(this,vt).subarray(14,18),12),l(this,vt).set([h-T,u-R],16),isNaN(l(this,vt)[6])?(l(this,Wi).length===0&&(l(this,vt).set([a+T,c+R],2),l(this,Wi).push(NaN,NaN,NaN,NaN,(a+T-s)/r,(c+R-i)/o),l(this,vt).set([a-T,c-R],14),l(this,ui).push(NaN,NaN,NaN,NaN,(a-T-s)/r,(c-R-i)/o)),l(this,vt).set([_,x,a,c,h,u],6),!this.isEmpty()):(l(this,vt).set([_,x,a,c,h,u],6),Math.abs(Math.atan2(x-c,_-a)-Math.atan2(v,A))<Math.PI/2?([a,c,h,u]=l(this,vt).subarray(2,6),l(this,Wi).push(NaN,NaN,NaN,NaN,((a+h)/2-s)/r,((c+u)/2-i)/o),[a,c,_,x]=l(this,vt).subarray(14,18),l(this,ui).push(NaN,NaN,NaN,NaN,((_+a)/2-s)/r,((x+c)/2-i)/o),!0):([_,x,a,c,h,u]=l(this,vt).subarray(0,6),l(this,Wi).push(((_+5*a)/6-s)/r,((x+5*c)/6-i)/o,((5*a+h)/6-s)/r,((5*c+u)/6-i)/o,((a+h)/2-s)/r,((c+u)/2-i)/o),[h,u,a,c,_,x]=l(this,vt).subarray(12,18),l(this,ui).push(((_+5*a)/6-s)/r,((x+5*c)/6-i)/o,((5*a+h)/6-s)/r,((5*c+u)/6-i)/o,((a+h)/2-s)/r,((c+u)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=l(this,Wi),e=l(this,ui);if(isNaN(l(this,vt)[6])&&!this.isEmpty())return w(this,ve,Uv).call(this);const s=[];s.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);w(this,ve,jv).call(this,s);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return w(this,ve,Vv).call(this,s),s.join(" ")}newFreeDrawOutline(t,e,s,i,r,o){return new Xv(t,e,s,i,r,o)}getOutlines(){var d;const t=l(this,Wi),e=l(this,ui),s=l(this,vt),[i,r,o,a]=l(this,Es),c=new Float32Array((((d=l(this,Sr))==null?void 0:d.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(l(this,Sr)[f]-i)/o,c[f+1]=(l(this,Sr)[f+1]-r)/a;if(c[c.length-2]=(l(this,jo)-i)/o,c[c.length-1]=(l(this,Go)-r)/a,isNaN(s[6])&&!this.isEmpty())return w(this,ve,Gv).call(this,c);const h=new Float32Array(l(this,Wi).length+24+l(this,ui).length);let u=t.length;for(let f=0;f<u;f+=2){if(isNaN(t[f])){h[f]=h[f+1]=NaN;continue}h[f]=t[f],h[f+1]=t[f+1]}u=w(this,ve,qv).call(this,h,u);for(let f=e.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(e[f+p])){h[u]=h[u+1]=NaN,u+=2;continue}h[u]=e[f+p],h[u+1]=e[f+p+1],u+=2}return w(this,ve,Wv).call(this,h,u),this.newFreeDrawOutline(h,c,l(this,Es),l(this,Pl),l(this,kl),l(this,Rl))}};Es=new WeakMap,ui=new WeakMap,kl=new WeakMap,Rl=new WeakMap,Wi=new WeakMap,vt=new WeakMap,jo=new WeakMap,Go=new WeakMap,Zh=new WeakMap,Qh=new WeakMap,Pl=new WeakMap,Ml=new WeakMap,Sr=new WeakMap,Jh=new WeakMap,sf=new WeakMap,nf=new WeakMap,ve=new WeakSet,_c=function(){const t=l(this,vt).subarray(4,6),e=l(this,vt).subarray(16,18),[s,i,r,o]=l(this,Es);return[(l(this,jo)+(t[0]-e[0])/2-s)/r,(l(this,Go)+(t[1]-e[1])/2-i)/o,(l(this,jo)+(e[0]-t[0])/2-s)/r,(l(this,Go)+(e[1]-t[1])/2-i)/o]},Uv=function(){const[t,e,s,i]=l(this,Es),[r,o,a,c]=w(this,ve,_c).call(this);return`M${(l(this,vt)[2]-t)/s} ${(l(this,vt)[3]-e)/i} L${(l(this,vt)[4]-t)/s} ${(l(this,vt)[5]-e)/i} L${r} ${o} L${a} ${c} L${(l(this,vt)[16]-t)/s} ${(l(this,vt)[17]-e)/i} L${(l(this,vt)[14]-t)/s} ${(l(this,vt)[15]-e)/i} Z`},Vv=function(t){const e=l(this,ui);t.push(`L${e[4]} ${e[5]} Z`)},jv=function(t){const[e,s,i,r]=l(this,Es),o=l(this,vt).subarray(4,6),a=l(this,vt).subarray(16,18),[c,h,u,d]=w(this,ve,_c).call(this);t.push(`L${(o[0]-e)/i} ${(o[1]-s)/r} L${c} ${h} L${u} ${d} L${(a[0]-e)/i} ${(a[1]-s)/r}`)},Gv=function(t){const e=l(this,vt),[s,i,r,o]=l(this,Es),[a,c,h,u]=w(this,ve,_c).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(e[2]-s)/r,(e[3]-i)/o,NaN,NaN,NaN,NaN,(e[4]-s)/r,(e[5]-i)/o,NaN,NaN,NaN,NaN,a,c,NaN,NaN,NaN,NaN,h,u,NaN,NaN,NaN,NaN,(e[16]-s)/r,(e[17]-i)/o,NaN,NaN,NaN,NaN,(e[14]-s)/r,(e[15]-i)/o],0),this.newFreeDrawOutline(d,t,l(this,Es),l(this,Pl),l(this,kl),l(this,Rl))},Wv=function(t,e){const s=l(this,ui);return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6},qv=function(t,e){const s=l(this,vt).subarray(4,6),i=l(this,vt).subarray(16,18),[r,o,a,c]=l(this,Es),[h,u,d,f]=w(this,ve,_c).call(this);return t.set([NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/c,NaN,NaN,NaN,NaN,h,u,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/c],e),e+=24},y(ln,Jh,8),y(ln,sf,2),y(ln,nf,l(ln,Jh)+l(ln,sf));let $d=ln;var Il,Wo,kn,tu,Cs,eu,ae,rf,Yv;class Xv extends Q{constructor(e,s,i,r,o,a){super();y(this,rf);y(this,Il);y(this,Wo,new Float32Array(4));y(this,kn);y(this,tu);y(this,Cs);y(this,eu);y(this,ae);g(this,ae,e),g(this,Cs,s),g(this,Il,i),g(this,eu,r),g(this,kn,o),g(this,tu,a),this.lastPoint=[NaN,NaN],w(this,rf,Yv).call(this,a);const[c,h,u,d]=l(this,Wo);for(let f=0,p=e.length;f<p;f+=2)e[f]=(e[f]-c)/u,e[f+1]=(e[f+1]-h)/d;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/u,s[f+1]=(s[f+1]-h)/d}toSVGPath(){const e=[`M${l(this,ae)[4]} ${l(this,ae)[5]}`];for(let s=6,i=l(this,ae).length;s<i;s+=6){if(isNaN(l(this,ae)[s])){e.push(`L${l(this,ae)[s+4]} ${l(this,ae)[s+5]}`);continue}e.push(`C${l(this,ae)[s]} ${l(this,ae)[s+1]} ${l(this,ae)[s+2]} ${l(this,ae)[s+3]} ${l(this,ae)[s+4]} ${l(this,ae)[s+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,s,i,r],o){const a=i-e,c=r-s;let h,u;switch(o){case 0:h=Q._rescale(l(this,ae),e,r,a,-c),u=Q._rescale(l(this,Cs),e,r,a,-c);break;case 90:h=Q._rescaleAndSwap(l(this,ae),e,s,a,c),u=Q._rescaleAndSwap(l(this,Cs),e,s,a,c);break;case 180:h=Q._rescale(l(this,ae),i,s,-a,c),u=Q._rescale(l(this,Cs),i,s,-a,c);break;case 270:h=Q._rescaleAndSwap(l(this,ae),i,r,-a,-c),u=Q._rescaleAndSwap(l(this,Cs),i,r,-a,-c);break}return{outline:Array.from(h),points:[Array.from(u)]}}get box(){return l(this,Wo)}newOutliner(e,s,i,r,o,a=0){return new $d(e,s,i,r,o,a)}getNewOutline(e,s){const[i,r,o,a]=l(this,Wo),[c,h,u,d]=l(this,Il),f=o*u,p=a*d,m=i*u+c,b=r*d+h,A=this.newOutliner({x:l(this,Cs)[0]*f+m,y:l(this,Cs)[1]*p+b},l(this,Il),l(this,eu),e,l(this,tu),s??l(this,kn));for(let v=2;v<l(this,Cs).length;v+=2)A.add({x:l(this,Cs)[v]*f+m,y:l(this,Cs)[v+1]*p+b});return A.getOutlines()}}Il=new WeakMap,Wo=new WeakMap,kn=new WeakMap,tu=new WeakMap,Cs=new WeakMap,eu=new WeakMap,ae=new WeakMap,rf=new WeakSet,Yv=function(e){const s=l(this,ae);let i=s[4],r=s[5],o=i,a=r,c=i,h=r,u=i,d=r;const f=e?Math.max:Math.min;for(let m=6,b=s.length;m<b;m+=6){if(isNaN(s[m]))o=Math.min(o,s[m+4]),a=Math.min(a,s[m+5]),c=Math.max(c,s[m+4]),h=Math.max(h,s[m+5]),d<s[m+5]?(u=s[m+4],d=s[m+5]):d===s[m+5]&&(u=f(u,s[m+4]));else{const A=st.bezierBoundingBox(i,r,...s.slice(m,m+6));o=Math.min(o,A[0]),a=Math.min(a,A[1]),c=Math.max(c,A[2]),h=Math.max(h,A[3]),d<A[3]?(u=A[2],d=A[3]):d===A[3]&&(u=f(u,A[2]))}i=s[m+4],r=s[m+5]}const p=l(this,Wo);p[0]=o-l(this,kn),p[1]=a-l(this,kn),p[2]=c-o+2*l(this,kn),p[3]=h-a+2*l(this,kn),this.lastPoint=[u,d]};var su,iu,xr,di,as,Kv,ud,Zv,Qv,rg;class ng{constructor(t,e=0,s=0,i=!0){y(this,as);y(this,su);y(this,iu);y(this,xr,[]);y(this,di,[]);let r=1/0,o=-1/0,a=1/0,c=-1/0;const h=10**-4;for(const{x:A,y:v,width:_,height:x}of t){const S=Math.floor((A-e)/h)*h,C=Math.ceil((A+_+e)/h)*h,T=Math.floor((v-e)/h)*h,R=Math.ceil((v+x+e)/h)*h,L=[S,T,R,!0],P=[C,T,R,!1];l(this,xr).push(L,P),r=Math.min(r,S),o=Math.max(o,C),a=Math.min(a,T),c=Math.max(c,R)}const u=o-r+2*s,d=c-a+2*s,f=r-s,p=a-s,m=l(this,xr).at(i?-1:-2),b=[m[0],m[2]];for(const A of l(this,xr)){const[v,_,x]=A;A[0]=(v-f)/u,A[1]=(_-p)/d,A[2]=(x-p)/d}g(this,su,new Float32Array([f,p,u,d])),g(this,iu,b)}getOutlines(){l(this,xr).sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of l(this,xr))e[3]?(t.push(...w(this,as,rg).call(this,e)),w(this,as,Zv).call(this,e)):(w(this,as,Qv).call(this,e),t.push(...w(this,as,rg).call(this,e)));return w(this,as,Kv).call(this,t)}}su=new WeakMap,iu=new WeakMap,xr=new WeakMap,di=new WeakMap,as=new WeakSet,Kv=function(t){const e=[],s=new Set;for(const o of t){const[a,c,h]=o;e.push([a,c,o],[a,h,o])}e.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=e.length;o<a;o+=2){const c=e[o][2],h=e[o+1][2];c.push(h),h.push(c),s.add(c),s.add(h)}const i=[];let r;for(;s.size>0;){const o=s.values().next().value;let[a,c,h,u,d]=o;s.delete(o);let f=a,p=c;for(r=[a,h],i.push(r);;){let m;if(s.has(u))m=u;else if(s.has(d))m=d;else break;s.delete(m),[a,c,h,u,d]=m,f!==a&&(r.push(f,p,a,p===c?c:h),f=a),p=p===c?h:c}r.push(f,p)}return new gC(i,l(this,su),l(this,iu))},ud=function(t){const e=l(this,di);let s=0,i=e.length-1;for(;s<=i;){const r=s+i>>1,o=e[r][0];if(o===t)return r;o<t?s=r+1:i=r-1}return i+1},Zv=function([,t,e]){const s=w(this,as,ud).call(this,t);l(this,di).splice(s,0,[t,e])},Qv=function([,t,e]){const s=w(this,as,ud).call(this,t);for(let i=s;i<l(this,di).length;i++){const[r,o]=l(this,di)[i];if(r!==t)break;if(r===t&&o===e){l(this,di).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,o]=l(this,di)[i];if(r!==t)break;if(r===t&&o===e){l(this,di).splice(i,1);return}}},rg=function(t){const[e,s,i]=t,r=[[e,s,i]],o=w(this,as,ud).call(this,i);for(let a=0;a<o;a++){const[c,h]=l(this,di)[a];for(let u=0,d=r.length;u<d;u++){const[,f,p]=r[u];if(!(h<=f||p<=c)){if(f>=c){if(p>h)r[u][1]=h;else{if(d===1)return[];r.splice(u,1),u--,d--}continue}r[u][2]=c,p>h&&r.push([e,h,p])}}}return r};var nu,Ll;class gC extends Q{constructor(e,s,i){super();y(this,nu);y(this,Ll);g(this,Ll,e),g(this,nu,s),this.lastPoint=i}toSVGPath(){const e=[];for(const s of l(this,Ll)){let[i,r]=s;e.push(`M${i} ${r}`);for(let o=2;o<s.length;o+=2){const a=s[o],c=s[o+1];a===i?(e.push(`V${c}`),r=c):c===r&&(e.push(`H${a}`),i=a)}e.push("Z")}return e.join(" ")}serialize([e,s,i,r],o){const a=[],c=i-e,h=r-s;for(const u of l(this,Ll)){const d=new Array(u.length);for(let f=0;f<u.length;f+=2)d[f]=e+u[f]*c,d[f+1]=r-u[f+1]*h;a.push(d)}return a}get box(){return l(this,nu)}get classNamesForOutlining(){return["highlightOutline"]}}nu=new WeakMap,Ll=new WeakMap;class og extends $d{newFreeDrawOutline(t,e,s,i,r,o){return new mC(t,e,s,i,r,o)}}class mC extends Xv{newOutliner(t,e,s,i,r,o=0){return new og(t,e,s,i,r,o)}}var fi,qo,Dl,we,ru,Fl,ou,au,Er,pi,Nl,lu,Ot,ag,lg,cg,Qr,Jv,Kn;const hs=class hs{constructor({editor:t=null,uiManager:e=null}){y(this,Ot);y(this,fi,null);y(this,qo,null);y(this,Dl);y(this,we,null);y(this,ru,!1);y(this,Fl,!1);y(this,ou,null);y(this,au);y(this,Er,null);y(this,pi,null);y(this,Nl);var s;t?(g(this,Fl,!1),g(this,Nl,St.HIGHLIGHT_COLOR),g(this,ou,t)):(g(this,Fl,!0),g(this,Nl,St.HIGHLIGHT_DEFAULT_COLOR)),g(this,pi,(t==null?void 0:t._uiManager)||e),g(this,au,l(this,pi)._eventBus),g(this,Dl,(t==null?void 0:t.color)||((s=l(this,pi))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(hs,lu)||g(hs,lu,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return _t(this,"_keyboardManager",new _u([[["Escape","mac+Escape"],hs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],hs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],hs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],hs.prototype._moveToPrevious],[["Home","mac+Home"],hs.prototype._moveToBeginning],[["End","mac+End"],hs.prototype._moveToEnd]]))}renderButton(){const t=g(this,fi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=l(this,pi)._signal;t.addEventListener("click",w(this,Ot,Qr).bind(this),{signal:e}),t.addEventListener("keydown",w(this,Ot,cg).bind(this),{signal:e});const s=g(this,qo,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,Dl),t.append(s),t}renderMainDropdown(){const t=g(this,we,w(this,Ot,ag).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===l(this,fi)){w(this,Ot,Qr).call(this,t);return}const e=t.target.getAttribute("data-color");e&&w(this,Ot,lg).call(this,e,t)}_moveToNext(t){var e,s;if(!l(this,Ot,Kn)){w(this,Ot,Qr).call(this,t);return}if(t.target===l(this,fi)){(e=l(this,we).firstChild)==null||e.focus();return}(s=t.target.nextSibling)==null||s.focus()}_moveToPrevious(t){var e,s;if(t.target===((e=l(this,we))==null?void 0:e.firstChild)||t.target===l(this,fi)){l(this,Ot,Kn)&&this._hideDropdownFromKeyboard();return}l(this,Ot,Kn)||w(this,Ot,Qr).call(this,t),(s=t.target.previousSibling)==null||s.focus()}_moveToBeginning(t){var e;if(!l(this,Ot,Kn)){w(this,Ot,Qr).call(this,t);return}(e=l(this,we).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!l(this,Ot,Kn)){w(this,Ot,Qr).call(this,t);return}(e=l(this,we).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=l(this,we))==null||t.classList.add("hidden"),(e=l(this,Er))==null||e.abort(),g(this,Er,null)}_hideDropdownFromKeyboard(){var t;if(!l(this,Fl)){if(!l(this,Ot,Kn)){(t=l(this,ou))==null||t.unselect();return}this.hideDropdown(),l(this,fi).focus({preventScroll:!0,focusVisible:l(this,ru)})}}updateColor(t){if(l(this,qo)&&(l(this,qo).style.backgroundColor=t),!l(this,we))return;const e=l(this,pi).highlightColors.values();for(const s of l(this,we).children)s.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=l(this,fi))==null||t.remove(),g(this,fi,null),g(this,qo,null),(e=l(this,we))==null||e.remove(),g(this,we,null)}};fi=new WeakMap,qo=new WeakMap,Dl=new WeakMap,we=new WeakMap,ru=new WeakMap,Fl=new WeakMap,ou=new WeakMap,au=new WeakMap,Er=new WeakMap,pi=new WeakMap,Nl=new WeakMap,lu=new WeakMap,Ot=new WeakSet,ag=function(){const t=document.createElement("div"),e=l(this,pi)._signal;t.addEventListener("contextmenu",Si,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,pi).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(hs,lu)[s]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,Dl)),r.addEventListener("click",w(this,Ot,lg).bind(this,i),{signal:e}),t.append(r)}return t.addEventListener("keydown",w(this,Ot,cg).bind(this),{signal:e}),t},lg=function(t,e){e.stopPropagation(),l(this,au).dispatch("switchannotationeditorparams",{source:this,type:l(this,Nl),value:t})},cg=function(t){hs._keyboardManager.exec(this,t)},Qr=function(t){if(l(this,Ot,Kn)){this.hideDropdown();return}if(g(this,ru,t.detail===0),l(this,Er)||(g(this,Er,new AbortController),window.addEventListener("pointerdown",w(this,Ot,Jv).bind(this),{signal:l(this,pi).combinedSignal(l(this,Er))})),l(this,we)){l(this,we).classList.remove("hidden");return}const e=g(this,we,w(this,Ot,ag).call(this));l(this,fi).append(e)},Jv=function(t){var e;(e=l(this,we))!=null&&e.contains(t.target)||this.hideDropdown()},Kn=function(){return l(this,we)&&!l(this,we).classList.contains("hidden")},y(hs,lu,null);let Bd=hs;var Ol,cu,Rn,Xo,$l,fs,hu,uu,Yo,Gs,Ts,Ie,Bl,Pn,je,Hl,Ws,du,bt,hg,dd,t0,e0,s0,ug,Jr,Ks,Ma,i0,fd,Sc,n0,r0,o0,a0,l0;const kt=class kt extends te{constructor(e){super({...e,name:"highlightEditor"});y(this,bt);y(this,Ol,null);y(this,cu,0);y(this,Rn);y(this,Xo,null);y(this,$l,null);y(this,fs,null);y(this,hu,null);y(this,uu,0);y(this,Yo,null);y(this,Gs,null);y(this,Ts,null);y(this,Ie,!1);y(this,Bl,null);y(this,Pn);y(this,je,null);y(this,Hl,"");y(this,Ws);y(this,du,"");this.color=e.color||kt._defaultColor,g(this,Ws,e.thickness||kt._defaultThickness),g(this,Pn,e.opacity||kt._defaultOpacity),g(this,Rn,e.boxes||null),g(this,du,e.methodOfCreation||""),g(this,Hl,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(g(this,Ie,!0),w(this,bt,dd).call(this,e),w(this,bt,Jr).call(this)):l(this,Rn)&&(g(this,Ol,e.anchorNode),g(this,cu,e.anchorOffset),g(this,hu,e.focusNode),g(this,uu,e.focusOffset),w(this,bt,hg).call(this),w(this,bt,Jr).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=kt.prototype;return _t(this,"_keyboardManager",new _u([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,Ie)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,Ws),methodOfCreation:l(this,du)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,s){var i;te.initialize(e,s),kt._defaultColor||(kt._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(e,s){switch(e){case St.HIGHLIGHT_DEFAULT_COLOR:kt._defaultColor=s;break;case St.HIGHLIGHT_THICKNESS:kt._defaultThickness=s;break}}translateInPage(e,s){}get toolbarPosition(){return l(this,Bl)}updateParams(e,s){switch(e){case St.HIGHLIGHT_COLOR:w(this,bt,t0).call(this,s);break;case St.HIGHLIGHT_THICKNESS:w(this,bt,e0).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[St.HIGHLIGHT_DEFAULT_COLOR,kt._defaultColor],[St.HIGHLIGHT_THICKNESS,kt._defaultThickness]]}get propertiesToUpdate(){return[[St.HIGHLIGHT_COLOR,this.color||kt._defaultColor],[St.HIGHLIGHT_THICKNESS,l(this,Ws)||kt._defaultThickness],[St.HIGHLIGHT_FREE,l(this,Ie)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(g(this,$l,new Bd({editor:this})),e.addColorPicker(l(this,$l))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(w(this,bt,Sc).call(this))}getBaseTranslation(){return[0,0]}getRect(e,s){return super.getRect(e,s,w(this,bt,Sc).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){w(this,bt,ug).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,bt,Jr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let s=!1;this.parent&&!e?w(this,bt,ug).call(this):e&&(w(this,bt,Jr).call(this,e),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),s&&this.select()}rotate(e){var r,o,a;const{drawLayer:s}=this.parent;let i;l(this,Ie)?(e=(e-this.rotation+360)%360,i=w(r=kt,Ks,Ma).call(r,l(this,Gs).box,e)):i=w(o=kt,Ks,Ma).call(o,[this.x,this.y,this.width,this.height],e),s.updateProperties(l(this,Ts),{bbox:i,root:{"data-main-rotation":e}}),s.updateProperties(l(this,je),{bbox:w(a=kt,Ks,Ma).call(a,l(this,fs).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();l(this,Hl)&&(e.setAttribute("aria-label",l(this,Hl)),e.setAttribute("role","mark")),l(this,Ie)?e.classList.add("free"):this.div.addEventListener("keydown",w(this,bt,i0).bind(this),{signal:this._uiManager._signal});const s=g(this,Yo,document.createElement("div"));e.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,Xo);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),um(this,l(this,Yo),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(l(this,je),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(l(this,je),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:w(this,bt,fd).call(this,!0);break;case 1:case 3:w(this,bt,fd).call(this,!1);break}}select(){var e;super.select(),l(this,je)&&((e=this.parent)==null||e.drawLayer.updateProperties(l(this,je),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),l(this,je)&&((e=this.parent)==null||e.drawLayer.updateProperties(l(this,je),{rootClass:{selected:!1}}),l(this,Ie)||w(this,bt,fd).call(this,!1))}get _mustFixPosition(){return!l(this,Ie)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Ts),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(l(this,je),{rootClass:{hidden:!e}}))}static startHighlighting(e,s,{target:i,x:r,y:o}){const{x:a,y:c,width:h,height:u}=i.getBoundingClientRect(),d=new AbortController,f=e.combinedSignal(d),p=m=>{d.abort(),w(this,Ks,a0).call(this,e,m)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",ue,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Si,{signal:f}),i.addEventListener("pointermove",w(this,Ks,o0).bind(this,e),{signal:f}),this._freeHighlight=new og({x:r,y:o},[a,c,h,u],e.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,s,i){var b,A,v,_;let r=null;if(e instanceof Fv){const{data:{quadPoints:x,rect:S,rotation:C,id:T,color:R,opacity:L,popupRef:P},parent:{page:{pageNumber:F}}}=e;r=e={annotationType:dt.HIGHLIGHT,color:Array.from(R),opacity:L,quadPoints:x,boxes:null,pageIndex:F-1,rect:S.slice(0),rotation:C,id:T,deleted:!1,popupRef:P}}else if(e instanceof gm){const{data:{inkLists:x,rect:S,rotation:C,id:T,color:R,borderStyle:{rawWidth:L},popupRef:P},parent:{page:{pageNumber:F}}}=e;r=e={annotationType:dt.HIGHLIGHT,color:Array.from(R),thickness:L,inkLists:x,boxes:null,pageIndex:F-1,rect:S.slice(0),rotation:C,id:T,deleted:!1,popupRef:P}}const{color:o,quadPoints:a,inkLists:c,opacity:h}=e,u=await super.deserialize(e,s,i);u.color=st.makeHexColor(...o),g(u,Pn,h||1),c&&g(u,Ws,e.thickness),u.annotationElementId=e.id||null,u._initialData=r;const[d,f]=u.pageDimensions,[p,m]=u.pageTranslation;if(a){const x=g(u,Rn,[]);for(let S=0;S<a.length;S+=8)x.push({x:(a[S]-p)/d,y:1-(a[S+1]-m)/f,width:(a[S+2]-a[S])/d,height:(a[S+1]-a[S+5])/f});w(b=u,bt,hg).call(b),w(A=u,bt,Jr).call(A),u.rotate(u.rotation)}else if(c){g(u,Ie,!0);const x=c[0],S={x:x[0]-p,y:f-(x[1]-m)},C=new og(S,[0,0,d,f],1,l(u,Ws)/2,!0,.001);for(let L=0,P=x.length;L<P;L+=2)S.x=x[L]-p,S.y=f-(x[L+1]-m),C.add(S);const{id:T,clipPathId:R}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);w(v=u,bt,dd).call(v,{highlightOutlines:C.getOutlines(),highlightId:T,clipPathId:R}),w(_=u,bt,Jr).call(_)}return u}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=te._colorManager.convert(this.color),r={annotationType:dt.HIGHLIGHT,color:i,opacity:l(this,Pn),thickness:l(this,Ws),quadPoints:w(this,bt,n0).call(this),outlines:w(this,bt,r0).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:w(this,bt,Sc).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!w(this,bt,l0).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ol=new WeakMap,cu=new WeakMap,Rn=new WeakMap,Xo=new WeakMap,$l=new WeakMap,fs=new WeakMap,hu=new WeakMap,uu=new WeakMap,Yo=new WeakMap,Gs=new WeakMap,Ts=new WeakMap,Ie=new WeakMap,Bl=new WeakMap,Pn=new WeakMap,je=new WeakMap,Hl=new WeakMap,Ws=new WeakMap,du=new WeakMap,bt=new WeakSet,hg=function(){const e=new ng(l(this,Rn),.001);g(this,Gs,e.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,Gs).box;const s=new ng(l(this,Rn),.0025,.001,this._uiManager.direction==="ltr");g(this,fs,s.getOutlines());const{lastPoint:i}=l(this,fs);g(this,Bl,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},dd=function({highlightOutlines:e,highlightId:s,clipPathId:i}){var d,f;if(g(this,Gs,e),g(this,fs,e.getNewOutline(l(this,Ws)/2+1.5,.0025)),s>=0)g(this,Ts,s),g(this,Xo,i),this.parent.drawLayer.finalizeDraw(s,{bbox:e.box,path:{d:e.toSVGPath()}}),g(this,je,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,fs).box,path:{d:l(this,fs).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Ts),{bbox:w(d=kt,Ks,Ma).call(d,l(this,Gs).box,(p-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,je),{bbox:w(f=kt,Ks,Ma).call(f,l(this,fs).box,p),path:{d:l(this,fs).toSVGPath()}})}const[o,a,c,h]=e.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=c,this.height=h;break;case 90:{const[p,m]=this.parentDimensions;this.x=a,this.y=1-o,this.width=c*m/p,this.height=h*p/m;break}case 180:this.x=1-o,this.y=1-a,this.width=c,this.height=h;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-a,this.y=o,this.width=c*m/p,this.height=h*p/m;break}}const{lastPoint:u}=l(this,fs);g(this,Bl,[(u[0]-o)/c,(u[1]-a)/h])},t0=function(e){const s=(o,a)=>{var c,h;this.color=o,g(this,Pn,a),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,Ts),{root:{fill:o,"fill-opacity":a}}),(h=l(this,$l))==null||h.updateColor(o)},i=this.color,r=l(this,Pn);this.addCommands({cmd:s.bind(this,e,kt._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},e0=function(e){const s=l(this,Ws),i=r=>{g(this,Ws,r),w(this,bt,s0).call(this,r)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},s0=function(e){if(!l(this,Ie))return;w(this,bt,dd).call(this,{highlightOutlines:l(this,Gs).getNewOutline(e/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},ug=function(){l(this,Ts)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Ts)),g(this,Ts,null),this.parent.drawLayer.remove(l(this,je)),g(this,je,null))},Jr=function(e=this.parent){l(this,Ts)===null&&({id:Ke(this,Ts)._,clipPathId:Ke(this,Xo)._}=e.drawLayer.draw({bbox:l(this,Gs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,Pn)},rootClass:{highlight:!0,free:l(this,Ie)},path:{d:l(this,Gs).toSVGPath()}},!1,!0),g(this,je,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,Ie)},bbox:l(this,fs).box,path:{d:l(this,fs).toSVGPath()}},l(this,Ie))),l(this,Yo)&&(l(this,Yo).style.clipPath=l(this,Xo)))},Ks=new WeakSet,Ma=function([e,s,i,r],o){switch(o){case 90:return[1-s-r,e,r,i];case 180:return[1-e-i,1-s-r,i,r];case 270:return[s,1-e-i,r,i]}return[e,s,i,r]},i0=function(e){kt._keyboardManager.exec(this,e)},fd=function(e){if(!l(this,Ol))return;const s=window.getSelection();e?s.setPosition(l(this,Ol),l(this,cu)):s.setPosition(l(this,hu),l(this,uu))},Sc=function(){return l(this,Ie)?this.rotation:0},n0=function(){if(l(this,Ie))return null;const[e,s]=this.pageDimensions,[i,r]=this.pageTranslation,o=l(this,Rn),a=new Float32Array(o.length*8);let c=0;for(const{x:h,y:u,width:d,height:f}of o){const p=h*e+i,m=(1-u)*s+r;a[c]=a[c+4]=p,a[c+1]=a[c+3]=m,a[c+2]=a[c+6]=p+d*e,a[c+5]=a[c+7]=m-f*s,c+=8}return a},r0=function(e){return l(this,Gs).serialize(e,w(this,bt,Sc).call(this))},o0=function(e,s){this._freeHighlight.add(s)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},a0=function(e,s){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},l0=function(e){const{color:s}=this._initialData;return e.color.some((i,r)=>i!==s[r])},y(kt,Ks),U(kt,"_defaultColor",null),U(kt,"_defaultOpacity",1),U(kt,"_defaultThickness",12),U(kt,"_type","highlight"),U(kt,"_editorType",dt.HIGHLIGHT),U(kt,"_freeHighlightId",-1),U(kt,"_freeHighlight",null),U(kt,"_freeHighlightClipId","");let Hd=kt;var Ko;class c0{constructor(){y(this,Ko,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,s)}updateSVGProperty(t,e){l(this,Ko)[t]=e}toSVGProperties(){const t=l(this,Ko);return g(this,Ko,Object.create(null)),{root:t}}reset(){g(this,Ko,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){$t("Not implemented")}}Ko=new WeakMap;var ks,zl,Ee,Zo,Qo,Cr,Tr,kr,Jo,Et,dg,fg,pg,xc,h0,pd,Ec,Ia;const J=class J extends te{constructor(e){super(e);y(this,Et);y(this,ks,null);y(this,zl);U(this,"_drawId",null);g(this,zl,e.mustBeCommitted||!1),this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(w(this,Et,dg).call(this,e),w(this,Et,xc).call(this))}static _mergeSVGProperties(e,s){const i=new Set(Object.keys(e));for(const[r,o]of Object.entries(s))i.has(r)?Object.assign(e[r],o):e[r]=o;return e}static getDefaultDrawingOptions(e){$t("Not implemented")}static get typesMap(){$t("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,s){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(J,Ee).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,s){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,s)}static get defaultPropertiesToUpdate(){const e=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)e.push([i,s[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)e.push([i,s[r]]);return e}_updateProperty(e,s,i){const r=this._drawingOptions,o=r[s],a=c=>{var u;r.updateProperty(s,c);const h=l(this,ks).updateProperty(s,c);h&&w(this,Et,Ec).call(this,h),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties(l(this,ks).getPathResizingSVGProperties(w(this,Et,pd).call(this)),{bbox:w(this,Et,Ia).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties(l(this,ks).getPathResizedSVGProperties(w(this,Et,pd).call(this)),{bbox:w(this,Et,Ia).call(this)}))}_onTranslating(e,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:w(this,Et,Ia).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties(l(this,ks).getPathTranslatedSVGProperties(w(this,Et,pd).call(this),this.parentDimensions),{bbox:w(this,Et,Ia).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,zl)&&(g(this,zl,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){w(this,Et,pg).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,Et,xc).call(this),w(this,Et,Ec).call(this,l(this,ks).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let s=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),w(this,Et,pg).call(this)):e&&(this._uiManager.addShouldRescale(this),w(this,Et,xc).call(this,e),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,J._mergeSVGProperties({bbox:w(this,Et,Ia).call(this)},l(this,ks).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&w(this,Et,Ec).call(this,l(this,ks).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,s;this._isCopy&&(e=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[o,a]=this.parentDimensions;return this.setDims(this.width*o,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,s),i}static createDrawerInstance(e,s,i,r,o){$t("Not implemented")}static startDrawing(e,s,i,r){var A;const{target:o,offsetX:a,offsetY:c,pointerId:h,pointerType:u}=r;if(l(J,Tr)&&l(J,Tr)!==u)return;const{viewport:{rotation:d}}=e,{width:f,height:p}=o.getBoundingClientRect(),m=g(J,Zo,new AbortController),b=e.combinedSignal(m);if(l(J,Cr)||g(J,Cr,h),l(J,Tr)??g(J,Tr,u),window.addEventListener("pointerup",v=>{var _;l(J,Cr)===v.pointerId?this._endDraw(v):(_=l(J,kr))==null||_.delete(v.pointerId)},{signal:b}),window.addEventListener("pointercancel",v=>{var _;l(J,Cr)===v.pointerId?this._currentParent.endDrawingSession():(_=l(J,kr))==null||_.delete(v.pointerId)},{signal:b}),window.addEventListener("pointerdown",v=>{l(J,Tr)===v.pointerType&&((l(J,kr)||g(J,kr,new Set)).add(v.pointerId),l(J,Ee).isCancellable()&&(l(J,Ee).removeLastElement(),l(J,Ee).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Si,{signal:b}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),o.addEventListener("touchmove",v=>{v.timeStamp===l(J,Jo)&&ue(v)},{signal:b}),e.toggleDrawing(),(A=s._editorUndoBar)==null||A.hide(),l(J,Ee)){e.drawLayer.updateProperties(this._currentDrawId,l(J,Ee).startNew(a,c,f,p,d));return}s.updateUIForDefaultProperties(this),g(J,Ee,this.createDrawerInstance(a,c,f,p,d)),g(J,Qo,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(l(J,Qo).toSVGProperties(),l(J,Ee).defaultSVGProperties),!0,!1)}static _drawMove(e){var o;if(g(J,Jo,-1),!l(J,Ee))return;const{offsetX:s,offsetY:i,pointerId:r}=e;if(l(J,Cr)===r){if(((o=l(J,kr))==null?void 0:o.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(J,Ee).add(s,i)),g(J,Jo,e.timeStamp),ue(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,g(J,Ee,null),g(J,Qo,null),g(J,Tr,null),g(J,Jo,NaN)),l(J,Zo)&&(l(J,Zo).abort(),g(J,Zo,null),g(J,Cr,NaN),g(J,kr,null))}static _endDraw(e){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,l(J,Ee).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=l(J,Ee),r=this._currentDrawId,o=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:St.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(St.DRAW_STEP),!l(J,Ee).isEmpty()){const{pageDimensions:[i,r],scale:o}=s,a=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(J,Ee).getOutlines(i*o,r*o,o,this._INNER_MARGIN),drawingOptions:l(J,Qo),mustBeCommitted:!e});return this._cleanup(!0),a}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,s,i,r,o,a){$t("Not implemented")}static async deserialize(e,s,i){var d,f;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}=s.viewport,h=this.deserializeDraw(a,c,r,o,this._INNER_MARGIN,e),u=await super.deserialize(e,s,i);return u.createDrawingOptions(e),w(d=u,Et,dg).call(d,{drawOutlines:h}),w(f=u,Et,xc).call(f),u.onScaleChanging(),u.rotate(),u}serializeDraw(e){const[s,i]=this.pageTranslation,[r,o]=this.pageDimensions;return l(this,ks).serialize([s,i,r,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ks=new WeakMap,zl=new WeakMap,Ee=new WeakMap,Zo=new WeakMap,Qo=new WeakMap,Cr=new WeakMap,Tr=new WeakMap,kr=new WeakMap,Jo=new WeakMap,Et=new WeakSet,dg=function({drawOutlines:e,drawId:s,drawingOptions:i}){g(this,ks,e),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,e.defaultProperties)):this._drawId=w(this,Et,fg).call(this,e,this.parent),w(this,Et,Ec).call(this,e.box)},fg=function(e,s){const{id:i}=s.drawLayer.draw(J._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i},pg=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},xc=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=w(this,Et,fg).call(this,l(this,ks),e)}},h0=function([e,s,i,r]){const{parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[s,1-e,i*(a/o),r*(o/a)];case 180:return[1-e,1-s,i,r];case 270:return[1-s,e,i*(a/o),r*(o/a)];default:return[e,s,i,r]}},pd=function(){const{x:e,y:s,width:i,height:r,parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[1-s,e,i*(o/a),r*(a/o)];case 180:return[1-e,1-s,i,r];case 270:return[s,1-e,i*(o/a),r*(a/o)];default:return[e,s,i,r]}},Ec=function(e){if([this.x,this.y,this.width,this.height]=w(this,Et,h0).call(this,e),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Ia=function(){const{x:e,y:s,width:i,height:r,rotation:o,parentRotation:a,parentDimensions:[c,h]}=this;switch((o*4+a)/90){case 1:return[1-s-r,e,r,i];case 2:return[1-e-i,1-s-r,i,r];case 3:return[s,1-e-i,r,i];case 4:return[e,s-i*(c/h),r*(h/c),i*(c/h)];case 5:return[1-s,e,i*(c/h),r*(h/c)];case 6:return[1-e-r*(h/c),1-s,r*(h/c),i*(c/h)];case 7:return[s-i*(c/h),1-e-r*(h/c),i*(c/h),r*(h/c)];case 8:return[e-i,s-r,i,r];case 9:return[1-s,e-i,r,i];case 10:return[1-e,1-s,i,r];case 11:return[s-r,1-e,r,i];case 12:return[e-r*(h/c),s,r*(h/c),i*(c/h)];case 13:return[1-s-i*(c/h),e-r*(h/c),i*(c/h),r*(h/c)];case 14:return[1-e,1-s-i*(c/h),r*(h/c),i*(c/h)];case 15:return[s,1-e,i*(c/h),r*(h/c)];default:return[e,s,i,r]}},U(J,"_currentDrawId",-1),U(J,"_currentParent",null),y(J,Ee,null),y(J,Zo,null),y(J,Qo,null),y(J,Cr,NaN),y(J,Tr,null),y(J,kr,null),y(J,Jo,NaN),U(J,"_INNER_MARGIN",3);let zd=J;var qi,Ce,Te,ta,Ul,ts,Le,qs,ea,sa,ia,Vl,gd;class bC{constructor(t,e,s,i,r,o){y(this,Vl);y(this,qi,new Float64Array(6));y(this,Ce);y(this,Te);y(this,ta);y(this,Ul);y(this,ts);y(this,Le,"");y(this,qs,0);y(this,ea,new Eu);y(this,sa);y(this,ia);g(this,sa,s),g(this,ia,i),g(this,ta,r),g(this,Ul,o),[t,e]=w(this,Vl,gd).call(this,t,e);const a=g(this,Ce,[NaN,NaN,NaN,NaN,t,e]);g(this,ts,[t,e]),g(this,Te,[{line:a,points:l(this,ts)}]),l(this,qi).set(a,0)}updateProperty(t,e){t==="stroke-width"&&g(this,Ul,e)}isEmpty(){return!l(this,Te)||l(this,Te).length===0}isCancellable(){return l(this,ts).length<=10}add(t,e){[t,e]=w(this,Vl,gd).call(this,t,e);const[s,i,r,o]=l(this,qi).subarray(2,6),a=t-r,c=e-o;return Math.hypot(l(this,sa)*a,l(this,ia)*c)<=2?null:(l(this,ts).push(t,e),isNaN(s)?(l(this,qi).set([r,o,t,e],2),l(this,Ce).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(l(this,qi)[0])&&l(this,Ce).splice(6,6),l(this,qi).set([s,i,r,o,t,e],0),l(this,Ce).push(...Q.createBezierPoints(s,i,r,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(l(this,ts).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,i,r){g(this,sa,s),g(this,ia,i),g(this,ta,r),[t,e]=w(this,Vl,gd).call(this,t,e);const o=g(this,Ce,[NaN,NaN,NaN,NaN,t,e]);g(this,ts,[t,e]);const a=l(this,Te).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),l(this,Te).push({line:o,points:l(this,ts)}),l(this,qi).set(o,0),g(this,qs,0),this.toSVGPath(),null}getLastElement(){return l(this,Te).at(-1)}setLastElement(t){return l(this,Te)?(l(this,Te).push(t),g(this,Ce,t.line),g(this,ts,t.points),g(this,qs,0),{path:{d:this.toSVGPath()}}):l(this,ea).setLastElement(t)}removeLastElement(){if(!l(this,Te))return l(this,ea).removeLastElement();l(this,Te).pop(),g(this,Le,"");for(let t=0,e=l(this,Te).length;t<e;t++){const{line:s,points:i}=l(this,Te)[t];g(this,Ce,s),g(this,ts,i),g(this,qs,0),this.toSVGPath()}return{path:{d:l(this,Le)}}}toSVGPath(){const t=Q.svgRound(l(this,Ce)[4]),e=Q.svgRound(l(this,Ce)[5]);if(l(this,ts).length===2)return g(this,Le,`${l(this,Le)} M ${t} ${e} Z`),l(this,Le);if(l(this,ts).length<=6){const i=l(this,Le).lastIndexOf("M");g(this,Le,`${l(this,Le).slice(0,i)} M ${t} ${e}`),g(this,qs,6)}if(l(this,ts).length===4){const i=Q.svgRound(l(this,Ce)[10]),r=Q.svgRound(l(this,Ce)[11]);return g(this,Le,`${l(this,Le)} L ${i} ${r}`),g(this,qs,12),l(this,Le)}const s=[];l(this,qs)===0&&(s.push(`M ${t} ${e}`),g(this,qs,6));for(let i=l(this,qs),r=l(this,Ce).length;i<r;i+=6){const[o,a,c,h,u,d]=l(this,Ce).slice(i,i+6).map(Q.svgRound);s.push(`C${o} ${a} ${c} ${h} ${u} ${d}`)}return g(this,Le,l(this,Le)+s.join(" ")),g(this,qs,l(this,Ce).length),l(this,Le)}getOutlines(t,e,s,i){const r=l(this,Te).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,ea).build(l(this,Te),t,e,s,l(this,ta),l(this,Ul),i),g(this,qi,null),g(this,Ce,null),g(this,Te,null),g(this,Le,null),l(this,ea)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}qi=new WeakMap,Ce=new WeakMap,Te=new WeakMap,ta=new WeakMap,Ul=new WeakMap,ts=new WeakMap,Le=new WeakMap,qs=new WeakMap,ea=new WeakMap,sa=new WeakMap,ia=new WeakMap,Vl=new WeakSet,gd=function(t,e){return Q._normalizePoint(t,e,l(this,sa),l(this,ia),l(this,ta))};var es,fu,pu,Rs,Xi,Yi,jl,Gl,na,Fe,rn,u0,d0,f0;class Eu extends Q{constructor(){super(...arguments);y(this,Fe);y(this,es);y(this,fu,0);y(this,pu);y(this,Rs);y(this,Xi);y(this,Yi);y(this,jl);y(this,Gl);y(this,na)}build(e,s,i,r,o,a,c){g(this,Xi,s),g(this,Yi,i),g(this,jl,r),g(this,Gl,o),g(this,na,a),g(this,pu,c??0),g(this,Rs,e),w(this,Fe,d0).call(this)}get thickness(){return l(this,na)}setLastElement(e){return l(this,Rs).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Rs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:s}of l(this,Rs)){if(e.push(`M${Q.svgRound(s[4])} ${Q.svgRound(s[5])}`),s.length===6){e.push("Z");continue}if(s.length===12&&isNaN(s[6])){e.push(`L${Q.svgRound(s[10])} ${Q.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[o,a,c,h,u,d]=s.subarray(i,i+6).map(Q.svgRound);e.push(`C${o} ${a} ${c} ${h} ${u} ${d}`)}}return e.join("")}serialize([e,s,i,r],o){const a=[],c=[],[h,u,d,f]=w(this,Fe,u0).call(this);let p,m,b,A,v,_,x,S,C;switch(l(this,Gl)){case 0:C=Q._rescale,p=e,m=s+r,b=i,A=-r,v=e+h*i,_=s+(1-u-f)*r,x=e+(h+d)*i,S=s+(1-u)*r;break;case 90:C=Q._rescaleAndSwap,p=e,m=s,b=i,A=r,v=e+u*i,_=s+h*r,x=e+(u+f)*i,S=s+(h+d)*r;break;case 180:C=Q._rescale,p=e+i,m=s,b=-i,A=r,v=e+(1-h-d)*i,_=s+u*r,x=e+(1-h)*i,S=s+(u+f)*r;break;case 270:C=Q._rescaleAndSwap,p=e+i,m=s+r,b=-i,A=-r,v=e+(1-u-f)*i,_=s+(1-h-d)*r,x=e+(1-u)*i,S=s+(1-h)*r;break}for(const{line:T,points:R}of l(this,Rs))a.push(C(T,p,m,b,A,o?new Array(T.length):null)),c.push(C(R,p,m,b,A,o?new Array(R.length):null));return{lines:a,points:c,rect:[v,_,x,S]}}static deserialize(e,s,i,r,o,{paths:{lines:a,points:c},rotation:h,thickness:u}){const d=[];let f,p,m,b,A;switch(h){case 0:A=Q._rescale,f=-e/i,p=s/r+1,m=1/i,b=-1/r;break;case 90:A=Q._rescaleAndSwap,f=-s/r,p=-e/i,m=1/r,b=1/i;break;case 180:A=Q._rescale,f=e/i+1,p=-s/r,m=-1/i,b=1/r;break;case 270:A=Q._rescaleAndSwap,f=s/r+1,p=e/i+1,m=-1/r,b=-1/i;break}if(!a){a=[];for(const _ of c){const x=_.length;if(x===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1]]));continue}if(x===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1],NaN,NaN,NaN,NaN,_[2],_[3]]));continue}const S=new Float32Array(3*(x-2));a.push(S);let[C,T,R,L]=_.subarray(0,4);S.set([NaN,NaN,NaN,NaN,C,T],0);for(let P=4;P<x;P+=2){const F=_[P],N=_[P+1];S.set(Q.createBezierPoints(C,T,R,L,F,N),(P-2)*3),[C,T,R,L]=[R,L,F,N]}}}for(let _=0,x=a.length;_<x;_++)d.push({line:A(a[_].map(S=>S??NaN),f,p,m,b),points:A(c[_].map(S=>S??NaN),f,p,m,b)});const v=new this.prototype.constructor;return v.build(d,i,r,1,h,u,o),v}get box(){return l(this,es)}updateProperty(e,s){return e==="stroke-width"?w(this,Fe,f0).call(this,s):null}updateParentDimensions([e,s],i){const[r,o]=w(this,Fe,rn).call(this);g(this,Xi,e),g(this,Yi,s),g(this,jl,i);const[a,c]=w(this,Fe,rn).call(this),h=a-r,u=c-o,d=l(this,es);return d[0]-=h,d[1]-=u,d[2]+=2*h,d[3]+=2*u,d}updateRotation(e){return g(this,fu,e),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,es).map(Q.svgRound).join(" ")}get defaultProperties(){const[e,s]=l(this,es);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(s)}`}}}get rotationTransform(){const[,,e,s]=l(this,es);let i=0,r=0,o=0,a=0,c=0,h=0;switch(l(this,fu)){case 90:r=s/e,o=-e/s,c=e;break;case 180:i=-1,a=-1,c=e,h=s;break;case 270:r=-s/e,o=e/s,h=s;break;default:return""}return`matrix(${i} ${r} ${o} ${a} ${Q.svgRound(c)} ${Q.svgRound(h)})`}getPathResizingSVGProperties([e,s,i,r]){const[o,a]=w(this,Fe,rn).call(this),[c,h,u,d]=l(this,es);if(Math.abs(u-o)<=Q.PRECISION||Math.abs(d-a)<=Q.PRECISION){const A=e+i/2-(c+u/2),v=s+r/2-(h+d/2);return{path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(s)}`,transform:`${this.rotationTransform} translate(${A} ${v})`}}}const f=(i-2*o)/(u-2*o),p=(r-2*a)/(d-2*a),m=u/i,b=d/r;return{path:{"transform-origin":`${Q.svgRound(c)} ${Q.svgRound(h)}`,transform:`${this.rotationTransform} scale(${m} ${b}) translate(${Q.svgRound(o)} ${Q.svgRound(a)}) scale(${f} ${p}) translate(${Q.svgRound(-o)} ${Q.svgRound(-a)})`}}}getPathResizedSVGProperties([e,s,i,r]){const[o,a]=w(this,Fe,rn).call(this),c=l(this,es),[h,u,d,f]=c;if(c[0]=e,c[1]=s,c[2]=i,c[3]=r,Math.abs(d-o)<=Q.PRECISION||Math.abs(f-a)<=Q.PRECISION){const v=e+i/2-(h+d/2),_=s+r/2-(u+f/2);for(const{line:x,points:S}of l(this,Rs))Q._translate(x,v,_,x),Q._translate(S,v,_,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*o)/(d-2*o),m=(r-2*a)/(f-2*a),b=-p*(h+o)+e+o,A=-m*(u+a)+s+a;if(p!==1||m!==1||b!==0||A!==0)for(const{line:v,points:_}of l(this,Rs))Q._rescale(v,b,A,p,m,v),Q._rescale(_,b,A,p,m,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,s],i){const[r,o]=i,a=l(this,es),c=e-a[0],h=s-a[1];if(l(this,Xi)===r&&l(this,Yi)===o)for(const{line:u,points:d}of l(this,Rs))Q._translate(u,c,h,u),Q._translate(d,c,h,d);else{const u=l(this,Xi)/r,d=l(this,Yi)/o;g(this,Xi,r),g(this,Yi,o);for(const{line:f,points:p}of l(this,Rs))Q._rescale(f,c,h,u,d,f),Q._rescale(p,c,h,u,d,p);a[2]*=u,a[3]*=d}return a[0]=e,a[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(s)}`}}}get defaultSVGProperties(){const e=l(this,es);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Q.svgRound(e[0])} ${Q.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}es=new WeakMap,fu=new WeakMap,pu=new WeakMap,Rs=new WeakMap,Xi=new WeakMap,Yi=new WeakMap,jl=new WeakMap,Gl=new WeakMap,na=new WeakMap,Fe=new WeakSet,rn=function(e=l(this,na)){const s=l(this,pu)+e/2*l(this,jl);return l(this,Gl)%180===0?[s/l(this,Xi),s/l(this,Yi)]:[s/l(this,Yi),s/l(this,Xi)]},u0=function(){const[e,s,i,r]=l(this,es),[o,a]=w(this,Fe,rn).call(this,0);return[e+o,s+a,i-2*o,r-2*a]},d0=function(){const e=g(this,es,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,Rs)){if(r.length<=12){for(let c=4,h=r.length;c<h;c+=6){const[u,d]=r.subarray(c,c+2);e[0]=Math.min(e[0],u),e[1]=Math.min(e[1],d),e[2]=Math.max(e[2],u),e[3]=Math.max(e[3],d)}continue}let o=r[4],a=r[5];for(let c=6,h=r.length;c<h;c+=6){const[u,d,f,p,m,b]=r.subarray(c,c+6);st.bezierBoundingBox(o,a,u,d,f,p,m,b,e),o=m,a=b}}const[s,i]=w(this,Fe,rn).call(this);e[0]=Ds(e[0]-s,0,1),e[1]=Ds(e[1]-i,0,1),e[2]=Ds(e[2]+s,0,1),e[3]=Ds(e[3]+i,0,1),e[2]-=e[0],e[3]-=e[1]},f0=function(e){const[s,i]=w(this,Fe,rn).call(this);g(this,na,e);const[r,o]=w(this,Fe,rn).call(this),[a,c]=[r-s,o-i],h=l(this,es);return h[0]-=a,h[1]-=c,h[2]+=2*a,h[3]+=2*c,h};class Rf extends c0{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:te._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Rf(this._viewParameters);return t.updateAll(this),t}}var of,p0;const Da=class Da extends zd{constructor(e){super({...e,name:"inkEditor"});y(this,of);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,s){te.initialize(e,s),this._defaultDrawingOptions=new Rf(s.viewParameters)}static getDefaultDrawingOptions(e){const s=this._defaultDrawingOptions.clone();return s.updateProperties(e),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return _t(this,"typesMap",new Map([[St.INK_THICKNESS,"stroke-width"],[St.INK_COLOR,"stroke"],[St.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,s,i,r,o){return new bC(e,s,i,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,s,i,r,o,a){return Eu.deserialize(e,s,i,r,o,a)}static async deserialize(e,s,i){let r=null;if(e instanceof gm){const{data:{inkLists:a,rect:c,rotation:h,id:u,color:d,opacity:f,borderStyle:{rawWidth:p},popupRef:m},parent:{page:{pageNumber:b}}}=e;r=e={annotationType:dt.INK,color:Array.from(d),thickness:p,opacity:f,paths:{points:a},boxes:null,pageIndex:b-1,rect:c.slice(0),rotation:h,id:u,deleted:!1,popupRef:m}}const o=await super.deserialize(e,s,i);return o.annotationElementId=e.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:s,opacity:i}){this._drawingOptions=Da.getDefaultDrawingOptions({stroke:st.makeHexColor(...e),"stroke-width":s,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(e),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":c}}=this,h={annotationType:dt.INK,color:te._colorManager.convert(o),opacity:a,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(h.isCopy=!0,h):this.annotationElementId&&!w(this,of,p0).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(e){const{points:s,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};of=new WeakSet,p0=function(e){const{color:s,thickness:i,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((a,c)=>a!==s[c])||e.thickness!==i||e.opacity!==r||e.pageIndex!==o},U(Da,"_type","ink"),U(Da,"_editorType",dt.INK),U(Da,"_defaultDrawingOptions",null);let gg=Da;class mg extends Eu{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Bu=8,lc=3;var ra,Mt,bg,gi,g0,m0,yg,md,b0,y0,w0,wg,vg,v0;class Bn{static extractContoursFromText(t,{fontFamily:e,fontStyle:s,fontWeight:i},r,o,a,c){let h=new OffscreenCanvas(1,1),u=h.getContext("2d",{alpha:!1});const d=200,f=u.font=`${s} ${i} ${d}px ${e}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:m,actualBoundingBoxAscent:b,actualBoundingBoxDescent:A,fontBoundingBoxAscent:v,fontBoundingBoxDescent:_,width:x}=u.measureText(t),S=1.5,C=Math.ceil(Math.max(Math.abs(p)+Math.abs(m)||0,x)*S),T=Math.ceil(Math.max(Math.abs(b)+Math.abs(A)||d,Math.abs(v)+Math.abs(_)||d)*S);h=new OffscreenCanvas(C,T),u=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=f,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,C,T),u.fillStyle="black",u.fillText(t,C*(S-1)/2,T*(3-S)/2);const R=w(this,Mt,wg).call(this,u.getImageData(0,0,C,T).data),L=w(this,Mt,w0).call(this,R),P=w(this,Mt,vg).call(this,L),F=w(this,Mt,yg).call(this,R,C,T,P);return this.processDrawnLines({lines:{curves:F,width:C,height:T},pageWidth:r,pageHeight:o,rotation:a,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(t,e,s,i,r){const[o,a,c]=w(this,Mt,v0).call(this,t),[h,u]=w(this,Mt,y0).call(this,o,a,c,Math.hypot(a,c)*l(this,ra).sigmaSFactor,l(this,ra).sigmaR,l(this,ra).kernelSize),d=w(this,Mt,vg).call(this,u),f=w(this,Mt,yg).call(this,h,a,c,d);return this.processDrawnLines({lines:{curves:f,width:a,height:c},pageWidth:e,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:o,areContours:a}){i%180!==0&&([e,s]=[s,e]);const{curves:c,width:h,height:u}=t,d=t.thickness??0,f=[],p=Math.min(e/h,s/u),m=p/e,b=p/s,A=[];for(const{points:_}of c){const x=o?w(this,Mt,b0).call(this,_):_;if(!x)continue;A.push(x);const S=x.length,C=new Float32Array(S),T=new Float32Array(3*(S===2?2:S-2));if(f.push({line:T,points:C}),S===2){C[0]=x[0]*m,C[1]=x[1]*b,T.set([NaN,NaN,NaN,NaN,C[0],C[1]],0);continue}let[R,L,P,F]=x;R*=m,L*=b,P*=m,F*=b,C.set([R,L,P,F],0),T.set([NaN,NaN,NaN,NaN,R,L],0);for(let N=4;N<S;N+=2){const D=C[N]=x[N]*m,tt=C[N+1]=x[N+1]*b;T.set(Q.createBezierPoints(R,L,P,F,D,tt),(N-2)*3),[R,L,P,F]=[P,F,D,tt]}}if(f.length===0)return null;const v=a?new mg:new Eu;return v.build(f,e,s,1,i,a?0:d,r),{outline:v,newCurves:A,areContours:a,thickness:d,width:h,height:u}}static async compressSignature({outlines:t,areContours:e,thickness:s,width:i,height:r}){let o=1/0,a=-1/0,c=0;for(const x of t){c+=x.length;for(let S=2,C=x.length;S<C;S++){const T=x[S]-x[S-2];o=Math.min(o,T),a=Math.max(a,T)}}let h;o>=-128&&a<=127?h=Int8Array:o>=-32768&&a<=32767?h=Int16Array:h=Int32Array;const u=t.length,d=Bu+lc*u,f=new Uint32Array(d);let p=0;f[p++]=d*Uint32Array.BYTES_PER_ELEMENT+(c-2*u)*h.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=i,f[p++]=r,f[p++]=e?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=u,f[p++]=h.BYTES_PER_ELEMENT;for(const x of t)f[p++]=x.length-2,f[p++]=x[0],f[p++]=x[1];const m=new CompressionStream("deflate-raw"),b=m.writable.getWriter();await b.ready,b.write(f);const A=h.prototype.constructor;for(const x of t){const S=new A(x.length-2);for(let C=2,T=x.length;C<T;C++)S[C-2]=x[C]-x[C-2];b.write(S)}b.close();const v=await new Response(m.readable).arrayBuffer(),_=new Uint8Array(v);return Sw(_)}static async decompressSignature(t){try{const e=HE(t),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let o=null,a=0;for await(const x of s)o||(o=new Uint8Array(new Uint32Array(x.buffer,0,4)[0])),o.set(x,a),a+=x.length;const c=new Uint32Array(o.buffer,0,o.length>>2),h=c[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const u=c[2],d=c[3],f=c[4]===0,p=c[5],m=c[6],b=c[7],A=[],v=(Bu+lc*m)*Uint32Array.BYTES_PER_ELEMENT;let _;switch(b){case Int8Array.BYTES_PER_ELEMENT:_=new Int8Array(o.buffer,v);break;case Int16Array.BYTES_PER_ELEMENT:_=new Int16Array(o.buffer,v);break;case Int32Array.BYTES_PER_ELEMENT:_=new Int32Array(o.buffer,v);break}a=0;for(let x=0;x<m;x++){const S=c[lc*x+Bu],C=new Float32Array(S+2);A.push(C);for(let T=0;T<lc-1;T++)C[T]=c[lc*x+Bu+T+1];for(let T=0;T<S;T++)C[T+2]=C[T]+_[a++]}return{areContours:f,thickness:p,outlines:A,width:u,height:d}}catch(e){return gt(`decompressSignature: ${e}`),null}}}ra=new WeakMap,Mt=new WeakSet,bg=function(t,e,s,i){return s-=t,i-=e,s===0?i>0?0:4:s===1?i+6:2-i},gi=new WeakMap,g0=function(t,e,s,i,r,o,a){const c=w(this,Mt,bg).call(this,s,i,r,o);for(let h=0;h<8;h++){const u=(-h+c-a+16)%8,d=l(this,gi)[2*u],f=l(this,gi)[2*u+1];if(t[(s+d)*e+(i+f)]!==0)return u}return-1},m0=function(t,e,s,i,r,o,a){const c=w(this,Mt,bg).call(this,s,i,r,o);for(let h=0;h<8;h++){const u=(h+c+a+16)%8,d=l(this,gi)[2*u],f=l(this,gi)[2*u+1];if(t[(s+d)*e+(i+f)]!==0)return u}return-1},yg=function(t,e,s,i){const r=t.length,o=new Int32Array(r);for(let u=0;u<r;u++)o[u]=t[u]<=i?1:0;for(let u=1;u<s-1;u++)o[u*e]=o[u*e+e-1]=0;for(let u=0;u<e;u++)o[u]=o[e*s-1-u]=0;let a=1,c;const h=[];for(let u=1;u<s-1;u++){c=1;for(let d=1;d<e-1;d++){const f=u*e+d,p=o[f];if(p===0)continue;let m=u,b=d;if(p===1&&o[f-1]===0)a+=1,b-=1;else if(p>=1&&o[f+1]===0)a+=1,b+=1,p>1&&(c=p);else{p!==1&&(c=Math.abs(p));continue}const A=[d,u],v=b===d+1,_={isHole:v,points:A,id:a,parent:0};h.push(_);let x;for(const N of h)if(N.id===c){x=N;break}x?x.isHole?_.parent=v?x.parent:c:_.parent=v?c:x.parent:_.parent=v?c:0;const S=w(this,Mt,g0).call(this,o,e,u,d,m,b,0);if(S===-1){o[f]=-a,o[f]!==1&&(c=Math.abs(o[f]));continue}let C=l(this,gi)[2*S],T=l(this,gi)[2*S+1];const R=u+C,L=d+T;m=R,b=L;let P=u,F=d;for(;;){const N=w(this,Mt,m0).call(this,o,e,P,F,m,b,1);C=l(this,gi)[2*N],T=l(this,gi)[2*N+1];const D=P+C,tt=F+T;A.push(tt,D);const nt=P*e+F;if(o[nt+1]===0?o[nt]=-a:o[nt]===1&&(o[nt]=a),D===u&&tt===d&&P===R&&F===L){o[f]!==1&&(c=Math.abs(o[f]));break}else m=P,b=F,P=D,F=tt}}}return h},md=function(t,e,s,i){if(s-e<=4){for(let R=e;R<s-2;R+=2)i.push(t[R],t[R+1]);return}const r=t[e],o=t[e+1],a=t[s-4]-r,c=t[s-3]-o,h=Math.hypot(a,c),u=a/h,d=c/h,f=u*o-d*r,p=c/a,m=1/h,b=Math.atan(p),A=Math.cos(b),v=Math.sin(b),_=m*(Math.abs(A)+Math.abs(v)),x=m*(1-_+_**2),S=Math.max(Math.atan(Math.abs(v+A)*x),Math.atan(Math.abs(v-A)*x));let C=0,T=e;for(let R=e+2;R<s-2;R+=2){const L=Math.abs(f-u*t[R+1]+d*t[R]);L>C&&(T=R,C=L)}C>(h*S)**2?(w(this,Mt,md).call(this,t,e,T+2,i),w(this,Mt,md).call(this,t,T,s,i)):i.push(r,o)},b0=function(t){const e=[],s=t.length;return w(this,Mt,md).call(this,t,0,s,e),e.push(t[s-2],t[s-1]),e.length<=4?null:e},y0=function(t,e,s,i,r,o){const a=new Float32Array(o**2),c=-2*i**2,h=o>>1;for(let b=0;b<o;b++){const A=(b-h)**2;for(let v=0;v<o;v++)a[b*o+v]=Math.exp((A+(v-h)**2)/c)}const u=new Float32Array(256),d=-2*r**2;for(let b=0;b<256;b++)u[b]=Math.exp(b**2/d);const f=t.length,p=new Uint8Array(f),m=new Uint32Array(256);for(let b=0;b<s;b++)for(let A=0;A<e;A++){const v=b*e+A,_=t[v];let x=0,S=0;for(let T=0;T<o;T++){const R=b+T-h;if(!(R<0||R>=s))for(let L=0;L<o;L++){const P=A+L-h;if(P<0||P>=e)continue;const F=t[R*e+P],N=a[T*o+L]*u[Math.abs(F-_)];x+=F*N,S+=N}}const C=p[v]=Math.round(x/S);m[C]++}return[p,m]},w0=function(t){const e=new Uint32Array(256);for(const s of t)e[s]++;return e},wg=function(t){const e=t.length,s=new Uint8ClampedArray(e>>2);let i=-1/0,r=1/0;for(let a=0,c=s.length;a<c;a++){if(t[(a<<2)+3]===0){i=s[a]=255;continue}const u=s[a]=t[a<<2];u>i&&(i=u),u<r&&(r=u)}const o=255/(i-r);for(let a=0;a<e;a++)s[a]=(s[a]-r)*o;return s},vg=function(t){let e,s=-1/0,i=-1/0;const r=t.findIndex(c=>c!==0);let o=r,a=r;for(e=r;e<256;e++){const c=t[e];c>s&&(e-o>i&&(i=e-o,a=e-1),s=c,o=e)}for(e=a-1;e>=0&&!(t[e]>t[e+1]);e--);return e},v0=function(t){const e=t,{width:s,height:i}=t,{maxDim:r}=l(this,ra);let o=s,a=i;if(s>r||i>r){let f=s,p=i,m=Math.log2(Math.max(s,i)/r);const b=Math.floor(m);m=m===b?b-1:b;for(let v=0;v<m;v++){o=f,a=p,o>r&&(o=Math.ceil(o/2)),a>r&&(a=Math.ceil(a/2));const _=new OffscreenCanvas(o,a);_.getContext("2d").drawImage(t,0,0,f,p,0,0,o,a),f=o,p=a,t!==e&&t.close(),t=_.transferToImageBitmap()}const A=Math.min(r/o,r/a);o=Math.round(o*A),a=Math.round(a*A)}const h=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});h.filter="grayscale(1)",h.drawImage(t,0,0,t.width,t.height,0,0,o,a);const u=h.getImageData(0,0,o,a).data;return[w(this,Mt,wg).call(this,u),o,a]},y(Bn,Mt),y(Bn,ra,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),y(Bn,gi,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class mm extends c0{constructor(){super(),super.updateProperties({fill:"CanvasText","stroke-width":0})}clone(){const t=new mm;return t.updateAll(this),t}}class bm extends Rf{constructor(t){super(t),super.updateProperties({stroke:"CanvasText","stroke-width":1})}clone(){const t=new bm(this._viewParameters);return t.updateAll(this),t}}var Rr,Ps,Pr,Mr;const ys=class ys extends zd{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});y(this,Rr,!1);y(this,Ps,null);y(this,Pr,null);y(this,Mr,null);this._willKeepAspectRatio=!0,g(this,Pr,e.signatureData||null),g(this,Ps,null),this.defaultL10nId="pdfjs-editor-signature-editor"}static initialize(e,s){te.initialize(e,s),this._defaultDrawingOptions=new mm,this._defaultDrawnSignatureOptions=new bm(s.viewParameters)}static getDefaultDrawingOptions(e){const s=this._defaultDrawingOptions.clone();return s.updateProperties(e),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return _t(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!l(this,Ps)}}static computeTelemetryFinalData(e){const s=e.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,e=this.x,s=this.y),super.render(),this._drawId===null)if(l(this,Pr)){const{lines:r,mustSmooth:o,areContours:a,description:c,uuid:h,heightInPage:u}=l(this,Pr),{rawDims:{pageWidth:d,pageHeight:f},rotation:p}=this.parent.viewport,m=Bn.processDrawnLines({lines:r,pageWidth:d,pageHeight:f,rotation:p,innerMargin:ys._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(m,u,c,h)}else this.div.hidden=!0,this._uiManager.getSignature(this);return i&&(this._isCopy=!0,this._moveAfterPaste(e,s)),this.div}setUuid(e){g(this,Mr,e),this.addEditToolbar()}getUuid(){return l(this,Mr)}get description(){return l(this,Ps)}set description(e){g(this,Ps,e),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:s,thickness:i,width:r,height:o}=l(this,Pr),a=Math.max(r,o),c=Bn.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:i,width:r,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.signatureManager&&l(this,Ps)!==null&&(await e.addEditSignatureButton(this._uiManager.signatureManager,l(this,Mr),l(this,Ps)),e.show()),e):null}addSignature(e,s,i,r){const{x:o,y:a}=this,{outline:c}=g(this,Pr,e);g(this,Rr,c instanceof mg),g(this,Ps,i),this.div.setAttribute("aria-description",i);let h;l(this,Rr)?h=ys.getDefaultDrawingOptions():(h=ys._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[u,d]=this.parentDimensions,[,f]=this.pageDimensions;let p=s/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(u*this.width,d*this.height),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Bn.process(e,s,i,r,ys._INNER_MARGIN)}getFromText(e,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:o}=this.parent.viewport;return Bn.extractContoursFromText(e,s,i,r,o,ys._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Bn.processDrawnLines({lines:e,pageWidth:s,pageHeight:i,rotation:r,innerMargin:ys._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:s}){e?this._drawingOptions=ys.getDefaultDrawingOptions():(this._drawingOptions=ys._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:s,points:i,rect:r}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":o}}=this,a={annotationType:dt.SIGNATURE,isSignature:!0,areContours:l(this,Rr),color:[0,0,0],thickness:l(this,Rr)?0:o,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(a.paths={lines:s,points:i},a.uuid=l(this,Mr),a.isCopy=!0):a.lines=s,l(this,Ps)&&(a.accessibilityData={type:"Figure",alt:l(this,Ps)}),a}static deserializeDraw(e,s,i,r,o,a){return a.areContours?mg.deserialize(e,s,i,r,o,a):Eu.deserialize(e,s,i,r,o,a)}static async deserialize(e,s,i){var o;const r=await super.deserialize(e,s,i);return g(r,Rr,e.areContours),g(r,Ps,((o=e.accessibilityData)==null?void 0:o.alt)||""),g(r,Mr,e.uuid),r}};Rr=new WeakMap,Ps=new WeakMap,Pr=new WeakMap,Mr=new WeakMap,U(ys,"_type","signature"),U(ys,"_editorType",dt.SIGNATURE),U(ys,"_defaultDrawingOptions",null);let Ag=ys;var Zt,ke,Ir,Mn,Lr,Wl,In,oa,Ki,Ms,ql,Ct,Cc,Tc,bd,yd,wd,Sg,vd,A0;class _g extends te{constructor(e){super({...e,name:"stampEditor"});y(this,Ct);y(this,Zt,null);y(this,ke,null);y(this,Ir,null);y(this,Mn,null);y(this,Lr,null);y(this,Wl,"");y(this,In,null);y(this,oa,!1);y(this,Ki,null);y(this,Ms,!1);y(this,ql,!1);g(this,Mn,e.bitmapUrl),g(this,Lr,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,s){te.initialize(e,s)}static isHandlingMimeForPasting(e){return gp.includes(e)}static paste(e,s){s.pasteEditor(dt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const s=e.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(e=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=e||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),s&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var e;l(this,ke)&&(g(this,Zt,null),this._uiManager.imageManager.deleteId(l(this,ke)),(e=l(this,In))==null||e.remove(),g(this,In,null),l(this,Ki)&&(clearTimeout(l(this,Ki)),g(this,Ki,null))),super.remove()}rebuild(){if(!this.parent){l(this,ke)&&w(this,Ct,bd).call(this);return}super.rebuild(),this.div!==null&&(l(this,ke)&&l(this,In)===null&&w(this,Ct,bd).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(l(this,Ir)||l(this,Zt)||l(this,Mn)||l(this,Lr)||l(this,ke)||l(this,oa))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,s;return this._isCopy&&(e=this.x,s=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),l(this,oa)||(l(this,Zt)?w(this,Ct,yd).call(this):w(this,Ct,bd).call(this)),this._isCopy&&this._moveAfterPaste(e,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(e,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(g(this,ke,i),r&&g(this,Zt,r),g(this,oa,!1),w(this,Ct,yd).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,Ki)!==null&&clearTimeout(l(this,Ki)),g(this,Ki,setTimeout(()=>{g(this,Ki,null),w(this,Ct,Sg).call(this)},200))}copyCanvas(e,s,i=!1){var p;e||(e=224);const{width:r,height:o}=l(this,Zt),a=new Vn;let c=l(this,Zt),h=r,u=o,d=null;if(s){if(r>s||o>s){const L=Math.min(s/r,s/o);h=Math.floor(r*L),u=Math.floor(o*L)}d=document.createElement("canvas");const m=d.width=Math.ceil(h*a.sx),b=d.height=Math.ceil(u*a.sy);l(this,Ms)||(c=w(this,Ct,wd).call(this,m,b));const A=d.getContext("2d");A.filter=this._uiManager.hcmFilter;let v="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",_="#42414d");const x=15,S=x*a.sx,C=x*a.sy,T=new OffscreenCanvas(S*2,C*2),R=T.getContext("2d");R.fillStyle=v,R.fillRect(0,0,S*2,C*2),R.fillStyle=_,R.fillRect(0,0,S,C),R.fillRect(S,C,S,C),A.fillStyle=A.createPattern(T,"repeat"),A.fillRect(0,0,m,b),A.drawImage(c,0,0,c.width,c.height,0,0,m,b)}let f=null;if(i){let m,b;if(a.symmetric&&c.width<e&&c.height<e)m=c.width,b=c.height;else if(c=l(this,Zt),r>e||o>e){const _=Math.min(e/r,e/o);m=Math.floor(r*_),b=Math.floor(o*_),l(this,Ms)||(c=w(this,Ct,wd).call(this,m,b))}const v=new OffscreenCanvas(m,b).getContext("2d",{willReadFrequently:!0});v.drawImage(c,0,0,c.width,c.height,0,0,m,b),f={width:m,height:b,data:v.getImageData(0,0,m,b).data}}return{canvas:d,width:h,height:u,imageData:f}}static async deserialize(e,s,i){var A;let r=null,o=!1;if(e instanceof Nv){const{data:{rect:v,rotation:_,id:x,structParent:S,popupRef:C},container:T,parent:{page:{pageNumber:R}},canvas:L}=e;let P,F;L?(delete e.canvas,{id:P,bitmap:F}=i.imageManager.getFromCanvas(T.id,L),L.remove()):(o=!0,e._hasNoCanvas=!0);const N=((A=await s._structTree.getAriaAttributes(`${om}${x}`))==null?void 0:A.get("aria-label"))||"";r=e={annotationType:dt.STAMP,bitmapId:P,bitmap:F,pageIndex:R-1,rect:v.slice(0),rotation:_,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:N},isSvg:!1,structParent:S,popupRef:C}}const a=await super.deserialize(e,s,i),{rect:c,bitmap:h,bitmapUrl:u,bitmapId:d,isSvg:f,accessibilityData:p}=e;o?(i.addMissingCanvas(e.id,a),g(a,oa,!0)):d&&i.imageManager.isValidId(d)?(g(a,ke,d),h&&g(a,Zt,h)):g(a,Mn,u),g(a,Ms,f);const[m,b]=a.pageDimensions;return a.width=(c[2]-c[0])/m,a.height=(c[3]-c[1])/b,a.annotationElementId=e.id||null,p&&(a.altTextData=p),a._initialData=r,g(a,ql,!!r),a}serialize(e=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:dt.STAMP,bitmapId:l(this,ke),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Ms),structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=w(this,Ct,vd).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=w(this,Ct,A0).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const a=l(this,Ms)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,ke)))s.stamps.set(l(this,ke),{area:a,serialized:i}),i.bitmap=w(this,Ct,vd).call(this,!1);else if(l(this,Ms)){const c=s.stamps.get(l(this,ke));a>c.area&&(c.area=a,c.serialized.bitmap.close(),c.serialized.bitmap=w(this,Ct,vd).call(this,!1))}return i}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}Zt=new WeakMap,ke=new WeakMap,Ir=new WeakMap,Mn=new WeakMap,Lr=new WeakMap,Wl=new WeakMap,In=new WeakMap,oa=new WeakMap,Ki=new WeakMap,Ms=new WeakMap,ql=new WeakMap,Ct=new WeakSet,Cc=function(e,s=!1){if(!e){this.remove();return}g(this,Zt,e.bitmap),s||(g(this,ke,e.id),g(this,Ms,e.isSvg)),e.file&&g(this,Wl,e.file.name),w(this,Ct,yd).call(this)},Tc=function(){if(g(this,Ir,null),this._uiManager.enableWaiting(!1),!!l(this,In)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Zt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Zt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},bd=function(){if(l(this,ke)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,ke)).then(i=>w(this,Ct,Cc).call(this,i,!0)).finally(()=>w(this,Ct,Tc).call(this));return}if(l(this,Mn)){const i=l(this,Mn);g(this,Mn,null),this._uiManager.enableWaiting(!0),g(this,Ir,this._uiManager.imageManager.getFromUrl(i).then(r=>w(this,Ct,Cc).call(this,r)).finally(()=>w(this,Ct,Tc).call(this)));return}if(l(this,Lr)){const i=l(this,Lr);g(this,Lr,null),this._uiManager.enableWaiting(!0),g(this,Ir,this._uiManager.imageManager.getFromFile(i).then(r=>w(this,Ct,Cc).call(this,r)).finally(()=>w(this,Ct,Tc).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=gp.join(",");const s=this._uiManager._signal;g(this,Ir,new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),w(this,Ct,Cc).call(this,r)}i()},{signal:s}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>w(this,Ct,Tc).call(this))),e.click()},yd=function(){var d;const{div:e}=this;let{width:s,height:i}=l(this,Zt);const[r,o]=this.pageDimensions,a=.75;if(this.width)s=this.width*r,i=this.height*o;else if(s>a*r||i>a*o){const f=Math.min(a*r/s,a*o/i);s*=f,i*=f}const[c,h]=this.parentDimensions;this.setDims(s*c/r,i*h/o),this._uiManager.enableWaiting(!1);const u=g(this,In,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=s/r,this.height=i/o,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),w(this,Ct,Sg).call(this),l(this,ql)||(this.parent.addUndoableEditor(this),g(this,ql,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,Wl)&&this.div.setAttribute("aria-description",l(this,Wl))},wd=function(e,s){const{width:i,height:r}=l(this,Zt);let o=i,a=r,c=l(this,Zt);for(;o>2*e||a>2*s;){const h=o,u=a;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const d=new OffscreenCanvas(o,a);d.getContext("2d").drawImage(c,0,0,h,u,0,0,o,a),c=d.transferToImageBitmap()}return c},Sg=function(){const[e,s]=this.parentDimensions,{width:i,height:r}=this,o=new Vn,a=Math.ceil(i*e*o.sx),c=Math.ceil(r*s*o.sy),h=l(this,In);if(!h||h.width===a&&h.height===c)return;h.width=a,h.height=c;const u=l(this,Ms)?l(this,Zt):w(this,Ct,wd).call(this,a,c),d=h.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(u,0,0,u.width,u.height,0,0,a,c)},vd=function(e){if(e){if(l(this,Ms)){const r=this._uiManager.imageManager.getSvgUrl(l(this,ke));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,Zt),s.getContext("2d").drawImage(l(this,Zt),0,0),s.toDataURL()}if(l(this,Ms)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*Hr.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*Hr.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(l(this,Zt),0,0,l(this,Zt).width,l(this,Zt).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(l(this,Zt))},A0=function(e){var a;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=e.pageIndex===s,o=(((a=e.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},U(_g,"_type","stamp"),U(_g,"_editorType",dt.STAMP);var aa,Xl,Zi,Dr,Ln,Xs,Fr,Yl,la,mi,Dn,Ge,Fn,it,Nr,Jt,_0,Di,Eg,Cg,Ad;const ni=class ni{constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:c,viewport:h,l10n:u}){y(this,Jt);y(this,aa);y(this,Xl,!1);y(this,Zi,null);y(this,Dr,null);y(this,Ln,null);y(this,Xs,new Map);y(this,Fr,!1);y(this,Yl,!1);y(this,la,!1);y(this,mi,null);y(this,Dn,null);y(this,Ge,null);y(this,Fn,null);y(this,it);const d=[...l(ni,Nr).values()];if(!ni._initialized){ni._initialized=!0;for(const f of d)f.initialize(u,t)}t.registerEditorTypes(d),g(this,it,t),this.pageIndex=e,this.div=s,g(this,aa,r),g(this,Zi,o),this.viewport=h,g(this,Ge,c),this.drawLayer=a,this._structTree=i,l(this,it).addLayer(this)}get isEmpty(){return l(this,Xs).size===0}get isInvisible(){return this.isEmpty&&l(this,it).getMode()===dt.NONE}updateToolbar(t){l(this,it).updateToolbar(t)}updateMode(t=l(this,it).getMode()){switch(w(this,Jt,Ad).call(this),t){case dt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case dt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case dt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const s of l(ni,Nr).values())e.toggle(`${s._type}Editing`,t===s._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=l(this,Ge))==null?void 0:e.div)}setEditingState(t){l(this,it).setEditingState(t)}addCommands(t){l(this,it).addCommands(t)}cleanUndoStack(t){l(this,it).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=l(this,Zi))==null||e.div.classList.toggle("disabled",!t)}async enable(){g(this,la,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const s of l(this,Xs).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,it).removeChangedExistingAnnotation(s),t.add(s.annotationElementId));if(!l(this,Zi)){g(this,la,!1);return}const e=l(this,Zi).getEditableAnnotations();for(const s of e){if(s.hide(),l(this,it).isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}g(this,la,!1)}disable(){var i;g(this,Yl,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const r of l(this,Xs).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,Zi)){const r=l(this,Zi).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(l(this,it).isDeletedAnnotationElement(a))continue;let c=e.get(a);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=t.get(a),c&&(l(this,it).addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}w(this,Jt,Ad).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(ni,Nr).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),g(this,Yl,!1)}getEditableAnnotation(t){var e;return((e=l(this,Zi))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){l(this,it).getActive()!==t&&l(this,it).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=l(this,Ge))!=null&&t.div&&!l(this,Fn)){g(this,Fn,new AbortController);const e=l(this,it).combinedSignal(l(this,Fn));l(this,Ge).div.addEventListener("pointerdown",w(this,Jt,_0).bind(this),{signal:e}),l(this,Ge).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=l(this,Ge))!=null&&t.div&&l(this,Fn)&&(l(this,Fn).abort(),g(this,Fn,null),l(this,Ge).div.classList.remove("highlighting"))}enableClick(){if(l(this,Dr))return;g(this,Dr,new AbortController);const t=l(this,it).combinedSignal(l(this,Dr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=l(this,Dr))==null||t.abort(),g(this,Dr,null)}attach(t){l(this,Xs).set(t.id,t);const{annotationElementId:e}=t;e&&l(this,it).isDeletedAnnotationElement(e)&&l(this,it).removeDeletedAnnotationElement(t)}detach(t){var e;l(this,Xs).delete(t.id),(e=l(this,aa))==null||e.removePointerInTextLayer(t.contentDiv),!l(this,Yl)&&t.annotationElementId&&l(this,it).addDeletedAnnotationElement(t)}remove(t){this.detach(t),l(this,it).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(l(this,it).addDeletedAnnotationElement(t.annotationElementId),te.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),l(this,it).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!l(this,la)),l(this,it).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var s;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!l(this,Ln)&&(t._focusEventsAllowed=!1,g(this,Ln,setTimeout(()=>{g(this,Ln,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:l(this,it)._signal}),e.focus())},0))),t._structTreeParentId=(s=l(this,aa))==null?void 0:s.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getNextId(){return l(this,it).getId()}combinedSignal(t){return l(this,it).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=l(this,Jt,Di))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){l(this,it).updateToolbar(t),await l(this,it).updateMode(t);const{offsetX:s,offsetY:i}=w(this,Jt,Cg).call(this),r=this.getNextId(),o=w(this,Jt,Eg).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,it),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=l(ni,Nr).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,l(this,it)))||null}createAndAddNewEditor(t,e,s={}){const i=this.getNextId(),r=w(this,Jt,Eg).call(this,{parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:l(this,it),isCentered:e,...s});return r&&this.add(r),r}addNewEditor(t={}){this.createAndAddNewEditor(w(this,Jt,Cg).call(this),!0,t)}setSelected(t){l(this,it).setSelected(t)}toggleSelected(t){l(this,it).toggleSelected(t)}unselect(t){l(this,it).unselect(t)}pointerup(t){var i;const{isMac:e}=$e.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!l(this,Fr)||(g(this,Fr,!1),(i=l(this,Jt,Di))!=null&&i.isDrawer&&l(this,Jt,Di).supportMultipleDrawings))return;if(!l(this,Xl)){g(this,Xl,!0);return}const s=l(this,it).getMode();if(s===dt.STAMP||s===dt.SIGNATURE){l(this,it).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var i;if(l(this,it).getMode()===dt.HIGHLIGHT&&this.enableTextSelection(),l(this,Fr)){g(this,Fr,!1);return}const{isMac:e}=$e.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(g(this,Fr,!0),(i=l(this,Jt,Di))!=null&&i.isDrawer){this.startDrawingSession(t);return}const s=l(this,it).getActive();g(this,Xl,!s||s.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),l(this,mi)){l(this,Jt,Di).startDrawing(this,l(this,it),!1,t);return}l(this,it).setCurrentDrawingSession(this),g(this,mi,new AbortController);const e=l(this,it).combinedSignal(l(this,mi));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(g(this,Dn,null),this.commitOrRemove())},{signal:e}),l(this,Jt,Di).startDrawing(this,l(this,it),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&g(this,Dn,e);return}l(this,Dn)&&setTimeout(()=>{var e;(e=l(this,Dn))==null||e.focus(),g(this,Dn,null)},0)}endDrawingSession(t=!1){return l(this,mi)?(l(this,it).setCurrentDrawingSession(null),l(this,mi).abort(),g(this,mi,null),g(this,Dn,null),l(this,Jt,Di).endDrawing(t)):null}findNewParent(t,e,s){const i=l(this,it).findParent(e,s);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return l(this,mi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,mi)&&l(this,Jt,Di).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=l(this,it).getActive())==null?void 0:t.parent)===this&&(l(this,it).commitOrRemove(),l(this,it).setActiveEditor(null)),l(this,Ln)&&(clearTimeout(l(this,Ln)),g(this,Ln,null));for(const s of l(this,Xs).values())(e=l(this,aa))==null||e.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,Xs).clear(),l(this,it).removeLayer(this)}render({viewport:t}){this.viewport=t,ga(this.div,t);for(const e of l(this,it).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){l(this,it).commitOrRemove(),w(this,Jt,Ad).call(this);const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,ga(this.div,{rotation:s}),e!==s)for(const i of l(this,Xs).values())i.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return l(this,it).viewParameters.realScale}};aa=new WeakMap,Xl=new WeakMap,Zi=new WeakMap,Dr=new WeakMap,Ln=new WeakMap,Xs=new WeakMap,Fr=new WeakMap,Yl=new WeakMap,la=new WeakMap,mi=new WeakMap,Dn=new WeakMap,Ge=new WeakMap,Fn=new WeakMap,it=new WeakMap,Nr=new WeakMap,Jt=new WeakSet,_0=function(t){l(this,it).unselectAll();const{target:e}=t;if(e===l(this,Ge).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&l(this,Ge).div.contains(e)){const{isMac:s}=$e.platform;if(t.button!==0||t.ctrlKey&&s)return;l(this,it).showAllEditors("highlight",!0,!0),l(this,Ge).div.classList.add("free"),this.toggleDrawing(),Hd.startHighlighting(this,l(this,it).direction==="ltr",{target:l(this,Ge).div,x:t.x,y:t.y}),l(this,Ge).div.addEventListener("pointerup",()=>{l(this,Ge).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,it)._signal}),t.preventDefault()}},Di=function(){return l(ni,Nr).get(l(this,it).getMode())},Eg=function(t){const e=l(this,Jt,Di);return e?new e.prototype.constructor(t):null},Cg=function(){const{x:t,y:e,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,t),o=Math.max(0,e),a=Math.min(window.innerWidth,t+s),c=Math.min(window.innerHeight,e+i),h=(r+a)/2-t,u=(o+c)/2-e,[d,f]=this.viewport.rotation%180===0?[h,u]:[u,h];return{offsetX:d,offsetY:f}},Ad=function(){for(const t of l(this,Xs).values())t.isEmpty()&&t.remove()},U(ni,"_initialized",!1),y(ni,Nr,new Map([sg,gg,_g,Hd,Ag].map(t=>[t._editorType,t])));let xg=ni;var bi,ss,ca,gu,af,S0,tn,kg,x0,Rg;const be=class be{constructor({pageIndex:t}){y(this,tn);y(this,bi,null);y(this,ss,new Map);y(this,ca,new Map);this.pageIndex=t}setParent(t){if(!l(this,bi)){g(this,bi,t);return}if(l(this,bi)!==t){if(l(this,ss).size>0)for(const e of l(this,ss).values())e.remove(),t.append(e);g(this,bi,t)}}static get _svgFactory(){return _t(this,"_svgFactory",new Od)}draw(t,e=!1,s=!1){const i=Ke(be,gu)._++,r=w(this,tn,kg).call(this),o=be._svgFactory.createElement("defs");r.append(o);const a=be._svgFactory.createElement("path");o.append(a);const c=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",c),a.setAttribute("vector-effect","non-scaling-stroke"),e&&l(this,ca).set(i,a);const h=s?w(this,tn,x0).call(this,o,c):null,u=be._svgFactory.createElement("use");return r.append(u),u.setAttribute("href",`#${c}`),this.updateProperties(r,t),l(this,ss).set(i,r),{id:i,clipPathId:`url(#${h})`}}drawOutline(t,e){const s=Ke(be,gu)._++,i=w(this,tn,kg).call(this),r=be._svgFactory.createElement("defs");i.append(r);const o=be._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(e){const d=be._svgFactory.createElement("mask");r.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=be._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=be._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const h=be._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${a}`),c&&h.setAttribute("mask",`url(#${c})`);const u=h.cloneNode();return i.append(u),h.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(i,t),l(this,ss).set(s,i),s}finalizeDraw(t,e){l(this,ca).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var c;if(!e)return;const{root:s,bbox:i,rootClass:r,path:o}=e,a=typeof t=="number"?l(this,ss).get(t):t;if(a){if(s&&w(this,tn,Rg).call(this,a,s),i&&w(c=be,af,S0).call(c,a,i),r){const{classList:h}=a;for(const[u,d]of Object.entries(r))h.toggle(u,d)}if(o){const u=a.firstChild.firstChild;w(this,tn,Rg).call(this,u,o)}}}updateParent(t,e){if(e===this)return;const s=l(this,ss).get(t);s&&(l(e,bi).append(s),l(this,ss).delete(t),l(e,ss).set(t,s))}remove(t){l(this,ca).delete(t),l(this,bi)!==null&&(l(this,ss).get(t).remove(),l(this,ss).delete(t))}destroy(){g(this,bi,null);for(const t of l(this,ss).values())t.remove();l(this,ss).clear(),l(this,ca).clear()}};bi=new WeakMap,ss=new WeakMap,ca=new WeakMap,gu=new WeakMap,af=new WeakSet,S0=function(t,[e,s,i,r]){const{style:o}=t;o.top=`${100*s}%`,o.left=`${100*e}%`,o.width=`${100*i}%`,o.height=`${100*r}%`},tn=new WeakSet,kg=function(){const t=be._svgFactory.create(1,1,!0);return l(this,bi).append(t),t.setAttribute("aria-hidden",!0),t},x0=function(t,e){const s=be._svgFactory.createElement("clipPath");t.append(s);const i=`clip_${e}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=be._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),i},Rg=function(t,e){for(const[s,i]of Object.entries(e))i===null?t.removeAttribute(s):t.setAttribute(s,i)},y(be,af),y(be,gu,0);let Tg=be;globalThis.pdfjsTestingUtils={HighlightOutliner:ng};at.AbortException;at.AnnotationEditorLayer;at.AnnotationEditorParamsType;at.AnnotationEditorType;at.AnnotationEditorUIManager;at.AnnotationLayer;at.AnnotationMode;at.AnnotationType;at.ColorPicker;at.DOMSVGFactory;at.DrawLayer;at.FeatureTest;var yC=at.GlobalWorkerOptions;at.ImageKind;at.InvalidPDFException;at.MathClamp;at.OPS;at.OutputScale;at.PDFDataRangeTransport;at.PDFDateString;at.PDFWorker;at.PasswordResponses;at.PermissionFlag;at.PixelsPerInch;at.RenderingCancelledException;at.ResponseException;at.SignatureExtractor;at.SupportedImageMimeTypes;at.TextLayer;at.TouchManager;at.Util;at.VerbosityLevel;at.XfaLayer;at.build;at.createValidAbsoluteUrl;at.fetchData;var wC=at.getDocument;at.getFilenameFromUrl;at.getPdfFilenameFromUrl;at.getUuid;at.getXfaPageViewport;at.isDataScheme;at.isPdfFile;at.isValidExplicitDest;at.noContextMenu;at.normalizeUnicode;at.setLayerDimensions;at.shadow;at.stopEvent;at.version;const vC={class:"pdf-viewer"},AC={class:"pdf-viewer_controls"},_C={class:"pdf-viewer_controls-group"},SC=["disabled"],xC={class:"pdf-page-info"},EC=["disabled"],CC={class:"pdf-viewer_controls-group"},TC=["disabled"],kC={class:"pdf-zoom-info"},RC=["disabled"],PC=gs({__name:"PdfViewer",props:{url:{}},emits:["loaded","error"],setup(n,{emit:t}){const e=new URL(""+new URL("pdf.worker.min.D9OcFTS_.mjs",import.meta.url).href,import.meta.url);yC.workerSrc=e.toString();const s=n,i=t,r=ft(!0),o=ft(null);let a=null;const c=ft(1),h=ft(0),u=ft(1),d=ft(null),f=ft(!1),p=ft(null),m=()=>{const T=window.innerWidth<768,R=window.innerWidth>=768&&window.innerWidth<1024;T?u.value=.5:R?u.value=.75:u.value=1},b=async()=>{r.value=!0,o.value=null;try{m();const T=await fetch(s.url);if(!T.ok)throw new Error(`PDF: ${T.statusText}`);const R=await T.arrayBuffer(),L=await wC({data:R}).promise;a=L,h.value=L.numPages,c.value=1,A(c.value)}catch(T){o.value=`PDF: ${T instanceof Error?T.message:String(T)}`,i("error",o.value),r.value=!1}},A=async T=>{var R;f.value=!0;try{if(!a)throw new Error("PDF");const L=await a.getPage(T),P=L.getViewport({scale:u.value});d.value&&(d.value.innerHTML="");const F=document.createElement("canvas"),N=F.getContext("2d");if(!N)throw new Error("Canvas");F.width=P.width,F.height=P.height;const D=document.createElement("div");D.style.width=`${P.width}px`,D.style.height=`${P.height}px`,D.style.margin="0 auto",D.style.position="relative",D.appendChild(F),(R=d.value)==null||R.appendChild(D);const tt={canvasContext:N,viewport:P};await L.render(tt).promise,f.value=!1,p.value!==null?(A(p.value),p.value=null):(r.value=!1,i("loaded"))}catch(L){f.value=!1,o.value=`: ${L instanceof Error?L.message:String(L)}`,r.value=!1,i("error",o.value)}},v=T=>{f.value?p.value=T:A(T)},_=()=>{c.value<=1||(c.value--,v(c.value))},x=()=>{c.value>=h.value||(c.value++,v(c.value))},S=()=>{u.value>=3||(u.value+=.25,v(c.value))},C=()=>{u.value<=.5||(u.value-=.25,v(c.value))};return Wr(()=>{s.url&&b(),window.addEventListener("resize",()=>{if(a&&!f.value){const T=u.value;m(),T!==u.value&&v(c.value)}})}),Gg(()=>{a&&(a.destroy(),a=null),window.removeEventListener("resize",()=>{})}),(T,R)=>(q(),et("div",vC,[M("div",{class:pe(["pdf-viewer_loading",{active:r.value}])},R[0]||(R[0]=[M("div",{class:"loading-spinner"},null,-1),M("p",null,"PDF...",-1)]),2),M("div",{class:pe(["pdf-viewer_error",{active:o.value}])},[M("p",null,yt(o.value),1)],2),M("div",{class:pe(["pdf-viewer_content",{hidden:r.value||o.value}])},[M("div",AC,[M("div",_C,[M("button",{class:"pdf-control-button",onClick:_,disabled:c.value<=1,"aria-label":""},R[1]||(R[1]=[M("span",{class:"control-icon"},"",-1),M("span",{class:"control-text"},"",-1)]),8,SC),M("span",xC,yt(c.value)+" / "+yt(h.value||"?"),1),M("button",{class:"pdf-control-button",onClick:x,disabled:c.value>=h.value,"aria-label":""},R[2]||(R[2]=[M("span",{class:"control-text"},"",-1),M("span",{class:"control-icon"},"",-1)]),8,EC)]),M("div",CC,[M("button",{class:"pdf-control-button",onClick:C,disabled:u.value<=.5,"aria-label":""},R[3]||(R[3]=[M("span",{class:"control-icon"},"",-1)]),8,TC),M("span",kC,yt(Math.round(u.value*100))+"%",1),M("button",{class:"pdf-control-button",onClick:S,disabled:u.value>=3,"aria-label":""},R[4]||(R[4]=[M("span",{class:"control-icon"},"",-1)]),8,RC)])]),M("div",{class:"pdf-viewer_container",ref_key:"canvasContainer",ref:d},null,512)],2)]))}}),MC=$s(PC,[["__scopeId","data-v-9bb79daa"]]),IC={class:"file-preview-container"},LC={key:1,class:"file-preview-error"},DC={key:2,class:"file-preview-image"},FC=["src","alt"],NC={key:3,class:"file-preview-pdf"},OC={key:4,class:"file-preview-markdown"},$C={key:5,class:"file-preview-unsupported"},BC=gs({__name:"FilePreview",props:{filePath:{default:""},filename:{default:""}},emits:["download","loaded","error"],setup(n,{emit:t}){const e=n,s=t,i=ft(null),r=ti(()=>{if(!e.filePath)return null;const h=e.filePath.toLowerCase().match(/\.([^.]+)$/);return h?h[1]:null}),o=ti(()=>{const h=r.value;return h?["jpg","jpeg","png","gif","webp","svg"].includes(h)?"image":["mp4","webm","ogg","mov"].includes(h)?"video":h==="pdf"?"pdf":h==="md"?"markdown":null:null}),a=ti(()=>e.filePath?e.filePath.startsWith("http")?e.filePath:`https://xiaowine.github.io/chip-docs/${e.filePath}`:""),c=()=>{e.filePath&&s("download",e.filePath)};return(h,u)=>(q(),et("div",IC,[i.value?(q(),et("div",LC,[M("p",null,yt(i.value),1)])):o.value==="image"?(q(),et("div",DC,[M("img",{src:a.value,alt:h.filename},null,8,FC)])):o.value==="pdf"?(q(),et("div",NC,[At(MC,{url:a.value},null,8,["url"])])):o.value==="markdown"?(q(),et("div",OC,[At(ww,{url:a.value},null,8,["url"])])):(q(),et("div",$C,[u[1]||(u[1]=M("p",null,"",-1)),M("p",null,": "+yt(r.value||""),1),M("button",{class:"action-button download-btn",onClick:c},"  ")]))]))}}),HC=$s(BC,[["__scopeId","data-v-50b87b27"]]),zC={class:"app-container custom-scrollbar"},UC={class:"main-content"},VC={class:"container"},jC={class:"content-layout"},GC={class:"file-tree-container"},WC={class:"markdown-container"},qC={key:0},XC={class:"file-detail-item"},YC={class:"file-detail-item"},KC={class:"file-detail-item"},ZC={class:"file-detail-item"},QC={class:"file-actions"},JC={key:1,class:"file-detail-loading"},tT={class:"download-progress"},eT={class:"download-info"},sT={class:"download-filename"},iT={class:"download-percent"},nT={class:"progress-container"},rT={class:"download-status"},oT={class:"download-actions"},aT=gs({__name:"App",setup(n){const t=ft(!1),e=Lc("theme"),s=ft(),i=ft("https://xiaowine.github.io/chip-docs/README.md"),r=ft(!1),o=ft(""),a=ft("");let c=!1;const h=ft(!1),u=ft(!1),d=[{key:"changes",label:"",link:"#changes",onClick:()=>{h.value=!0}},{key:"about",label:"",link:"#about",onClick:()=>{u.value=!0}}],f=()=>{c&&(console.log(""),e==null||e.toggleTheme(),c=!1)},p=ft([]),m=ft(!0),b=ft(""),A=async()=>{m.value=!0,b.value="";try{const Y=await JS();p.value=tx(Y),p.value.length===0&&(b.value="")}catch(Y){console.error(":",Y),b.value=Y instanceof Error?Y.message:""}finally{m.value=!1}},v=()=>{A()},_=ft(!1),x=ft(null),S=async Y=>{if(Y.type==="file"&&Y.path&&Y.md5){x.value=null,_.value=!0;try{x.value=await ex(Y.md5)}catch(lt){console.error(":",lt),x.value={path:Y.name||"",size:0,modifiedTime:new Date().toISOString(),isDirectory:!1,md5:Y.md5||""}}}},C=Y=>{const lt=mt=>mt.map(Ht=>Ht.key===Y.key?{...Ht,expanded:Y.expanded}:Ht.children?{...Ht,children:lt(Ht.children)}:Ht);p.value=lt(p.value)},T=ft(null),R=Y=>{N.value=Y.split("/").pop()||"",P.value=!0,tt.value=!1,F.value=0,D.value="...",T.value=new AbortController,sx(Y,mt=>{F.value=mt,mt<100?D.value=` ${mt}%...`:(D.value="",tt.value=!0)},T.value.signal,{onSuccess:()=>{D.value="",tt.value=!0},onCancel:()=>{D.value="",tt.value=!0,F.value=0},onError:mt=>{D.value=`: ${mt.message}`,tt.value=!0}})},L=()=>{T.value&&(D.value="...",setTimeout(()=>{var Y;(Y=T.value)==null||Y.abort(),T.value=null},0))},P=ft(!1),F=ft(0),N=ft(""),D=ft("..."),tt=ft(!1),nt=()=>{P.value=!1,F.value=0,N.value="",D.value="...",tt.value=!1,T.value=null},Nt=LS(async()=>{var mt,Ht;if(c||(mt=s.value)!=null&&mt.isAnimating)return;const Y=(e==null?void 0:e.theme.value)==="light"?"dark":"light",lt=getComputedStyle(document.documentElement).getPropertyValue(Y==="light"?"--w-bg-color-light":"--w-bg-color-dark").trim();c=await((Ht=s.value)==null?void 0:Ht.trigger(lt)),console.log("",c)},300);Wr(()=>{A()});const z=Y=>{o.value=Y,a.value=Y.split("/").pop()||"",r.value=!0},G=Y=>{console.error(":",Y)};return(Y,lt)=>(q(),et(Xt,null,[M("div",zC,[At(ie(AS),{modelValue:t.value,"onUpdate:modelValue":lt[0]||(lt[0]=mt=>t.value=mt),logo:ie(cS),title:"Wine UI","nav-position":"right",items:d,shadow:!0,fixed:!0},{right:Ys(()=>{var mt;return[At(ie(CS),{theme:((mt=ie(e))==null?void 0:mt.theme.value)??"light",onToggleThemeEvent:ie(Nt)},null,8,["theme","onToggleThemeEvent"])]}),_:1},8,["modelValue","logo"]),M("div",UC,[M("div",VC,[M("div",jC,[M("div",GC,[At(ie(ub),{style:{height:"100%",border:"2px solid var(--w-border-color) !important","box-shadow":"0 4px 12px rgba(0, 0, 0, 0.1)"}},{default:Ys(()=>[At(QS,{data:p.value,loading:m.value,"error-message":b.value,onSelect:S,onToggle:C,onRefresh:v},null,8,["data","loading","error-message"])]),_:1})]),M("div",WC,[At(ie(ub),{style:{height:"100%",border:"2px solid var(--w-border-color) !important","box-shadow":"0 4px 12px rgba(0, 0, 0, 0.1)"}},{default:Ys(()=>[At(ww,{url:i.value},null,8,["url"])]),_:1})])])])])]),At(ie(SS),{ref_key:"themeTransitionRef",ref:s,onTransitionComplete:f},null,512),At(ie(kS),{position:"bottomRight",marginRight:"20px",marginBottom:"10px"}),At(ie(sc),{modelValue:_.value,"onUpdate:modelValue":lt[3]||(lt[3]=mt=>_.value=mt),title:"",width:"500px","show-cancel":!1,"confirm-text":""},{default:Ys(()=>[x.value?(q(),et("div",qC,[M("div",XC,[lt[8]||(lt[8]=M("strong",null,":",-1)),hc(" "+yt(x.value.path),1)]),M("div",YC,[lt[9]||(lt[9]=M("strong",null,":",-1)),hc(" "+yt(ie(ix)(x.value.size)),1)]),M("div",KC,[lt[10]||(lt[10]=M("strong",null,":",-1)),hc(" "+yt(ie(nx)(x.value.modifiedTime)),1)]),M("div",ZC,[lt[11]||(lt[11]=M("strong",null,"MD5:",-1)),hc(" "+yt(x.value.md5),1)]),M("div",QC,[M("button",{class:"action-button download-btn",onClick:lt[1]||(lt[1]=mt=>R(x.value.path))},"  "),M("button",{class:"action-button preview-btn",onClick:lt[2]||(lt[2]=mt=>z(x.value.path))},"  ")])])):(q(),et("div",JC,"..."))]),_:1},8,["modelValue"]),At(ie(sc),{modelValue:r.value,"onUpdate:modelValue":lt[4]||(lt[4]=mt=>r.value=mt),title:a.value,width:"70vw",customClass:"preview-dialog","show-cancel":!1,"confirm-text":"",closable:!0},{default:Ys(()=>[At(HC,{"file-path":o.value,filename:a.value,onDownload:R,onError:G},null,8,["file-path","filename"])]),_:1},8,["modelValue","title"]),At(ie(sc),{modelValue:P.value,"onUpdate:modelValue":lt[5]||(lt[5]=mt=>P.value=mt),title:"",width:"400px",closable:!1,"close-on-click-mask":!1,"show-footer":!1},{default:Ys(()=>[M("div",tT,[M("div",eT,[M("p",sT,yt(N.value),1),M("p",iT,yt(F.value)+"%",1)]),M("div",nT,[M("div",{class:"progress-bar",style:Ai({width:`${F.value}%`})},null,4)]),M("p",rT,yt(D.value),1),M("div",oT,[tt.value?de("",!0):(q(),et("button",{key:0,class:"action-button cancel-btn",onClick:L},"  ")),tt.value?(q(),et("button",{key:1,class:"action-button done-btn",onClick:nt},"  ")):de("",!0)])])]),_:1},8,["modelValue"]),At(ie(sc),{modelValue:h.value,"onUpdate:modelValue":lt[6]||(lt[6]=mt=>h.value=mt),title:"",width:"700px","show-cancel":!1,"confirm-text":""},{default:Ys(()=>[At(AE)]),_:1},8,["modelValue"]),At(ie(sc),{modelValue:u.value,"onUpdate:modelValue":lt[7]||(lt[7]=mt=>u.value=mt),title:"",width:"600px","show-cancel":!1,"confirm-text":""},{default:Ys(()=>[At(EE)]),_:1},8,["modelValue"])],64))}});function lT(n={}){const t=n.storageKey||"wine-ui-theme",e=`${t}-auto`,s=n.defaultTheme||"light",i=ft(localStorage.getItem(e)==="true"),r=ft(i.value?n.defaultTheme:localStorage.getItem(t)||s);document.documentElement.setAttribute("data-theme",r.value);const o=window.matchMedia("(prefers-color-scheme: dark)"),a=(h,u=!1)=>{var d;r.value=h,document.documentElement.setAttribute("data-theme",h),u&&(localStorage.setItem(t,h),localStorage.setItem(e,"false"),i.value=!1),(d=n.onThemeChange)==null||d.call(n,h)},c=h=>{if(i.value){const u=h.matches?"dark":"light";a(u,!1)}};return{theme:ti(()=>r.value),isAutoTheme:ti(()=>i.value),setTheme(h){a(h,!0)},toggleTheme(){const h=r.value==="light"?"dark":"light";a(h,!0)},enableAutoTheme(){i.value=!0,localStorage.setItem(e,"true"),c(o),o.addEventListener("change",c)},disableAutoTheme(){i.value=!1,localStorage.setItem(e,"false"),o.removeEventListener("change",c)}}}const cT={install:(n,t={})=>{const e=lT(t);n.config.globalProperties.$theme=e,n.provide("theme",e);const s=`${t.storageKey||"wine-ui-theme"}-auto`,i=localStorage.getItem(s)==="true";t.auto!==!1&&(i||!localStorage.getItem(t.storageKey||"wine-ui-theme"))&&e.enableAutoTheme(),n.config.globalProperties.$dispose=()=>{e.disableAutoTheme()}}},E0=oS(aT);E0.use(cT,{defaultTheme:"light",auto:!0,onThemeChange:n=>{console.log(":",n)}});E0.mount("#app");
